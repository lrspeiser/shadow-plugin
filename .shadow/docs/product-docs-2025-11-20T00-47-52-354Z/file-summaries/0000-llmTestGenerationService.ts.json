{
  "file": "src/domain/services/testing/llmTestGenerationService.ts",
  "role": "Core Logic",
  "purpose": "Generates unit tests for code functions using an LLM in small batches with progress tracking and execution validation.",
  "userVisibleActions": [
    "Progress updates showing which function is being tested and completion percentage",
    "Test generation results indicating success or failure for each function",
    "Notifications when test files are created or updated",
    "Error messages if test generation fails for specific functions"
  ],
  "developerVisibleActions": [
    "Developer triggers test generation for selected functions",
    "System reads source code and extracts function signatures",
    "LLM generates test code based on function context and existing mocks",
    "Generated tests are validated by executing them",
    "Test files are written to the test directory structure",
    "Progress callback provides real-time status updates during batch processing",
    "Results map shows success/failure status for each function tested"
  ],
  "keyFunctions": [
    {
      "name": "generateTestBatch",
      "desc": "Generates tests for multiple functions in a batch with progress tracking",
      "inputs": "functions array, workspace root path, LLM service, optional progress callback",
      "outputs": "Map of function names to test generation results"
    },
    {
      "name": "extractFunctionSource",
      "desc": "Retrieves the source code for a specific function from its file",
      "inputs": "TestableFunction object, workspace root path",
      "outputs": "Source code string for the function"
    },
    {
      "name": "generateTestForFunction",
      "desc": "Creates a test for a single function using LLM and validates it",
      "inputs": "Function details, source code, LLM service, workspace root, test framework type, existing mocks",
      "outputs": "TestGenerationResult with test code and execution status"
    },
    {
      "name": "buildGenerationPrompt",
      "desc": "Constructs the LLM prompt with function context and mock information",
      "inputs": "Function object, source code, test framework name, existing mocks",
      "outputs": "Formatted prompt string for LLM"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "TestableFunction",
    "TestGenerationState",
    "TestGenerationResult",
    "buildGenerationPrompt",
    "TestExecutionService",
    "SWLogger"
  ],
  "intent": "Automates test generation by leveraging AI to write unit tests incrementally for code functions, reducing manual test writing effort while ensuring generated tests are valid through automatic execution and validation.",
  "rawContent": "```json\n{\n  \"purpose\": \"Generates unit tests for code functions using an LLM in small batches with progress tracking and execution validation.\",\n  \"userVisibleActions\": [\n    \"Progress updates showing which function is being tested and completion percentage\",\n    \"Test generation results indicating success or failure for each function\",\n    \"Notifications when test files are created or updated\",\n    \"Error messages if test generation fails for specific functions\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer triggers test generation for selected functions\",\n    \"System reads source code and extracts function signatures\",\n    \"LLM generates test code based on function context and existing mocks\",\n    \"Generated tests are validated by executing them\",\n    \"Test files are written to the test directory structure\",\n    \"Progress callback provides real-time status updates during batch processing\",\n    \"Results map shows success/failure status for each function tested\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"generateTestBatch\",\n      \"desc\": \"Generates tests for multiple functions in a batch with progress tracking\",\n      \"inputs\": \"functions array, workspace root path, LLM service, optional progress callback\",\n      \"outputs\": \"Map of function names to test generation results\"\n    },\n    {\n      \"name\": \"extractFunctionSource\",\n      \"desc\": \"Retrieves the source code for a specific function from its file\",\n      \"inputs\": \"TestableFunction object, workspace root path\",\n      \"outputs\": \"Source code string for the function\"\n    },\n    {\n      \"name\": \"generateTestForFunction\",\n      \"desc\": \"Creates a test for a single function using LLM and validates it\",\n      \"inputs\": \"Function details, source code, LLM service, workspace root, test framework type, existing mocks\",\n      \"outputs\": \"TestGenerationResult with test code and execution status\"\n    },\n    {\n      \"name\": \"buildGenerationPrompt\",\n      \"desc\": \"Constructs the LLM prompt with function context and mock information\",\n      \"inputs\": \"Function object, source code, test framework name, existing mocks\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"TestableFunction\",\n    \"TestGenerationState\",\n    \"TestGenerationResult\",\n    \"buildGenerationPrompt\",\n    \"TestExecutionService\",\n    \"SWLogger\"\n  ],\n  \"intent\": \"Automates test generation by leveraging AI to write unit tests incrementally for code functions, reducing manual test writing effort while ensuring generated tests are valid through automatic execution and validation.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T00:53:46.671Z"
  }
}