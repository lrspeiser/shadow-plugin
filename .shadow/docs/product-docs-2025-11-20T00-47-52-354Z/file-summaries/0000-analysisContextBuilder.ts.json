{
  "file": "src/context/analysisContextBuilder.ts",
  "role": "Core Logic",
  "purpose": "Converts code analysis results into a format suitable for LLM context and saves them to persistent storage for future use.",
  "userVisibleActions": [
    "Analysis results are automatically saved to the workspace for future reference",
    "Analysis data is preserved in a .shadow/docs directory within the workspace",
    "Timestamped analysis snapshots are created each time code is analyzed"
  ],
  "developerVisibleActions": [
    "Developer triggers code analysis, and results are automatically converted to LLM-compatible format",
    "Analysis context is prepared for sending to language models with all necessary code structure information",
    "Analysis results are persisted to .shadow/docs/code-analysis.json file with metadata",
    "Workspace folders are checked before saving analysis data",
    "Directory structure (.shadow/docs) is created automatically if it doesn't exist"
  ],
  "keyFunctions": [
    {
      "name": "convertCodeAnalysisToContext",
      "desc": "Transforms raw code analysis data into the specific format required by LLM services",
      "inputs": "CodeAnalysis object containing files, imports, entry points, and metrics",
      "outputs": "AnalysisContext object formatted for LLM consumption with file paths, lines, functions, imports, and statistics"
    },
    {
      "name": "saveCodeAnalysis",
      "desc": "Persists code analysis results to disk with timestamp metadata for future retrieval",
      "inputs": "CodeAnalysis object to be saved",
      "outputs": "void - creates code-analysis.json file in .shadow/docs directory"
    }
  ],
  "dependencies": [
    "vscode",
    "fs",
    "path",
    "../analyzer",
    "../llmService"
  ],
  "intent": "This file exists to bridge the gap between code analysis output and LLM input requirements, while also ensuring analysis results are preserved for later use. It solves the problem of formatting code structure data for AI consumption and maintaining a history of code analysis snapshots.",
  "rawContent": "```json\n{\n  \"purpose\": \"Converts code analysis results into a format suitable for LLM context and saves them to persistent storage for future use.\",\n  \"userVisibleActions\": [\n    \"Analysis results are automatically saved to the workspace for future reference\",\n    \"Analysis data is preserved in a .shadow/docs directory within the workspace\",\n    \"Timestamped analysis snapshots are created each time code is analyzed\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer triggers code analysis, and results are automatically converted to LLM-compatible format\",\n    \"Analysis context is prepared for sending to language models with all necessary code structure information\",\n    \"Analysis results are persisted to .shadow/docs/code-analysis.json file with metadata\",\n    \"Workspace folders are checked before saving analysis data\",\n    \"Directory structure (.shadow/docs) is created automatically if it doesn't exist\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"convertCodeAnalysisToContext\",\n      \"desc\": \"Transforms raw code analysis data into the specific format required by LLM services\",\n      \"inputs\": \"CodeAnalysis object containing files, imports, entry points, and metrics\",\n      \"outputs\": \"AnalysisContext object formatted for LLM consumption with file paths, lines, functions, imports, and statistics\"\n    },\n    {\n      \"name\": \"saveCodeAnalysis\",\n      \"desc\": \"Persists code analysis results to disk with timestamp metadata for future retrieval\",\n      \"inputs\": \"CodeAnalysis object to be saved\",\n      \"outputs\": \"void - creates code-analysis.json file in .shadow/docs directory\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"fs\",\n    \"path\",\n    \"../analyzer\",\n    \"../llmService\"\n  ],\n  \"intent\": \"This file exists to bridge the gap between code analysis output and LLM input requirements, while also ensuring analysis results are preserved for later use. It solves the problem of formatting code structure data for AI consumption and maintaining a history of code analysis snapshots.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T00:51:01.076Z"
  }
}