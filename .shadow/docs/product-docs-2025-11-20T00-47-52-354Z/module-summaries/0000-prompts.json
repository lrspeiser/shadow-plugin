{
  "module": "src/domain/prompts",
  "moduleType": "other",
  "capabilities": [
    "Generates specialized prompts for LLM-based code analysis across multiple analysis types",
    "Creates structured prompts for architecture analysis and documentation generation",
    "Produces prompts for intelligent code refactoring with detailed migration plans",
    "Builds prompts for automated test plan creation and test code generation",
    "Constructs prompts for multi-level documentation (file, module, and product levels)",
    "Generates prompts that guide LLMs to analyze product purpose and value propositions",
    "Creates prompts with function-level analysis for code extraction and reorganization",
    "Produces prompts that include dependency relationship analysis for refactoring impact assessment"
  ],
  "summary": "This module serves as the prompt engineering layer for LLM-based code analysis and generation workflows. It provides centralized prompt construction services that transform analysis requirements into structured, detailed instructions for language models. The module handles multiple analysis scenarios including architecture documentation, product summaries, code refactoring recommendations, and test generation.\n\nUsers interact with this module indirectly through various code analysis and generation features. When requesting codebase analysis, the module constructs prompts that guide LLMs to produce architecture overviews, identify patterns, and document system structure. For refactoring scenarios, it builds detailed prompts that include function-by-function analysis, dependency graphs, step-by-step migration plans, and before/after code examples. The module also supports test-driven workflows by generating prompts that analyze source code and create comprehensive test plans with actual test implementations.\n\nThe prompt building workflow operates at multiple abstraction levels: file-level for detailed code analysis, module-level for component summaries, and product-level for comprehensive documentation. Each prompt type is carefully structured to include relevant context, specific instructions, and output formatting requirements that ensure consistent, high-quality LLM responses. This centralized approach to prompt management ensures consistency across all AI-assisted code analysis and generation features while maintaining the flexibility to handle diverse analysis scenarios.",
  "files": [
    {
      "file": "src/domain/prompts/promptBuilder.ts",
      "role": "Core Logic",
      "purpose": "Centralized prompt construction service that builds specialized prompts for different types of LLM-based code analysis tasks",
      "userVisibleActions": [
        "Generates architecture analysis of the codebase",
        "Produces product documentation summaries",
        "Analyzes product purpose and value proposition",
        "Creates detailed file-level code analysis",
        "Generates module-level summaries from multiple files",
        "Produces comprehensive product-level documentation",
        "Creates test plans for source code files",
        "Generates actual test code from test plans"
      ],
      "developerVisibleActions": [
        "Developer calls buildArchitecturePrompt to get an LLM prompt for analyzing system architecture",
        "Developer calls buildProductDocsPrompt to generate prompts for extracting product documentation",
        "Developer calls buildProductPurposePrompt to create prompts for analyzing product purpose",
        "Developer calls buildFileAnalysisPrompt to generate prompts for analyzing individual files",
        "Developer calls buildModuleRollupPrompt to create prompts that summarize multiple files into module documentation",
        "Developer calls buildProductLevelPrompt to generate prompts for overall product analysis",
        "Developer calls buildPerFileTestPlanPrompt to create test planning prompts for specific files",
        "Developer calls buildTestCodeGenerationPrompt to generate actual test code from test plans",
        "Prompts are constructed with specific context, code analysis data, and documentation",
        "Each prompt builder method accepts relevant context and returns a formatted string ready for LLM consumption"
      ],
      "keyFunctions": [
        {
          "name": "buildArchitecturePrompt",
          "desc": "Constructs a prompt for analyzing codebase architecture",
          "inputs": "context (AnalysisContext), optional codeAnalysis, productDocs, productPurposeAnalysis, fileAccessHelper",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductDocsPrompt",
          "desc": "Constructs a prompt for extracting product documentation",
          "inputs": "context (AnalysisContext)",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductPurposePrompt",
          "desc": "Constructs a prompt for analyzing product purpose and value",
          "inputs": "productDocs (EnhancedProductDocumentation), context (AnalysisContext)",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildFileAnalysisPrompt",
          "desc": "Constructs a prompt for analyzing a single source file",
          "inputs": "file (FileInfo), content (string), role (string)",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildModuleRollupPrompt",
          "desc": "Constructs a prompt for summarizing multiple files into a module",
          "inputs": "modulePath (string), moduleType (string), files (FileSummary[])",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductLevelPrompt",
          "desc": "Constructs a prompt for overall product-level analysis",
          "inputs": "fileSummaries (FileSummary[]), moduleSummaries (ModuleSummary[]), analysis (CodeAnalysis), fileAccessHelper (FileAccessHelper)",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildPerFileTestPlanPrompt",
          "desc": "Constructs a prompt for creating test plans for a specific file",
          "inputs": "filePath, fileContent, functionMetadata, existingTests, language, testFramework, optional projectSummary",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildTestCodeGenerationPrompt",
          "desc": "Constructs a prompt for generating actual test code from a test plan",
          "inputs": "testPlanItem, sourceCode, functionCode, language, testFramework",
          "outputs": "Formatted prompt string for LLM"
        }
      ],
      "dependencies": [
        "../../llmService",
        "../../analyzer",
        "../../fileDocumentation",
        "../../fileAccessHelper"
      ],
      "intent": "Eliminates prompt construction duplication across the codebase by centralizing all LLM prompt building logic in one place, ensuring consistent prompt formatting and structure for various analysis tasks including architecture analysis, documentation generation, and test creation",
      "rawContent": "```json\n{\n  \"purpose\": \"Centralized prompt construction service that builds specialized prompts for different types of LLM-based code analysis tasks\",\n  \"userVisibleActions\": [\n    \"Generates architecture analysis of the codebase\",\n    \"Produces product documentation summaries\",\n    \"Analyzes product purpose and value proposition\",\n    \"Creates detailed file-level code analysis\",\n    \"Generates module-level summaries from multiple files\",\n    \"Produces comprehensive product-level documentation\",\n    \"Creates test plans for source code files\",\n    \"Generates actual test code from test plans\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer calls buildArchitecturePrompt to get an LLM prompt for analyzing system architecture\",\n    \"Developer calls buildProductDocsPrompt to generate prompts for extracting product documentation\",\n    \"Developer calls buildProductPurposePrompt to create prompts for analyzing product purpose\",\n    \"Developer calls buildFileAnalysisPrompt to generate prompts for analyzing individual files\",\n    \"Developer calls buildModuleRollupPrompt to create prompts that summarize multiple files into module documentation\",\n    \"Developer calls buildProductLevelPrompt to generate prompts for overall product analysis\",\n    \"Developer calls buildPerFileTestPlanPrompt to create test planning prompts for specific files\",\n    \"Developer calls buildTestCodeGenerationPrompt to generate actual test code from test plans\",\n    \"Prompts are constructed with specific context, code analysis data, and documentation\",\n    \"Each prompt builder method accepts relevant context and returns a formatted string ready for LLM consumption\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildArchitecturePrompt\",\n      \"desc\": \"Constructs a prompt for analyzing codebase architecture\",\n      \"inputs\": \"context (AnalysisContext), optional codeAnalysis, productDocs, productPurposeAnalysis, fileAccessHelper\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductDocsPrompt\",\n      \"desc\": \"Constructs a prompt for extracting product documentation\",\n      \"inputs\": \"context (AnalysisContext)\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductPurposePrompt\",\n      \"desc\": \"Constructs a prompt for analyzing product purpose and value\",\n      \"inputs\": \"productDocs (EnhancedProductDocumentation), context (AnalysisContext)\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildFileAnalysisPrompt\",\n      \"desc\": \"Constructs a prompt for analyzing a single source file\",\n      \"inputs\": \"file (FileInfo), content (string), role (string)\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildModuleRollupPrompt\",\n      \"desc\": \"Constructs a prompt for summarizing multiple files into a module\",\n      \"inputs\": \"modulePath (string), moduleType (string), files (FileSummary[])\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductLevelPrompt\",\n      \"desc\": \"Constructs a prompt for overall product-level analysis\",\n      \"inputs\": \"fileSummaries (FileSummary[]), moduleSummaries (ModuleSummary[]), analysis (CodeAnalysis), fileAccessHelper (FileAccessHelper)\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildPerFileTestPlanPrompt\",\n      \"desc\": \"Constructs a prompt for creating test plans for a specific file\",\n      \"inputs\": \"filePath, fileContent, functionMetadata, existingTests, language, testFramework, optional projectSummary\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildTestCodeGenerationPrompt\",\n      \"desc\": \"Constructs a prompt for generating actual test code from a test plan\",\n      \"inputs\": \"testPlanItem, sourceCode, functionCode, language, testFramework\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../llmService\",\n    \"../../analyzer\",\n    \"../../fileDocumentation\",\n    \"../../fileAccessHelper\"\n  ],\n  \"intent\": \"Eliminates prompt construction duplication across the codebase by centralizing all LLM prompt building logic in one place, ensuring consistent prompt formatting and structure for various analysis tasks including architecture analysis, documentation generation, and test creation\"\n}\n```"
    },
    {
      "file": "src/domain/prompts/refactoringPromptBuilder.ts",
      "role": "Core Logic",
      "purpose": "Builds structured prompts for LLM-based code refactoring that include detailed analysis, extraction plans, and prescriptive instructions.",
      "userVisibleActions": [
        "Receives detailed refactoring recommendations with step-by-step migration plans",
        "Gets code examples showing before/after states for proposed refactorings",
        "Sees function-by-function analysis explaining why code should be extracted or reorganized",
        "Views dependency relationships between functions to understand extraction impact"
      ],
      "developerVisibleActions": [
        "Generates comprehensive refactoring prompts by combining code analysis, product documentation, and architecture insights",
        "Creates structured extraction plans that identify functions to move and their dependencies",
        "Produces prompts that request specific refactoring formats including migration steps and code examples",
        "Builds function analysis sections showing responsibilities, dependencies, and dependents for each function",
        "Formats prompts to guide LLMs in providing prescriptive refactoring instructions rather than general advice"
      ],
      "keyFunctions": [
        {
          "name": "buildDetailedRefactoringPrompt",
          "desc": "Constructs a comprehensive refactoring prompt by combining analysis context, code analysis, product documentation, architecture insights, and function analyses",
          "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array",
          "outputs": "Formatted string prompt for LLM consumption"
        },
        {
          "name": "buildBasePrompt",
          "desc": "Creates the foundational prompt structure including context, code analysis, and documentation",
          "inputs": "AnalysisContext, CodeAnalysis, optional product docs, optional architecture insights",
          "outputs": "Base prompt string"
        },
        {
          "name": "buildFunctionAnalysisSection",
          "desc": "Formats function-level analysis data into prompt text showing signatures, dependencies, and responsibilities",
          "inputs": "Array of FunctionAnalysis objects",
          "outputs": "Formatted function analysis section string"
        },
        {
          "name": "buildExtractionRequirementsSection",
          "desc": "Generates prompt section specifying what format and details the refactoring recommendations should include",
          "inputs": "None",
          "outputs": "Extraction requirements section string"
        }
      ],
      "dependencies": [
        "../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)",
        "../../llmService (AnalysisContext, LLMInsights)",
        "../../fileDocumentation (EnhancedProductDocumentation)"
      ],
      "intent": "This file exists to transform raw code analysis data into structured, detailed prompts that guide LLMs to produce actionable refactoring recommendations with specific extraction plans, migration steps, and code examples rather than vague suggestions.",
      "rawContent": "```json\n{\n  \"purpose\": \"Builds structured prompts for LLM-based code refactoring that include detailed analysis, extraction plans, and prescriptive instructions.\",\n  \"userVisibleActions\": [\n    \"Receives detailed refactoring recommendations with step-by-step migration plans\",\n    \"Gets code examples showing before/after states for proposed refactorings\",\n    \"Sees function-by-function analysis explaining why code should be extracted or reorganized\",\n    \"Views dependency relationships between functions to understand extraction impact\"\n  ],\n  \"developerVisibleActions\": [\n    \"Generates comprehensive refactoring prompts by combining code analysis, product documentation, and architecture insights\",\n    \"Creates structured extraction plans that identify functions to move and their dependencies\",\n    \"Produces prompts that request specific refactoring formats including migration steps and code examples\",\n    \"Builds function analysis sections showing responsibilities, dependencies, and dependents for each function\",\n    \"Formats prompts to guide LLMs in providing prescriptive refactoring instructions rather than general advice\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildDetailedRefactoringPrompt\",\n      \"desc\": \"Constructs a comprehensive refactoring prompt by combining analysis context, code analysis, product documentation, architecture insights, and function analyses\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array\",\n      \"outputs\": \"Formatted string prompt for LLM consumption\"\n    },\n    {\n      \"name\": \"buildBasePrompt\",\n      \"desc\": \"Creates the foundational prompt structure including context, code analysis, and documentation\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional product docs, optional architecture insights\",\n      \"outputs\": \"Base prompt string\"\n    },\n    {\n      \"name\": \"buildFunctionAnalysisSection\",\n      \"desc\": \"Formats function-level analysis data into prompt text showing signatures, dependencies, and responsibilities\",\n      \"inputs\": \"Array of FunctionAnalysis objects\",\n      \"outputs\": \"Formatted function analysis section string\"\n    },\n    {\n      \"name\": \"buildExtractionRequirementsSection\",\n      \"desc\": \"Generates prompt section specifying what format and details the refactoring recommendations should include\",\n      \"inputs\": \"None\",\n      \"outputs\": \"Extraction requirements section string\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)\",\n    \"../../llmService (AnalysisContext, LLMInsights)\",\n    \"../../fileDocumentation (EnhancedProductDocumentation)\"\n  ],\n  \"intent\": \"This file exists to transform raw code analysis data into structured, detailed prompts that guide LLMs to produce actionable refactoring recommendations with specific extraction plans, migration steps, and code examples rather than vague suggestions.\"\n}\n```"
    },
    {
      "file": "src/domain/prompts/testPrompts.ts",
      "role": "Core Logic",
      "purpose": "Provides prompt builders that generate structured instructions for LLMs to analyze codebases and create test plans.",
      "userVisibleActions": [
        "No direct user-facing actions - this file generates prompts for AI-driven test generation"
      ],
      "developerVisibleActions": [
        "Developer can generate a test setup recommendation prompt by providing workspace root, file list, and optional package.json content",
        "Developer can generate a test planning prompt by providing analysis context, functions list, and optional product/architecture documentation",
        "Developer receives structured JSON-formatted prompts that instruct LLMs on how to analyze code and recommend test configurations",
        "Developer gets prompts that request specific test setup information including framework, dependencies, config files, and mock requirements",
        "Developer gets prompts that request prioritized test plans based on function complexity, coverage, and importance"
      ],
      "keyFunctions": [
        {
          "name": "buildSetupPrompt",
          "desc": "Creates a prompt that asks an LLM to analyze a codebase and recommend optimal test setup configuration",
          "inputs": "workspaceRoot (string), fileList (array of file paths), optional packageJsonContent (string)",
          "outputs": "Formatted string prompt requesting JSON response with language, framework, dependencies, config files, test directory, and mock requirements"
        },
        {
          "name": "buildPlanningPrompt",
          "desc": "Creates a prompt that asks an LLM to analyze functions and create a prioritized test plan",
          "inputs": "context (AnalysisContext), functions (array of function objects), optional productDocs, optional architectureInsights",
          "outputs": "Formatted string prompt with codebase statistics and function list requesting prioritized test strategy"
        }
      ],
      "dependencies": [
        "../../analyzer",
        "../services/testing/types/testPlanTypes"
      ],
      "intent": "This file exists to bridge the gap between code analysis and AI-driven test generation by creating standardized, structured prompts that guide LLMs to generate comprehensive test configurations and plans. It solves the problem of consistently requesting the right information from LLMs in a format that can be programmatically processed.",
      "rawContent": "```json\n{\n  \"purpose\": \"Provides prompt builders that generate structured instructions for LLMs to analyze codebases and create test plans.\",\n  \"userVisibleActions\": [\n    \"No direct user-facing actions - this file generates prompts for AI-driven test generation\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer can generate a test setup recommendation prompt by providing workspace root, file list, and optional package.json content\",\n    \"Developer can generate a test planning prompt by providing analysis context, functions list, and optional product/architecture documentation\",\n    \"Developer receives structured JSON-formatted prompts that instruct LLMs on how to analyze code and recommend test configurations\",\n    \"Developer gets prompts that request specific test setup information including framework, dependencies, config files, and mock requirements\",\n    \"Developer gets prompts that request prioritized test plans based on function complexity, coverage, and importance\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildSetupPrompt\",\n      \"desc\": \"Creates a prompt that asks an LLM to analyze a codebase and recommend optimal test setup configuration\",\n      \"inputs\": \"workspaceRoot (string), fileList (array of file paths), optional packageJsonContent (string)\",\n      \"outputs\": \"Formatted string prompt requesting JSON response with language, framework, dependencies, config files, test directory, and mock requirements\"\n    },\n    {\n      \"name\": \"buildPlanningPrompt\",\n      \"desc\": \"Creates a prompt that asks an LLM to analyze functions and create a prioritized test plan\",\n      \"inputs\": \"context (AnalysisContext), functions (array of function objects), optional productDocs, optional architectureInsights\",\n      \"outputs\": \"Formatted string prompt with codebase statistics and function list requesting prioritized test strategy\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer\",\n    \"../services/testing/types/testPlanTypes\"\n  ],\n  \"intent\": \"This file exists to bridge the gap between code analysis and AI-driven test generation by creating standardized, structured prompts that guide LLMs to generate comprehensive test configurations and plans. It solves the problem of consistently requesting the right information from LLMs in a format that can be programmatically processed.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T01:00:56.723Z"
  }
}