{
  "file": "src/domain/services/fileWatcherService.ts",
  "role": "Core Logic",
  "purpose": "Provides centralized file system watching to detect when files are created, modified, or deleted in the workspace",
  "userVisibleActions": [
    "When user creates a new file matching a watched pattern, registered handlers are automatically triggered",
    "When user modifies an existing file, change detection triggers updates to relevant views or features",
    "When user deletes a file, cleanup and refresh actions occur automatically",
    "When user saves a document, save handlers execute to update related features"
  ],
  "developerVisibleActions": [
    "Provides a unified service to watch file system changes without creating duplicate watchers",
    "Allows multiple components to register handlers for the same file patterns efficiently",
    "Automatically manages watcher lifecycle and cleanup to prevent memory leaks",
    "Supports pattern-based filtering with ignore patterns to exclude specific files",
    "Consolidates document save event handling across multiple features",
    "Provides disposable pattern for proper cleanup of watch registrations"
  ],
  "keyFunctions": [
    {
      "name": "watch",
      "desc": "Registers a handler to be called when files matching a pattern are created, changed, or deleted",
      "inputs": "id (string), pattern (file glob or relative pattern), handler (callback function), options (watch create/change/delete flags, ignore patterns)",
      "outputs": "Disposable object to unregister the watch"
    },
    {
      "name": "onDocumentSave",
      "desc": "Registers a handler to be called whenever a document is saved in the editor",
      "inputs": "handler (callback function receiving the saved document)",
      "outputs": "Disposable object to unregister the handler"
    },
    {
      "name": "dispose",
      "desc": "Cleans up all file watchers and handlers, releasing system resources",
      "inputs": "none",
      "outputs": "void"
    },
    {
      "name": "getPatternKey",
      "desc": "Generates a unique key for a file pattern to enable watcher reuse",
      "inputs": "pattern (string or RelativePattern)",
      "outputs": "string key"
    }
  ],
  "dependencies": [
    "vscode",
    "path",
    "fs"
  ],
  "intent": "This file exists to eliminate duplication of file watching logic across multiple extension features. Previously, separate components (fileWatcher.ts, productNavigator.ts, insightsViewer.ts) each created their own file watchers, leading to redundant system resource usage and inconsistent behavior. This service consolidates all file watching into a single, efficient implementation that can be shared across the extension, ensuring consistent file change detection and proper resource management.",
  "rawContent": "```json\n{\n  \"purpose\": \"Provides centralized file system watching to detect when files are created, modified, or deleted in the workspace\",\n  \"userVisibleActions\": [\n    \"When user creates a new file matching a watched pattern, registered handlers are automatically triggered\",\n    \"When user modifies an existing file, change detection triggers updates to relevant views or features\",\n    \"When user deletes a file, cleanup and refresh actions occur automatically\",\n    \"When user saves a document, save handlers execute to update related features\"\n  ],\n  \"developerVisibleActions\": [\n    \"Provides a unified service to watch file system changes without creating duplicate watchers\",\n    \"Allows multiple components to register handlers for the same file patterns efficiently\",\n    \"Automatically manages watcher lifecycle and cleanup to prevent memory leaks\",\n    \"Supports pattern-based filtering with ignore patterns to exclude specific files\",\n    \"Consolidates document save event handling across multiple features\",\n    \"Provides disposable pattern for proper cleanup of watch registrations\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"watch\",\n      \"desc\": \"Registers a handler to be called when files matching a pattern are created, changed, or deleted\",\n      \"inputs\": \"id (string), pattern (file glob or relative pattern), handler (callback function), options (watch create/change/delete flags, ignore patterns)\",\n      \"outputs\": \"Disposable object to unregister the watch\"\n    },\n    {\n      \"name\": \"onDocumentSave\",\n      \"desc\": \"Registers a handler to be called whenever a document is saved in the editor\",\n      \"inputs\": \"handler (callback function receiving the saved document)\",\n      \"outputs\": \"Disposable object to unregister the handler\"\n    },\n    {\n      \"name\": \"dispose\",\n      \"desc\": \"Cleans up all file watchers and handlers, releasing system resources\",\n      \"inputs\": \"none\",\n      \"outputs\": \"void\"\n    },\n    {\n      \"name\": \"getPatternKey\",\n      \"desc\": \"Generates a unique key for a file pattern to enable watcher reuse\",\n      \"inputs\": \"pattern (string or RelativePattern)\",\n      \"outputs\": \"string key\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"path\",\n    \"fs\"\n  ],\n  \"intent\": \"This file exists to eliminate duplication of file watching logic across multiple extension features. Previously, separate components (fileWatcher.ts, productNavigator.ts, insightsViewer.ts) each created their own file watchers, leading to redundant system resource usage and inconsistent behavior. This service consolidates all file watching into a single, efficient implementation that can be shared across the extension, ensuring consistent file change detection and proper resource management.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T04:18:42.130Z"
  }
}