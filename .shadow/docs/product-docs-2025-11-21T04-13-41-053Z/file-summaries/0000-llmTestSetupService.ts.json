{
  "file": "src/domain/services/testing/llmTestSetupService.ts",
  "role": "Core Logic",
  "purpose": "Detects test environment configuration and generates test setup plans using LLM-based analysis of the workspace.",
  "userVisibleActions": [
    "Automatically detects the programming language used in the project (TypeScript, JavaScript, Python, Java, C++)",
    "Identifies existing test framework configuration (Jest, package.json, tsconfig.json)",
    "Generates a test setup plan with required dependencies and configuration files",
    "Executes test setup by installing dependencies and creating configuration files",
    "Verifies test setup by running a test command and checking for success"
  ],
  "developerVisibleActions": [
    "Scans workspace to detect test environment (test directories, config files, language distribution)",
    "Analyzes package.json and tsconfig.json to understand project structure",
    "Uses LLM to generate appropriate test setup based on detected environment",
    "Installs test framework dependencies via package manager (npm/yarn)",
    "Creates or updates test configuration files (jest.config.js, tsconfig.json)",
    "Runs test verification command and reports success or failure with error messages",
    "Provides detailed execution results including stdout, stderr, and exit codes"
  ],
  "keyFunctions": [
    {
      "name": "detectTestEnvironment",
      "desc": "Scans workspace to identify project language, existing test configurations, and test directories",
      "inputs": "workspaceRoot: string (path to project root)",
      "outputs": "TestEnvironment object with framework, language, directories, and config file information"
    },
    {
      "name": "generateSetupPlan",
      "desc": "Uses LLM to create a test setup plan based on detected environment",
      "inputs": "environment: TestEnvironment, llmResponse: function",
      "outputs": "Promise<TestSetupPlan> with dependencies, config files, and setup steps"
    },
    {
      "name": "executeSetup",
      "desc": "Executes the generated setup plan by installing dependencies and creating config files",
      "inputs": "plan: TestSetupPlan, workspaceRoot: string",
      "outputs": "Promise<SetupExecutionResult> with success status, messages, and any errors"
    },
    {
      "name": "verifySetup",
      "desc": "Runs test command to verify the test environment is correctly configured",
      "inputs": "workspaceRoot: string, testCommand: string",
      "outputs": "Promise<SetupExecutionResult> indicating if tests can run successfully"
    },
    {
      "name": "getAllFiles",
      "desc": "Recursively retrieves all files in a directory for language detection",
      "inputs": "dir: string (directory path)",
      "outputs": "string[] (array of file paths)"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "child_process",
    "./types/testSetupTypes",
    "../../prompts/testPrompts",
    "../../../logger"
  ],
  "intent": "This service automates test environment setup by intelligently detecting the project's configuration and generating appropriate test framework setup. It solves the problem of manual test configuration by analyzing the workspace, determining the best test setup approach using LLM, and automatically installing and configuring the necessary testing infrastructure. This eliminates the need for developers to manually configure test frameworks and ensures consistent test setup across projects.",
  "rawContent": "```json\n{\n  \"purpose\": \"Detects test environment configuration and generates test setup plans using LLM-based analysis of the workspace.\",\n  \"userVisibleActions\": [\n    \"Automatically detects the programming language used in the project (TypeScript, JavaScript, Python, Java, C++)\",\n    \"Identifies existing test framework configuration (Jest, package.json, tsconfig.json)\",\n    \"Generates a test setup plan with required dependencies and configuration files\",\n    \"Executes test setup by installing dependencies and creating configuration files\",\n    \"Verifies test setup by running a test command and checking for success\"\n  ],\n  \"developerVisibleActions\": [\n    \"Scans workspace to detect test environment (test directories, config files, language distribution)\",\n    \"Analyzes package.json and tsconfig.json to understand project structure\",\n    \"Uses LLM to generate appropriate test setup based on detected environment\",\n    \"Installs test framework dependencies via package manager (npm/yarn)\",\n    \"Creates or updates test configuration files (jest.config.js, tsconfig.json)\",\n    \"Runs test verification command and reports success or failure with error messages\",\n    \"Provides detailed execution results including stdout, stderr, and exit codes\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"detectTestEnvironment\",\n      \"desc\": \"Scans workspace to identify project language, existing test configurations, and test directories\",\n      \"inputs\": \"workspaceRoot: string (path to project root)\",\n      \"outputs\": \"TestEnvironment object with framework, language, directories, and config file information\"\n    },\n    {\n      \"name\": \"generateSetupPlan\",\n      \"desc\": \"Uses LLM to create a test setup plan based on detected environment\",\n      \"inputs\": \"environment: TestEnvironment, llmResponse: function\",\n      \"outputs\": \"Promise<TestSetupPlan> with dependencies, config files, and setup steps\"\n    },\n    {\n      \"name\": \"executeSetup\",\n      \"desc\": \"Executes the generated setup plan by installing dependencies and creating config files\",\n      \"inputs\": \"plan: TestSetupPlan, workspaceRoot: string\",\n      \"outputs\": \"Promise<SetupExecutionResult> with success status, messages, and any errors\"\n    },\n    {\n      \"name\": \"verifySetup\",\n      \"desc\": \"Runs test command to verify the test environment is correctly configured\",\n      \"inputs\": \"workspaceRoot: string, testCommand: string\",\n      \"outputs\": \"Promise<SetupExecutionResult> indicating if tests can run successfully\"\n    },\n    {\n      \"name\": \"getAllFiles\",\n      \"desc\": \"Recursively retrieves all files in a directory for language detection\",\n      \"inputs\": \"dir: string (directory path)\",\n      \"outputs\": \"string[] (array of file paths)\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"child_process\",\n    \"./types/testSetupTypes\",\n    \"../../prompts/testPrompts\",\n    \"../../../logger\"\n  ],\n  \"intent\": \"This service automates test environment setup by intelligently detecting the project's configuration and generating appropriate test framework setup. It solves the problem of manual test configuration by analyzing the workspace, determining the best test setup approach using LLM, and automatically installing and configuring the necessary testing infrastructure. This eliminates the need for developers to manually configure test frameworks and ensures consistent test setup across projects.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T04:19:41.130Z"
  }
}