{
  "file": "src/domain/prompts/promptBuilder.ts",
  "role": "Core Logic",
  "purpose": "Centralizes construction of all LLM prompts for code analysis, documentation, and test generation tasks",
  "userVisibleActions": [
    "Receives architecture analysis of their codebase structure and patterns",
    "Gets product documentation generated from their code",
    "Sees product purpose and value proposition extracted from documentation",
    "Views file-level analysis summaries with behavior descriptions",
    "Receives module-level rollup documentation combining related files",
    "Gets test plans generated for their source code files",
    "Receives generated test code based on test plans"
  ],
  "developerVisibleActions": [
    "Provides standardized prompt templates for all LLM interactions",
    "Builds architecture analysis prompts using context, code analysis, and product docs",
    "Constructs product documentation prompts from analysis context",
    "Creates product purpose extraction prompts from existing documentation",
    "Generates file analysis prompts with role-based context",
    "Builds module rollup prompts combining multiple file summaries",
    "Creates product-level documentation prompts from all summaries and analysis",
    "Generates per-file test plan prompts with existing test awareness",
    "Constructs test code generation prompts from test plans and source code"
  ],
  "keyFunctions": [
    {
      "name": "buildArchitecturePrompt",
      "desc": "Creates prompt for analyzing codebase architecture patterns and structure",
      "inputs": "AnalysisContext, optional CodeAnalysis, ProductDocumentation, ProductPurposeAnalysis, FileAccessHelper",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildProductDocsPrompt",
      "desc": "Creates prompt for generating product-level documentation",
      "inputs": "AnalysisContext",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildProductPurposePrompt",
      "desc": "Creates prompt for extracting product purpose and value proposition",
      "inputs": "EnhancedProductDocumentation, AnalysisContext",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildFileAnalysisPrompt",
      "desc": "Creates prompt for analyzing individual file behavior and role",
      "inputs": "FileInfo, file content string, role classification",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildModuleRollupPrompt",
      "desc": "Creates prompt for rolling up multiple file summaries into module documentation",
      "inputs": "Module path, module type, array of FileSummary objects",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildProductLevelPrompt",
      "desc": "Creates prompt for generating comprehensive product-level documentation",
      "inputs": "FileSummary array, ModuleSummary array, CodeAnalysis, FileAccessHelper",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildPerFileTestPlanPrompt",
      "desc": "Creates prompt for generating test plans for a specific file",
      "inputs": "File path, content, function metadata, existing tests, language, test framework, optional project summary",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "buildTestCodeGenerationPrompt",
      "desc": "Creates prompt for generating actual test code from test plans",
      "inputs": "Test plan item, source code, function code, language, test framework",
      "outputs": "Formatted prompt string for LLM"
    }
  ],
  "dependencies": [
    "../../llmService",
    "../../analyzer",
    "../../fileDocumentation",
    "../../fileAccessHelper"
  ],
  "intent": "This file exists to eliminate duplication and centralize all LLM prompt construction logic. Previously scattered across multiple files, this builder provides a single source of truth for how prompts are formatted, ensuring consistency in LLM interactions and making prompt engineering changes easier to manage across architecture analysis, documentation generation, and test creation workflows.",
  "rawContent": "```json\n{\n  \"purpose\": \"Centralizes construction of all LLM prompts for code analysis, documentation, and test generation tasks\",\n  \"userVisibleActions\": [\n    \"Receives architecture analysis of their codebase structure and patterns\",\n    \"Gets product documentation generated from their code\",\n    \"Sees product purpose and value proposition extracted from documentation\",\n    \"Views file-level analysis summaries with behavior descriptions\",\n    \"Receives module-level rollup documentation combining related files\",\n    \"Gets test plans generated for their source code files\",\n    \"Receives generated test code based on test plans\"\n  ],\n  \"developerVisibleActions\": [\n    \"Provides standardized prompt templates for all LLM interactions\",\n    \"Builds architecture analysis prompts using context, code analysis, and product docs\",\n    \"Constructs product documentation prompts from analysis context\",\n    \"Creates product purpose extraction prompts from existing documentation\",\n    \"Generates file analysis prompts with role-based context\",\n    \"Builds module rollup prompts combining multiple file summaries\",\n    \"Creates product-level documentation prompts from all summaries and analysis\",\n    \"Generates per-file test plan prompts with existing test awareness\",\n    \"Constructs test code generation prompts from test plans and source code\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildArchitecturePrompt\",\n      \"desc\": \"Creates prompt for analyzing codebase architecture patterns and structure\",\n      \"inputs\": \"AnalysisContext, optional CodeAnalysis, ProductDocumentation, ProductPurposeAnalysis, FileAccessHelper\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductDocsPrompt\",\n      \"desc\": \"Creates prompt for generating product-level documentation\",\n      \"inputs\": \"AnalysisContext\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductPurposePrompt\",\n      \"desc\": \"Creates prompt for extracting product purpose and value proposition\",\n      \"inputs\": \"EnhancedProductDocumentation, AnalysisContext\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildFileAnalysisPrompt\",\n      \"desc\": \"Creates prompt for analyzing individual file behavior and role\",\n      \"inputs\": \"FileInfo, file content string, role classification\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildModuleRollupPrompt\",\n      \"desc\": \"Creates prompt for rolling up multiple file summaries into module documentation\",\n      \"inputs\": \"Module path, module type, array of FileSummary objects\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductLevelPrompt\",\n      \"desc\": \"Creates prompt for generating comprehensive product-level documentation\",\n      \"inputs\": \"FileSummary array, ModuleSummary array, CodeAnalysis, FileAccessHelper\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildPerFileTestPlanPrompt\",\n      \"desc\": \"Creates prompt for generating test plans for a specific file\",\n      \"inputs\": \"File path, content, function metadata, existing tests, language, test framework, optional project summary\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildTestCodeGenerationPrompt\",\n      \"desc\": \"Creates prompt for generating actual test code from test plans\",\n      \"inputs\": \"Test plan item, source code, function code, language, test framework\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../llmService\",\n    \"../../analyzer\",\n    \"../../fileDocumentation\",\n    \"../../fileAccessHelper\"\n  ],\n  \"intent\": \"This file exists to eliminate duplication and centralize all LLM prompt construction logic. Previously scattered across multiple files, this builder provides a single source of truth for how prompts are formatted, ensuring consistency in LLM interactions and making prompt engineering changes easier to manage across architecture analysis, documentation generation, and test creation workflows.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T04:18:02.591Z"
  }
}