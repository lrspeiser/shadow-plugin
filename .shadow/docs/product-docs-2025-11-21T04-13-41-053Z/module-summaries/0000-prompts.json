{
  "module": "src/domain/prompts",
  "moduleType": "other",
  "capabilities": [
    "Generate AI prompts for comprehensive code analysis and architecture documentation",
    "Create structured prompts for automated test generation and test planning",
    "Build detailed refactoring recommendations with step-by-step extraction plans",
    "Extract product documentation and value propositions from codebases",
    "Produce file-level and module-level documentation summaries",
    "Analyze test configurations and recommend optimal testing strategies",
    "Generate prescriptive migration instructions for code reorganization"
  ],
  "summary": "This module serves as the prompt engineering foundation for AI-powered code analysis and transformation. It constructs carefully designed prompts that guide large language models to analyze codebases, generate documentation, create tests, and recommend refactorings. Users interact with this module through the various AI-assisted features in the application, where it translates their code into structured queries that produce actionable insights.\n\nThe module supports multiple user workflows: documentation generation (from architecture analysis to product summaries), test creation (from test planning to implementation guidance), and code refactoring (from analysis to prescriptive extraction steps). Each workflow produces structured, consistent output that helps developers understand their codebase, improve test coverage, and maintain code quality through systematic refactoring.\n\nBy centralizing all prompt construction logic, the module ensures consistency across different AI-powered features while providing specialized templates for distinct tasks like configuration analysis, function extraction planning, and mock requirement identification. This enables users to leverage AI assistance for complex development tasks without needing to craft prompts themselves.",
  "files": [
    {
      "file": "src/domain/prompts/promptBuilder.ts",
      "role": "Core Logic",
      "purpose": "Centralizes construction of all LLM prompts for code analysis, documentation, and test generation tasks",
      "userVisibleActions": [
        "Receives architecture analysis of their codebase structure and patterns",
        "Gets product documentation generated from their code",
        "Sees product purpose and value proposition extracted from documentation",
        "Views file-level analysis summaries with behavior descriptions",
        "Receives module-level rollup documentation combining related files",
        "Gets test plans generated for their source code files",
        "Receives generated test code based on test plans"
      ],
      "developerVisibleActions": [
        "Provides standardized prompt templates for all LLM interactions",
        "Builds architecture analysis prompts using context, code analysis, and product docs",
        "Constructs product documentation prompts from analysis context",
        "Creates product purpose extraction prompts from existing documentation",
        "Generates file analysis prompts with role-based context",
        "Builds module rollup prompts combining multiple file summaries",
        "Creates product-level documentation prompts from all summaries and analysis",
        "Generates per-file test plan prompts with existing test awareness",
        "Constructs test code generation prompts from test plans and source code"
      ],
      "keyFunctions": [
        {
          "name": "buildArchitecturePrompt",
          "desc": "Creates prompt for analyzing codebase architecture patterns and structure",
          "inputs": "AnalysisContext, optional CodeAnalysis, ProductDocumentation, ProductPurposeAnalysis, FileAccessHelper",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductDocsPrompt",
          "desc": "Creates prompt for generating product-level documentation",
          "inputs": "AnalysisContext",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductPurposePrompt",
          "desc": "Creates prompt for extracting product purpose and value proposition",
          "inputs": "EnhancedProductDocumentation, AnalysisContext",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildFileAnalysisPrompt",
          "desc": "Creates prompt for analyzing individual file behavior and role",
          "inputs": "FileInfo, file content string, role classification",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildModuleRollupPrompt",
          "desc": "Creates prompt for rolling up multiple file summaries into module documentation",
          "inputs": "Module path, module type, array of FileSummary objects",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildProductLevelPrompt",
          "desc": "Creates prompt for generating comprehensive product-level documentation",
          "inputs": "FileSummary array, ModuleSummary array, CodeAnalysis, FileAccessHelper",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildPerFileTestPlanPrompt",
          "desc": "Creates prompt for generating test plans for a specific file",
          "inputs": "File path, content, function metadata, existing tests, language, test framework, optional project summary",
          "outputs": "Formatted prompt string for LLM"
        },
        {
          "name": "buildTestCodeGenerationPrompt",
          "desc": "Creates prompt for generating actual test code from test plans",
          "inputs": "Test plan item, source code, function code, language, test framework",
          "outputs": "Formatted prompt string for LLM"
        }
      ],
      "dependencies": [
        "../../llmService",
        "../../analyzer",
        "../../fileDocumentation",
        "../../fileAccessHelper"
      ],
      "intent": "This file exists to eliminate duplication and centralize all LLM prompt construction logic. Previously scattered across multiple files, this builder provides a single source of truth for how prompts are formatted, ensuring consistency in LLM interactions and making prompt engineering changes easier to manage across architecture analysis, documentation generation, and test creation workflows.",
      "rawContent": "```json\n{\n  \"purpose\": \"Centralizes construction of all LLM prompts for code analysis, documentation, and test generation tasks\",\n  \"userVisibleActions\": [\n    \"Receives architecture analysis of their codebase structure and patterns\",\n    \"Gets product documentation generated from their code\",\n    \"Sees product purpose and value proposition extracted from documentation\",\n    \"Views file-level analysis summaries with behavior descriptions\",\n    \"Receives module-level rollup documentation combining related files\",\n    \"Gets test plans generated for their source code files\",\n    \"Receives generated test code based on test plans\"\n  ],\n  \"developerVisibleActions\": [\n    \"Provides standardized prompt templates for all LLM interactions\",\n    \"Builds architecture analysis prompts using context, code analysis, and product docs\",\n    \"Constructs product documentation prompts from analysis context\",\n    \"Creates product purpose extraction prompts from existing documentation\",\n    \"Generates file analysis prompts with role-based context\",\n    \"Builds module rollup prompts combining multiple file summaries\",\n    \"Creates product-level documentation prompts from all summaries and analysis\",\n    \"Generates per-file test plan prompts with existing test awareness\",\n    \"Constructs test code generation prompts from test plans and source code\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildArchitecturePrompt\",\n      \"desc\": \"Creates prompt for analyzing codebase architecture patterns and structure\",\n      \"inputs\": \"AnalysisContext, optional CodeAnalysis, ProductDocumentation, ProductPurposeAnalysis, FileAccessHelper\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductDocsPrompt\",\n      \"desc\": \"Creates prompt for generating product-level documentation\",\n      \"inputs\": \"AnalysisContext\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductPurposePrompt\",\n      \"desc\": \"Creates prompt for extracting product purpose and value proposition\",\n      \"inputs\": \"EnhancedProductDocumentation, AnalysisContext\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildFileAnalysisPrompt\",\n      \"desc\": \"Creates prompt for analyzing individual file behavior and role\",\n      \"inputs\": \"FileInfo, file content string, role classification\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildModuleRollupPrompt\",\n      \"desc\": \"Creates prompt for rolling up multiple file summaries into module documentation\",\n      \"inputs\": \"Module path, module type, array of FileSummary objects\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildProductLevelPrompt\",\n      \"desc\": \"Creates prompt for generating comprehensive product-level documentation\",\n      \"inputs\": \"FileSummary array, ModuleSummary array, CodeAnalysis, FileAccessHelper\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildPerFileTestPlanPrompt\",\n      \"desc\": \"Creates prompt for generating test plans for a specific file\",\n      \"inputs\": \"File path, content, function metadata, existing tests, language, test framework, optional project summary\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"buildTestCodeGenerationPrompt\",\n      \"desc\": \"Creates prompt for generating actual test code from test plans\",\n      \"inputs\": \"Test plan item, source code, function code, language, test framework\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../llmService\",\n    \"../../analyzer\",\n    \"../../fileDocumentation\",\n    \"../../fileAccessHelper\"\n  ],\n  \"intent\": \"This file exists to eliminate duplication and centralize all LLM prompt construction logic. Previously scattered across multiple files, this builder provides a single source of truth for how prompts are formatted, ensuring consistency in LLM interactions and making prompt engineering changes easier to manage across architecture analysis, documentation generation, and test creation workflows.\"\n}\n```"
    },
    {
      "file": "src/domain/prompts/refactoringPromptBuilder.ts",
      "role": "Core Logic",
      "purpose": "Builds detailed, prescriptive prompts for AI-powered code refactoring by analyzing functions and creating structured extraction plans",
      "userVisibleActions": [
        "Receives detailed refactoring recommendations with specific function extraction plans",
        "Sees migration steps explaining how to move code between files",
        "Views before/after code examples showing proposed refactoring changes",
        "Gets prescriptive instructions for breaking down large files into smaller modules"
      ],
      "developerVisibleActions": [
        "Provides code analysis data including file information and function metadata",
        "Supplies optional product documentation to guide refactoring decisions",
        "Passes architecture insights to inform refactoring strategy",
        "Receives structured refactoring prompts ready to send to LLM services",
        "Gets function dependency analysis showing which functions call each other",
        "Obtains extraction plans specifying source files, target files, and migration steps"
      ],
      "keyFunctions": [
        {
          "name": "buildDetailedRefactoringPrompt",
          "desc": "Creates a comprehensive refactoring prompt by combining code analysis, product documentation, architecture insights, and function analyses",
          "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis[]",
          "outputs": "string prompt ready for LLM consumption"
        },
        {
          "name": "buildBasePrompt",
          "desc": "Constructs the foundational refactoring prompt with context and code analysis",
          "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights",
          "outputs": "string base prompt"
        },
        {
          "name": "buildFunctionAnalysisSection",
          "desc": "Adds detailed function-level analysis to the prompt showing dependencies, responsibilities, and metrics",
          "inputs": "FunctionAnalysis[]",
          "outputs": "string section describing function details"
        },
        {
          "name": "buildExtractionRequirementsSection",
          "desc": "Generates requirements for code extraction including target files, dependencies, and migration steps",
          "inputs": "none apparent",
          "outputs": "string section with extraction guidelines"
        }
      ],
      "dependencies": [
        "../../analyzer",
        "../../llmService",
        "../../fileDocumentation"
      ],
      "intent": "This file exists to transform raw code analysis data into structured, actionable refactoring instructions that an LLM can understand and execute. It solves the problem of providing enough context and detail so that AI-generated refactoring recommendations are accurate, safe, and preserve code relationships like dependencies between functions.",
      "rawContent": "```json\n{\n  \"purpose\": \"Builds detailed, prescriptive prompts for AI-powered code refactoring by analyzing functions and creating structured extraction plans\",\n  \"userVisibleActions\": [\n    \"Receives detailed refactoring recommendations with specific function extraction plans\",\n    \"Sees migration steps explaining how to move code between files\",\n    \"Views before/after code examples showing proposed refactoring changes\",\n    \"Gets prescriptive instructions for breaking down large files into smaller modules\"\n  ],\n  \"developerVisibleActions\": [\n    \"Provides code analysis data including file information and function metadata\",\n    \"Supplies optional product documentation to guide refactoring decisions\",\n    \"Passes architecture insights to inform refactoring strategy\",\n    \"Receives structured refactoring prompts ready to send to LLM services\",\n    \"Gets function dependency analysis showing which functions call each other\",\n    \"Obtains extraction plans specifying source files, target files, and migration steps\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildDetailedRefactoringPrompt\",\n      \"desc\": \"Creates a comprehensive refactoring prompt by combining code analysis, product documentation, architecture insights, and function analyses\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis[]\",\n      \"outputs\": \"string prompt ready for LLM consumption\"\n    },\n    {\n      \"name\": \"buildBasePrompt\",\n      \"desc\": \"Constructs the foundational refactoring prompt with context and code analysis\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights\",\n      \"outputs\": \"string base prompt\"\n    },\n    {\n      \"name\": \"buildFunctionAnalysisSection\",\n      \"desc\": \"Adds detailed function-level analysis to the prompt showing dependencies, responsibilities, and metrics\",\n      \"inputs\": \"FunctionAnalysis[]\",\n      \"outputs\": \"string section describing function details\"\n    },\n    {\n      \"name\": \"buildExtractionRequirementsSection\",\n      \"desc\": \"Generates requirements for code extraction including target files, dependencies, and migration steps\",\n      \"inputs\": \"none apparent\",\n      \"outputs\": \"string section with extraction guidelines\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer\",\n    \"../../llmService\",\n    \"../../fileDocumentation\"\n  ],\n  \"intent\": \"This file exists to transform raw code analysis data into structured, actionable refactoring instructions that an LLM can understand and execute. It solves the problem of providing enough context and detail so that AI-generated refactoring recommendations are accurate, safe, and preserve code relationships like dependencies between functions.\"\n}\n```"
    },
    {
      "file": "src/domain/prompts/testPrompts.ts",
      "role": "Core Logic",
      "purpose": "Provides prompt templates for LLM-based test generation, configuration analysis, and test planning strategies.",
      "userVisibleActions": [
        "Analyzes codebase to recommend optimal test setup and configuration",
        "Generates prioritized test plans identifying critical functions to test",
        "Creates detailed test specifications for individual functions",
        "Provides test implementation guidance with examples and patterns",
        "Suggests mock requirements for external dependencies like VSCode APIs"
      ],
      "developerVisibleActions": [
        "Developer calls buildSetupPrompt() to analyze workspace and get test framework recommendations",
        "Developer calls buildPlanningPrompt() to create a prioritized test strategy based on code analysis",
        "Developer calls buildTestSpecPrompt() to generate detailed test specifications for specific functions",
        "Developer calls buildImplementationPrompt() to get test implementation guidance with code examples",
        "Receives structured JSON responses with dependencies, configurations, and test strategies",
        "Gets language detection, framework selection, and mock requirements automatically",
        "Receives prioritized function lists with complexity scores and coverage recommendations"
      ],
      "keyFunctions": [
        {
          "name": "buildSetupPrompt",
          "desc": "Creates a prompt to analyze codebase and recommend test setup configuration",
          "inputs": "workspaceRoot: string, fileList: string[], packageJsonContent?: string",
          "outputs": "Prompt string requesting JSON with language, framework, dependencies, config files, and mock requirements"
        },
        {
          "name": "buildPlanningPrompt",
          "desc": "Generates a prompt to create a prioritized test plan based on code analysis",
          "inputs": "context: CodeAnalysis, functions: any[], productDocs?: any, architectureInsights?: any",
          "outputs": "Prompt string requesting JSON with prioritized functions, complexity scores, and testing strategy"
        },
        {
          "name": "buildTestSpecPrompt",
          "desc": "Creates a prompt to generate detailed test specifications for a specific function",
          "inputs": "testableFunction: TestableFunction, codeContext: string, existingTests?: string",
          "outputs": "Prompt string requesting JSON with test scenarios, edge cases, assertions, and mocking needs"
        },
        {
          "name": "buildImplementationPrompt",
          "desc": "Generates a prompt to provide test implementation guidance and code examples",
          "inputs": "testSpec: any, framework: string, existingPatterns?: string",
          "outputs": "Prompt string requesting JSON with implementation strategy, code examples, and best practices"
        }
      ],
      "dependencies": [
        "../../analyzer (CodeAnalysis type)",
        "../services/testing/types/testPlanTypes (TestableFunction type)"
      ],
      "intent": "This file exists to standardize and structure LLM interactions for automated test generation. It solves the problem of consistently prompting LLMs to analyze code, plan test strategies, and generate test specifications by providing reusable prompt templates that request structured JSON responses. This enables automated test creation workflows where LLM recommendations can be programmatically processed and applied to codebases.",
      "rawContent": "```json\n{\n  \"purpose\": \"Provides prompt templates for LLM-based test generation, configuration analysis, and test planning strategies.\",\n  \"userVisibleActions\": [\n    \"Analyzes codebase to recommend optimal test setup and configuration\",\n    \"Generates prioritized test plans identifying critical functions to test\",\n    \"Creates detailed test specifications for individual functions\",\n    \"Provides test implementation guidance with examples and patterns\",\n    \"Suggests mock requirements for external dependencies like VSCode APIs\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer calls buildSetupPrompt() to analyze workspace and get test framework recommendations\",\n    \"Developer calls buildPlanningPrompt() to create a prioritized test strategy based on code analysis\",\n    \"Developer calls buildTestSpecPrompt() to generate detailed test specifications for specific functions\",\n    \"Developer calls buildImplementationPrompt() to get test implementation guidance with code examples\",\n    \"Receives structured JSON responses with dependencies, configurations, and test strategies\",\n    \"Gets language detection, framework selection, and mock requirements automatically\",\n    \"Receives prioritized function lists with complexity scores and coverage recommendations\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildSetupPrompt\",\n      \"desc\": \"Creates a prompt to analyze codebase and recommend test setup configuration\",\n      \"inputs\": \"workspaceRoot: string, fileList: string[], packageJsonContent?: string\",\n      \"outputs\": \"Prompt string requesting JSON with language, framework, dependencies, config files, and mock requirements\"\n    },\n    {\n      \"name\": \"buildPlanningPrompt\",\n      \"desc\": \"Generates a prompt to create a prioritized test plan based on code analysis\",\n      \"inputs\": \"context: CodeAnalysis, functions: any[], productDocs?: any, architectureInsights?: any\",\n      \"outputs\": \"Prompt string requesting JSON with prioritized functions, complexity scores, and testing strategy\"\n    },\n    {\n      \"name\": \"buildTestSpecPrompt\",\n      \"desc\": \"Creates a prompt to generate detailed test specifications for a specific function\",\n      \"inputs\": \"testableFunction: TestableFunction, codeContext: string, existingTests?: string\",\n      \"outputs\": \"Prompt string requesting JSON with test scenarios, edge cases, assertions, and mocking needs\"\n    },\n    {\n      \"name\": \"buildImplementationPrompt\",\n      \"desc\": \"Generates a prompt to provide test implementation guidance and code examples\",\n      \"inputs\": \"testSpec: any, framework: string, existingPatterns?: string\",\n      \"outputs\": \"Prompt string requesting JSON with implementation strategy, code examples, and best practices\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer (CodeAnalysis type)\",\n    \"../services/testing/types/testPlanTypes (TestableFunction type)\"\n  ],\n  \"intent\": \"This file exists to standardize and structure LLM interactions for automated test generation. It solves the problem of consistently prompting LLMs to analyze code, plan test strategies, and generate test specifications by providing reusable prompt templates that request structured JSON responses. This enables automated test creation workflows where LLM recommendations can be programmatically processed and applied to codebases.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T04:26:31.225Z"
  }
}