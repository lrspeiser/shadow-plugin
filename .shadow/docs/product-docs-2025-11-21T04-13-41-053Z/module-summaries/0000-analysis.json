{
  "module": "src/analysis",
  "moduleType": "other",
  "capabilities": [
    "Analyze TypeScript and JavaScript code files to extract detailed function metadata",
    "Calculate code complexity metrics including branch complexity and decision points",
    "Map function dependencies and relationships across the codebase",
    "Identify state mutations and side effects in functions",
    "Extract behavioral hints and function responsibilities",
    "Detect functions that may need refactoring based on size and complexity",
    "Track which functions are called by many other parts of the code (dependents)",
    "Parse function signatures and parameter information"
  ],
  "summary": "The analysis module provides comprehensive code analysis capabilities for TypeScript and JavaScript projects. It enables users to gain deep insights into their codebase by examining function-level details, complexity metrics, and inter-function relationships. This module is essential for understanding code quality, identifying refactoring opportunities, and mapping dependencies.\n\nUsers can leverage this module to analyze individual functions or entire files to understand code complexity through branch analysis, track how functions interact through dependency mapping, and identify potential code smells. The module extracts metadata such as function signatures, parameters, return types, and behavioral characteristics like state mutations and side effects.\n\nThe typical workflow involves passing source code files to the analyzers, which parse the Abstract Syntax Tree (AST) to extract function metadata. The enhanced analyzer provides detailed complexity metrics and behavioral insights, while the function analyzer focuses on relationships and refactoring candidates. Together, these tools help developers make informed decisions about code maintenance, refactoring priorities, and architectural improvements.",
  "files": [
    {
      "file": "src/analysis/enhancedAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Provides deep code analysis capabilities by parsing TypeScript/JavaScript files to extract function metadata, including branch complexity, dependencies, state mutations, and behavioral hints",
      "userVisibleActions": [
        "Receives detailed analysis of code functions including complexity metrics",
        "Gets insights into function behavior and side effects",
        "Views branch analysis showing decision points in code",
        "Sees dependency relationships between functions and modules",
        "Obtains state mutation information showing what data changes"
      ],
      "developerVisibleActions": [
        "Call analyzeFileMetadata() to extract comprehensive metadata for all functions in a file",
        "Receive FunctionMetadata objects containing branch analysis, dependency info, state mutations, and behavioral hints",
        "Get AST-based analysis for TypeScript/JavaScript files with full type information",
        "Fallback to regex-based analysis for non-TypeScript languages",
        "Extract function content by line ranges for targeted analysis",
        "Analyze function complexity, conditional branches, and control flow",
        "Identify external dependencies and function calls within code",
        "Detect state mutations and side effects in functions",
        "Map test coverage and relationships to test files"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFileMetadata",
          "desc": "Analyzes a file and extracts enhanced metadata for all functions including branches, dependencies, and mutations",
          "inputs": "filePath: string, content: string, language: string, functions: FunctionInfo[]",
          "outputs": "Promise<Map<string, FunctionMetadata>> - Map of function names to their detailed metadata"
        },
        {
          "name": "analyzeTypeScriptFunction",
          "desc": "Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed structural and behavioral information",
          "inputs": "filePath: string, content: string, func: FunctionInfo, functionContent: string",
          "outputs": "Promise<FunctionMetadata> - Comprehensive function metadata"
        },
        {
          "name": "analyzeFunctionWithRegex",
          "desc": "Provides fallback regex-based analysis for non-TypeScript languages to extract basic function metadata",
          "inputs": "filePath: string, func: FunctionInfo, functionContent: string, language: string",
          "outputs": "FunctionMetadata - Basic function metadata"
        },
        {
          "name": "extractFunctionContent",
          "desc": "Extracts the source code content of a function given its start and end line numbers",
          "inputs": "content: string, startLine: number, endLine: number",
          "outputs": "string - The function's source code"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer"
      ],
      "intent": "This file exists to provide advanced code analysis beyond basic function detection. It solves the problem of understanding code behavior, complexity, and relationships by parsing Abstract Syntax Trees (AST) to extract branch conditions, dependencies, state changes, and behavioral patterns. This enables intelligent code documentation, test generation, and impact analysis by understanding not just what functions exist, but how they work and what they affect.",
      "rawContent": "```json\n{\n  \"purpose\": \"Provides deep code analysis capabilities by parsing TypeScript/JavaScript files to extract function metadata, including branch complexity, dependencies, state mutations, and behavioral hints\",\n  \"userVisibleActions\": [\n    \"Receives detailed analysis of code functions including complexity metrics\",\n    \"Gets insights into function behavior and side effects\",\n    \"Views branch analysis showing decision points in code\",\n    \"Sees dependency relationships between functions and modules\",\n    \"Obtains state mutation information showing what data changes\"\n  ],\n  \"developerVisibleActions\": [\n    \"Call analyzeFileMetadata() to extract comprehensive metadata for all functions in a file\",\n    \"Receive FunctionMetadata objects containing branch analysis, dependency info, state mutations, and behavioral hints\",\n    \"Get AST-based analysis for TypeScript/JavaScript files with full type information\",\n    \"Fallback to regex-based analysis for non-TypeScript languages\",\n    \"Extract function content by line ranges for targeted analysis\",\n    \"Analyze function complexity, conditional branches, and control flow\",\n    \"Identify external dependencies and function calls within code\",\n    \"Detect state mutations and side effects in functions\",\n    \"Map test coverage and relationships to test files\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a file and extracts enhanced metadata for all functions including branches, dependencies, and mutations\",\n      \"inputs\": \"filePath: string, content: string, language: string, functions: FunctionInfo[]\",\n      \"outputs\": \"Promise<Map<string, FunctionMetadata>> - Map of function names to their detailed metadata\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed structural and behavioral information\",\n      \"inputs\": \"filePath: string, content: string, func: FunctionInfo, functionContent: string\",\n      \"outputs\": \"Promise<FunctionMetadata> - Comprehensive function metadata\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides fallback regex-based analysis for non-TypeScript languages to extract basic function metadata\",\n      \"inputs\": \"filePath: string, func: FunctionInfo, functionContent: string, language: string\",\n      \"outputs\": \"FunctionMetadata - Basic function metadata\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function given its start and end line numbers\",\n      \"inputs\": \"content: string, startLine: number, endLine: number\",\n      \"outputs\": \"string - The function's source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\"\n  ],\n  \"intent\": \"This file exists to provide advanced code analysis beyond basic function detection. It solves the problem of understanding code behavior, complexity, and relationships by parsing Abstract Syntax Trees (AST) to extract branch conditions, dependencies, state changes, and behavioral patterns. This enables intelligent code documentation, test generation, and impact analysis by understanding not just what functions exist, but how they work and what they affect.\"\n}\n```"
    },
    {
      "file": "src/analysis/functionAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, dependents, and responsibilities for refactoring reports.",
      "userVisibleActions": [
        "Identifies which functions in large files may need refactoring",
        "Shows function dependencies and relationships across the codebase",
        "Reveals which functions are called by many other parts of the code",
        "Displays function signatures and their responsibilities"
      ],
      "developerVisibleActions": [
        "Filters code analysis to focus on files exceeding a size threshold (default 500 lines)",
        "Extracts function metadata from TypeScript files including name, signature, and location",
        "Maps out which functions depend on other functions (dependencies)",
        "Identifies which functions are called by the analyzed function (dependents)",
        "Generates structured function analysis data for refactoring prompt builders",
        "Handles analysis failures gracefully with warnings for individual functions"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFunctions",
          "desc": "Analyzes all functions in large files to extract detailed information for refactoring",
          "inputs": "codeAnalysis (full code analysis), largeFileThreshold (minimum lines, default 500)",
          "outputs": "Array of FunctionAnalysis objects with detailed metadata"
        },
        {
          "name": "analyzeFunction",
          "desc": "Performs deep analysis on a single function to extract dependencies, dependents, and metadata",
          "inputs": "filePath (file location), func (FunctionInfo), codeAnalysis (context)",
          "outputs": "FunctionAnalysis object or null if analysis fails"
        },
        {
          "name": "resolveFilePath",
          "desc": "Resolves relative file paths to absolute paths for file system access",
          "inputs": "filePath (relative path), codeAnalysis (for base directory)",
          "outputs": "Absolute file path string"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer",
        "../domain/prompts/refactoringPromptBuilder"
      ],
      "intent": "This file exists to provide deep function-level analysis for large files that may need refactoring. It solves the problem of understanding complex function relationships and responsibilities when deciding how to break up large code files. By extracting detailed metadata about each function's dependencies, callers, and purpose, it enables automated generation of refactoring recommendations and reports.",
      "rawContent": "```json\n{\n  \"purpose\": \"Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, dependents, and responsibilities for refactoring reports.\",\n  \"userVisibleActions\": [\n    \"Identifies which functions in large files may need refactoring\",\n    \"Shows function dependencies and relationships across the codebase\",\n    \"Reveals which functions are called by many other parts of the code\",\n    \"Displays function signatures and their responsibilities\"\n  ],\n  \"developerVisibleActions\": [\n    \"Filters code analysis to focus on files exceeding a size threshold (default 500 lines)\",\n    \"Extracts function metadata from TypeScript files including name, signature, and location\",\n    \"Maps out which functions depend on other functions (dependencies)\",\n    \"Identifies which functions are called by the analyzed function (dependents)\",\n    \"Generates structured function analysis data for refactoring prompt builders\",\n    \"Handles analysis failures gracefully with warnings for individual functions\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Analyzes all functions in large files to extract detailed information for refactoring\",\n      \"inputs\": \"codeAnalysis (full code analysis), largeFileThreshold (minimum lines, default 500)\",\n      \"outputs\": \"Array of FunctionAnalysis objects with detailed metadata\"\n    },\n    {\n      \"name\": \"analyzeFunction\",\n      \"desc\": \"Performs deep analysis on a single function to extract dependencies, dependents, and metadata\",\n      \"inputs\": \"filePath (file location), func (FunctionInfo), codeAnalysis (context)\",\n      \"outputs\": \"FunctionAnalysis object or null if analysis fails\"\n    },\n    {\n      \"name\": \"resolveFilePath\",\n      \"desc\": \"Resolves relative file paths to absolute paths for file system access\",\n      \"inputs\": \"filePath (relative path), codeAnalysis (for base directory)\",\n      \"outputs\": \"Absolute file path string\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\",\n    \"../domain/prompts/refactoringPromptBuilder\"\n  ],\n  \"intent\": \"This file exists to provide deep function-level analysis for large files that may need refactoring. It solves the problem of understanding complex function relationships and responsibilities when deciding how to break up large code files. By extracting detailed metadata about each function's dependencies, callers, and purpose, it enables automated generation of refactoring recommendations and reports.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T04:25:05.996Z"
  }
}