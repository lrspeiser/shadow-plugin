{
  "file": "src/context/analysisContextBuilder.ts",
  "role": "Core Logic",
  "purpose": "Converts code analysis results into a format suitable for LLM consumption and persists analysis data to disk for future reference",
  "userVisibleActions": [
    "Analysis results are automatically saved to the workspace for future use",
    "Code analysis data is stored in a .shadow/docs directory within the project"
  ],
  "developerVisibleActions": [
    "Converts CodeAnalysis objects into AnalysisContext format that can be sent to LLM services",
    "Saves analysis results with metadata (generation timestamp, workspace path) to code-analysis.json",
    "Creates .shadow/docs directory structure if it doesn't exist",
    "Handles workspace detection and validation before saving files"
  ],
  "keyFunctions": [
    {
      "name": "convertCodeAnalysisToContext",
      "desc": "Transforms CodeAnalysis data structure into AnalysisContext format for LLM processing",
      "inputs": "CodeAnalysis object containing files, imports, entry points, and metrics",
      "outputs": "AnalysisContext object with restructured file information, imports, entry points, and statistics"
    },
    {
      "name": "saveCodeAnalysis",
      "desc": "Persists code analysis results to the workspace filesystem for later retrieval",
      "inputs": "CodeAnalysis object to be saved",
      "outputs": "void - creates/updates code-analysis.json file in .shadow/docs directory"
    }
  ],
  "dependencies": [
    "vscode",
    "fs",
    "path",
    "../analyzer",
    "../llmService"
  ],
  "intent": "This file exists to bridge the gap between code analysis results and LLM consumption by reformatting the data, and to provide persistence so that expensive analysis operations don't need to be repeated. It solves the problem of maintaining analysis state across sessions and preparing data in the exact format required by the LLM service.",
  "rawContent": "```json\n{\n  \"purpose\": \"Converts code analysis results into a format suitable for LLM consumption and persists analysis data to disk for future reference\",\n  \"userVisibleActions\": [\n    \"Analysis results are automatically saved to the workspace for future use\",\n    \"Code analysis data is stored in a .shadow/docs directory within the project\"\n  ],\n  \"developerVisibleActions\": [\n    \"Converts CodeAnalysis objects into AnalysisContext format that can be sent to LLM services\",\n    \"Saves analysis results with metadata (generation timestamp, workspace path) to code-analysis.json\",\n    \"Creates .shadow/docs directory structure if it doesn't exist\",\n    \"Handles workspace detection and validation before saving files\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"convertCodeAnalysisToContext\",\n      \"desc\": \"Transforms CodeAnalysis data structure into AnalysisContext format for LLM processing\",\n      \"inputs\": \"CodeAnalysis object containing files, imports, entry points, and metrics\",\n      \"outputs\": \"AnalysisContext object with restructured file information, imports, entry points, and statistics\"\n    },\n    {\n      \"name\": \"saveCodeAnalysis\",\n      \"desc\": \"Persists code analysis results to the workspace filesystem for later retrieval\",\n      \"inputs\": \"CodeAnalysis object to be saved\",\n      \"outputs\": \"void - creates/updates code-analysis.json file in .shadow/docs directory\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"fs\",\n    \"path\",\n    \"../analyzer\",\n    \"../llmService\"\n  ],\n  \"intent\": \"This file exists to bridge the gap between code analysis results and LLM consumption by reformatting the data, and to provide persistence so that expensive analysis operations don't need to be repeated. It solves the problem of maintaining analysis state across sessions and preparing data in the exact format required by the LLM service.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-19T21:15:53.524Z"
  }
}