{
  "file": "src/domain/prompts/refactoringPromptBuilder.ts",
  "role": "Core Logic",
  "purpose": "Generates detailed, prescriptive prompts for LLM-based code refactoring analysis with extraction plans and migration steps.",
  "userVisibleActions": [
    "Receives comprehensive refactoring reports that explain what code should be extracted and why",
    "Gets detailed step-by-step migration instructions for code reorganization",
    "Views before-and-after code examples showing proposed refactoring changes",
    "Sees function-level analysis including responsibilities, dependencies, and call relationships"
  ],
  "developerVisibleActions": [
    "Creates structured prompts that guide LLMs to generate refactoring recommendations",
    "Combines code analysis, product documentation, and architecture insights into refactoring instructions",
    "Builds extraction plans that specify which functions should move to which files",
    "Generates function analysis reports showing dependencies, dependents, and responsibilities",
    "Provides detailed requirements for code extraction with migration steps and examples"
  ],
  "keyFunctions": [
    {
      "name": "buildDetailedRefactoringPrompt",
      "desc": "Constructs a comprehensive prompt for generating refactoring reports with function analysis and extraction plans",
      "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array",
      "outputs": "Complete prompt string for LLM refactoring analysis"
    },
    {
      "name": "buildBasePrompt",
      "desc": "Creates the foundational prompt structure combining context, code analysis, and documentation",
      "inputs": "AnalysisContext, CodeAnalysis, optional ProductDocumentation, optional ArchitectureInsights",
      "outputs": "Base prompt string"
    },
    {
      "name": "buildFunctionAnalysisSection",
      "desc": "Generates detailed analysis section for individual functions showing their relationships and responsibilities",
      "inputs": "Array of FunctionAnalysis objects",
      "outputs": "Formatted function analysis text"
    },
    {
      "name": "buildExtractionRequirementsSection",
      "desc": "Creates instructions for how to structure code extraction recommendations",
      "inputs": "None (defines format requirements)",
      "outputs": "Extraction requirements text"
    }
  ],
  "dependencies": [
    "../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)",
    "../../llmService (AnalysisContext, LLMInsights)",
    "../../fileDocumentation (EnhancedProductDocumentation)"
  ],
  "intent": "This file exists to standardize and enhance how refactoring instructions are communicated to LLMs, ensuring they generate actionable, detailed refactoring reports with concrete extraction plans, migration steps, and code examples rather than vague suggestions.",
  "rawContent": "```json\n{\n  \"purpose\": \"Generates detailed, prescriptive prompts for LLM-based code refactoring analysis with extraction plans and migration steps.\",\n  \"userVisibleActions\": [\n    \"Receives comprehensive refactoring reports that explain what code should be extracted and why\",\n    \"Gets detailed step-by-step migration instructions for code reorganization\",\n    \"Views before-and-after code examples showing proposed refactoring changes\",\n    \"Sees function-level analysis including responsibilities, dependencies, and call relationships\"\n  ],\n  \"developerVisibleActions\": [\n    \"Creates structured prompts that guide LLMs to generate refactoring recommendations\",\n    \"Combines code analysis, product documentation, and architecture insights into refactoring instructions\",\n    \"Builds extraction plans that specify which functions should move to which files\",\n    \"Generates function analysis reports showing dependencies, dependents, and responsibilities\",\n    \"Provides detailed requirements for code extraction with migration steps and examples\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildDetailedRefactoringPrompt\",\n      \"desc\": \"Constructs a comprehensive prompt for generating refactoring reports with function analysis and extraction plans\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array\",\n      \"outputs\": \"Complete prompt string for LLM refactoring analysis\"\n    },\n    {\n      \"name\": \"buildBasePrompt\",\n      \"desc\": \"Creates the foundational prompt structure combining context, code analysis, and documentation\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional ProductDocumentation, optional ArchitectureInsights\",\n      \"outputs\": \"Base prompt string\"\n    },\n    {\n      \"name\": \"buildFunctionAnalysisSection\",\n      \"desc\": \"Generates detailed analysis section for individual functions showing their relationships and responsibilities\",\n      \"inputs\": \"Array of FunctionAnalysis objects\",\n      \"outputs\": \"Formatted function analysis text\"\n    },\n    {\n      \"name\": \"buildExtractionRequirementsSection\",\n      \"desc\": \"Creates instructions for how to structure code extraction recommendations\",\n      \"inputs\": \"None (defines format requirements)\",\n      \"outputs\": \"Extraction requirements text\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)\",\n    \"../../llmService (AnalysisContext, LLMInsights)\",\n    \"../../fileDocumentation (EnhancedProductDocumentation)\"\n  ],\n  \"intent\": \"This file exists to standardize and enhance how refactoring instructions are communicated to LLMs, ensuring they generate actionable, detailed refactoring reports with concrete extraction plans, migration steps, and code examples rather than vague suggestions.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-19T21:17:40.770Z"
  }
}