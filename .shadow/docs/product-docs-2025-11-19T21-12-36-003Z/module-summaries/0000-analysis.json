{
  "module": "src/analysis",
  "moduleType": "other",
  "capabilities": [
    "Deep code analysis through Abstract Syntax Tree (AST) parsing to understand code structure and behavior",
    "Function-level analysis to identify refactoring opportunities in large code files",
    "Branch complexity and decision point detection to assess code maintainability",
    "Dependency mapping between modules and functions to visualize code relationships",
    "State mutation and side effect identification to understand function behavior",
    "Test coverage mapping to functions for quality assessment",
    "Size threshold detection to flag functions that may need refactoring",
    "Extraction of function signatures, dependencies, and responsibilities for documentation"
  ],
  "summary": "The analysis module provides comprehensive code analysis capabilities for understanding and improving codebases. It performs deep inspection of code using AST parsing to extract detailed metadata about functions, including their complexity, dependencies, state changes, and behavioral characteristics. This enables developers to make informed decisions about code quality and refactoring needs.\n\nUsers can leverage this module to identify problematic code patterns, understand function relationships, and generate detailed refactoring reports for large files. The module analyzes branch complexity to highlight decision-heavy code, maps dependencies to show how components interact, and identifies state mutations that may introduce bugs. It also correlates test coverage with functions to reveal gaps in testing.\n\nThe primary workflow involves analyzing code files to extract function-level insights, then generating comprehensive reports that highlight refactoring opportunities. The module flags functions exceeding size thresholds, provides detailed signatures and responsibilities, and shows call relationships between functions. This systematic analysis helps teams maintain code quality and plan refactoring efforts effectively.",
  "files": [
    {
      "file": "src/analysis/enhancedAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Performs deep code analysis by parsing Abstract Syntax Trees (AST) to extract detailed function metadata including branches, dependencies, state mutations, and behavioral hints.",
      "userVisibleActions": [
        "Provides detailed insights about code behavior and function characteristics",
        "Shows branch complexity and decision points in code",
        "Reveals dependencies between code modules and functions",
        "Identifies state mutations and side effects in functions",
        "Maps test coverage to functions"
      ],
      "developerVisibleActions": [
        "Analyzes TypeScript/JavaScript files using AST parsing to extract function metadata",
        "Extracts branch information (if/else, switch, loops) from function bodies",
        "Profiles dependencies between functions and external modules",
        "Detects state mutations and tracks which variables/objects are modified",
        "Generates behavioral hints about function purpose and side effects",
        "Maps test files to source code functions",
        "Provides fallback regex-based analysis for non-TypeScript languages",
        "Returns structured metadata including complexity metrics and code patterns"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFileMetadata",
          "desc": "Analyzes a single code file and extracts enhanced metadata for all functions in it",
          "inputs": "filePath: string, content: string, language: string, functions: FunctionInfo[]",
          "outputs": "Map<string, FunctionMetadata> containing detailed function analysis"
        },
        {
          "name": "analyzeTypeScriptFunction",
          "desc": "Uses TypeScript AST parser to deeply analyze a function's structure, branches, dependencies, and behavior",
          "inputs": "filePath: string, content: string, func: FunctionInfo, functionContent: string",
          "outputs": "FunctionMetadata with AST-derived insights"
        },
        {
          "name": "analyzeFunctionWithRegex",
          "desc": "Provides basic function analysis using pattern matching for languages without AST support",
          "inputs": "filePath: string, func: FunctionInfo, functionContent: string, language: string",
          "outputs": "FunctionMetadata with regex-based analysis"
        },
        {
          "name": "extractFunctionContent",
          "desc": "Extracts the source code content of a function between specified line numbers",
          "inputs": "content: string, startLine: number, endLine: number",
          "outputs": "string containing the function's source code"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer"
      ],
      "intent": "This file exists to provide advanced code analysis capabilities beyond basic syntax parsing. It solves the problem of understanding code behavior, complexity, and relationships by parsing the AST structure, enabling features like intelligent test generation, code documentation, and dependency mapping. It bridges the gap between simple text analysis and deep semantic understanding of code.",
      "rawContent": "```json\n{\n  \"purpose\": \"Performs deep code analysis by parsing Abstract Syntax Trees (AST) to extract detailed function metadata including branches, dependencies, state mutations, and behavioral hints.\",\n  \"userVisibleActions\": [\n    \"Provides detailed insights about code behavior and function characteristics\",\n    \"Shows branch complexity and decision points in code\",\n    \"Reveals dependencies between code modules and functions\",\n    \"Identifies state mutations and side effects in functions\",\n    \"Maps test coverage to functions\"\n  ],\n  \"developerVisibleActions\": [\n    \"Analyzes TypeScript/JavaScript files using AST parsing to extract function metadata\",\n    \"Extracts branch information (if/else, switch, loops) from function bodies\",\n    \"Profiles dependencies between functions and external modules\",\n    \"Detects state mutations and tracks which variables/objects are modified\",\n    \"Generates behavioral hints about function purpose and side effects\",\n    \"Maps test files to source code functions\",\n    \"Provides fallback regex-based analysis for non-TypeScript languages\",\n    \"Returns structured metadata including complexity metrics and code patterns\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a single code file and extracts enhanced metadata for all functions in it\",\n      \"inputs\": \"filePath: string, content: string, language: string, functions: FunctionInfo[]\",\n      \"outputs\": \"Map<string, FunctionMetadata> containing detailed function analysis\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Uses TypeScript AST parser to deeply analyze a function's structure, branches, dependencies, and behavior\",\n      \"inputs\": \"filePath: string, content: string, func: FunctionInfo, functionContent: string\",\n      \"outputs\": \"FunctionMetadata with AST-derived insights\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides basic function analysis using pattern matching for languages without AST support\",\n      \"inputs\": \"filePath: string, func: FunctionInfo, functionContent: string, language: string\",\n      \"outputs\": \"FunctionMetadata with regex-based analysis\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function between specified line numbers\",\n      \"inputs\": \"content: string, startLine: number, endLine: number\",\n      \"outputs\": \"string containing the function's source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\"\n  ],\n  \"intent\": \"This file exists to provide advanced code analysis capabilities beyond basic syntax parsing. It solves the problem of understanding code behavior, complexity, and relationships by parsing the AST structure, enabling features like intelligent test generation, code documentation, and dependency mapping. It bridges the gap between simple text analysis and deep semantic understanding of code.\"\n}\n```"
    },
    {
      "file": "src/analysis/functionAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Analyzes functions in large code files to extract detailed information for generating refactoring reports",
      "userVisibleActions": [
        "Generates detailed analysis reports for functions in large files",
        "Identifies functions that exceed size thresholds and may need refactoring",
        "Provides function signatures, dependencies, and responsibilities in refactoring reports",
        "Shows which functions call or are called by other functions"
      ],
      "developerVisibleActions": [
        "Analyzes all functions in files exceeding a specified line threshold (default 500 lines)",
        "Extracts function metadata including signatures, parameters, return types",
        "Identifies function dependencies (what the function calls)",
        "Identifies function dependents (what calls this function)",
        "Determines function responsibilities by analyzing code behavior",
        "Resolves file paths from the code analysis results",
        "Handles analysis errors gracefully with warnings",
        "Returns structured FunctionAnalysis objects for report generation"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFunctions",
          "desc": "Analyzes all functions in large files and extracts detailed information for refactoring",
          "inputs": "codeAnalysis (full code analysis results), largeFileThreshold (line count threshold, default 500)",
          "outputs": "Array of FunctionAnalysis objects containing detailed function information"
        },
        {
          "name": "analyzeFunction",
          "desc": "Performs detailed analysis of a single function including dependencies and responsibilities",
          "inputs": "filePath (file location), func (function info object), codeAnalysis (full analysis context)",
          "outputs": "FunctionAnalysis object with complete function details, or null if analysis fails"
        },
        {
          "name": "resolveFilePath",
          "desc": "Resolves relative or absolute file paths to full file system paths",
          "inputs": "filePath (path to resolve), codeAnalysis (context for resolution)",
          "outputs": "Full resolved file path"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer",
        "../domain/prompts/refactoringPromptBuilder"
      ],
      "intent": "This file exists to provide detailed function-level analysis for code refactoring recommendations. It extracts comprehensive information about functions in large files (signatures, dependencies, relationships) that can be used to generate intelligent refactoring suggestions and reports, helping developers identify functions that may benefit from restructuring or breaking into smaller components.",
      "rawContent": "```json\n{\n  \"purpose\": \"Analyzes functions in large code files to extract detailed information for generating refactoring reports\",\n  \"userVisibleActions\": [\n    \"Generates detailed analysis reports for functions in large files\",\n    \"Identifies functions that exceed size thresholds and may need refactoring\",\n    \"Provides function signatures, dependencies, and responsibilities in refactoring reports\",\n    \"Shows which functions call or are called by other functions\"\n  ],\n  \"developerVisibleActions\": [\n    \"Analyzes all functions in files exceeding a specified line threshold (default 500 lines)\",\n    \"Extracts function metadata including signatures, parameters, return types\",\n    \"Identifies function dependencies (what the function calls)\",\n    \"Identifies function dependents (what calls this function)\",\n    \"Determines function responsibilities by analyzing code behavior\",\n    \"Resolves file paths from the code analysis results\",\n    \"Handles analysis errors gracefully with warnings\",\n    \"Returns structured FunctionAnalysis objects for report generation\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Analyzes all functions in large files and extracts detailed information for refactoring\",\n      \"inputs\": \"codeAnalysis (full code analysis results), largeFileThreshold (line count threshold, default 500)\",\n      \"outputs\": \"Array of FunctionAnalysis objects containing detailed function information\"\n    },\n    {\n      \"name\": \"analyzeFunction\",\n      \"desc\": \"Performs detailed analysis of a single function including dependencies and responsibilities\",\n      \"inputs\": \"filePath (file location), func (function info object), codeAnalysis (full analysis context)\",\n      \"outputs\": \"FunctionAnalysis object with complete function details, or null if analysis fails\"\n    },\n    {\n      \"name\": \"resolveFilePath\",\n      \"desc\": \"Resolves relative or absolute file paths to full file system paths\",\n      \"inputs\": \"filePath (path to resolve), codeAnalysis (context for resolution)\",\n      \"outputs\": \"Full resolved file path\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\",\n    \"../domain/prompts/refactoringPromptBuilder\"\n  ],\n  \"intent\": \"This file exists to provide detailed function-level analysis for code refactoring recommendations. It extracts comprehensive information about functions in large files (signatures, dependencies, relationships) that can be used to generate intelligent refactoring suggestions and reports, helping developers identify functions that may benefit from restructuring or breaking into smaller components.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-19T21:25:04.243Z"
  }
}