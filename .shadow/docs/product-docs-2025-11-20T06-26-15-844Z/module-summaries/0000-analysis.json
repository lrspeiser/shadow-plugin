{
  "module": "src/analysis",
  "moduleType": "other",
  "capabilities": [
    "Deep code analysis using AST parsing to understand code structure and behavior",
    "Function-level metadata extraction including signatures, dependencies, and responsibilities",
    "Branch logic and complexity analysis to identify testing gaps",
    "State mutation and side effect detection",
    "Behavioral pattern recognition to understand what code does from a user perspective",
    "Large file refactoring recommendations based on function relationships",
    "Enhanced test coverage suggestions based on actual code paths and complexity"
  ],
  "summary": "The analysis module provides comprehensive code intelligence capabilities that help users understand, refactor, and test their codebase more effectively. It uses AST parsing to extract deep insights about code behavior, function relationships, and structural patterns.\n\nUsers can leverage this module to receive detailed reports about function responsibilities, dependencies, and behavioral characteristics. The module analyzes branching logic, state mutations, and complexity metrics to generate actionable recommendations for test coverage improvements. For large files, it identifies refactoring opportunities by mapping out function relationships and responsibilities, making it easier to split monolithic code into maintainable units.\n\nThe analysis workflow starts with parsing code files to build a structural understanding, then extracts function-level metadata including what each function does, what it depends on, and how it affects system state. This information feeds into recommendation engines that suggest where to add tests, which functions to refactor, and how code behavior impacts the overall system. The module bridges the gap between raw code structure and human-understandable insights about code purpose and quality.",
  "files": [
    {
      "file": "src/analysis/enhancedAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Provides deep code analysis capabilities that extract function metadata, branch logic, dependencies, state mutations, and behavioral patterns from code files using AST parsing.",
      "userVisibleActions": [
        "Receives detailed analysis of code behavior including what functions do and how they interact",
        "Gets information about code complexity and branching logic",
        "Sees enhanced test coverage recommendations based on code structure",
        "Receives behavioral hints about what code does from a user perspective"
      ],
      "developerVisibleActions": [
        "Developer calls analyzeFileMetadata() to get comprehensive function metadata for a file",
        "Developer receives structured data about branches, dependencies, and state mutations",
        "Developer gets AST-based analysis for TypeScript/JavaScript and regex-based fallback for other languages",
        "Developer accesses branch information showing conditional logic and decision points in code",
        "Developer receives dependency profiling showing which modules and functions are imported/used",
        "Developer gets state mutation tracking showing which variables and properties are modified",
        "Developer receives behavioral hints describing what code does from an external perspective",
        "Developer can extract function content between specific line ranges",
        "Developer gets test mapping suggestions for better code coverage"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFileMetadata",
          "desc": "Analyzes a file and extracts enhanced metadata for all functions including branches, dependencies, and behavioral patterns",
          "inputs": "filePath (string), content (string), language (string), functions (FunctionInfo[])",
          "outputs": "Promise<Map<string, FunctionMetadata>> - Map of function names to their metadata"
        },
        {
          "name": "analyzeTypeScriptFunction",
          "desc": "Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed metadata",
          "inputs": "filePath (string), content (string), func (FunctionInfo), functionContent (string)",
          "outputs": "Promise<FunctionMetadata> - Detailed function metadata including AST-parsed information"
        },
        {
          "name": "analyzeFunctionWithRegex",
          "desc": "Provides fallback regex-based analysis for languages that don't have AST parsing support",
          "inputs": "filePath (string), func (FunctionInfo), functionContent (string), language (string)",
          "outputs": "FunctionMetadata - Basic function metadata extracted via pattern matching"
        },
        {
          "name": "extractFunctionContent",
          "desc": "Extracts the source code content of a function between specified line numbers",
          "inputs": "content (string), startLine (number), endLine (number)",
          "outputs": "string - The extracted function source code"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer (CodeAnalysis, FunctionMetadata, BranchInfo, DependencyInfo, StateMutationInfo, TestMapping, BehavioralHints, FunctionInfo)"
      ],
      "intent": "This file exists to provide sophisticated code understanding capabilities that go beyond basic parsing. It solves the problem of deeply understanding code behavior by extracting not just what functions exist, but how they work (branches), what they depend on (imports), what they change (mutations), and what they do from a behavioral perspective. This enables intelligent test generation, documentation, and code comprehension features.",
      "rawContent": "```json\n{\n  \"purpose\": \"Provides deep code analysis capabilities that extract function metadata, branch logic, dependencies, state mutations, and behavioral patterns from code files using AST parsing.\",\n  \"userVisibleActions\": [\n    \"Receives detailed analysis of code behavior including what functions do and how they interact\",\n    \"Gets information about code complexity and branching logic\",\n    \"Sees enhanced test coverage recommendations based on code structure\",\n    \"Receives behavioral hints about what code does from a user perspective\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer calls analyzeFileMetadata() to get comprehensive function metadata for a file\",\n    \"Developer receives structured data about branches, dependencies, and state mutations\",\n    \"Developer gets AST-based analysis for TypeScript/JavaScript and regex-based fallback for other languages\",\n    \"Developer accesses branch information showing conditional logic and decision points in code\",\n    \"Developer receives dependency profiling showing which modules and functions are imported/used\",\n    \"Developer gets state mutation tracking showing which variables and properties are modified\",\n    \"Developer receives behavioral hints describing what code does from an external perspective\",\n    \"Developer can extract function content between specific line ranges\",\n    \"Developer gets test mapping suggestions for better code coverage\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a file and extracts enhanced metadata for all functions including branches, dependencies, and behavioral patterns\",\n      \"inputs\": \"filePath (string), content (string), language (string), functions (FunctionInfo[])\",\n      \"outputs\": \"Promise<Map<string, FunctionMetadata>> - Map of function names to their metadata\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed metadata\",\n      \"inputs\": \"filePath (string), content (string), func (FunctionInfo), functionContent (string)\",\n      \"outputs\": \"Promise<FunctionMetadata> - Detailed function metadata including AST-parsed information\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides fallback regex-based analysis for languages that don't have AST parsing support\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), functionContent (string), language (string)\",\n      \"outputs\": \"FunctionMetadata - Basic function metadata extracted via pattern matching\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function between specified line numbers\",\n      \"inputs\": \"content (string), startLine (number), endLine (number)\",\n      \"outputs\": \"string - The extracted function source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer (CodeAnalysis, FunctionMetadata, BranchInfo, DependencyInfo, StateMutationInfo, TestMapping, BehavioralHints, FunctionInfo)\"\n  ],\n  \"intent\": \"This file exists to provide sophisticated code understanding capabilities that go beyond basic parsing. It solves the problem of deeply understanding code behavior by extracting not just what functions exist, but how they work (branches), what they depend on (imports), what they change (mutations), and what they do from a behavioral perspective. This enables intelligent test generation, documentation, and code comprehension features.\"\n}\n```"
    },
    {
      "file": "src/analysis/functionAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Analyzes functions in large code files to extract detailed information about signatures, dependencies, and responsibilities for refactoring recommendations.",
      "userVisibleActions": [
        "Receives refactoring reports that identify which functions in large files should be split or refactored",
        "Gets function-level insights showing what each function does and what it depends on",
        "Views function responsibilities and their relationships to other code"
      ],
      "developerVisibleActions": [
        "Analyzes functions in files exceeding a size threshold (default 500 lines)",
        "Extracts function signatures, parameters, and return types from TypeScript code",
        "Identifies function dependencies (what other code the function calls)",
        "Identifies function dependents (what other code calls this function)",
        "Determines function responsibilities and purpose",
        "Generates structured FunctionAnalysis objects for each function in large files",
        "Handles analysis failures gracefully with warnings when individual functions cannot be analyzed",
        "Resolves file paths and verifies file existence before analysis"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFunctions",
          "desc": "Analyzes all functions in files larger than the threshold size",
          "inputs": "codeAnalysis (CodeAnalysis object), largeFileThreshold (optional, default 500 lines)",
          "outputs": "Promise<FunctionAnalysis[]> - array of detailed function analyses"
        },
        {
          "name": "analyzeFunction",
          "desc": "Performs detailed analysis on a single function",
          "inputs": "filePath (string), func (FunctionInfo), codeAnalysis (CodeAnalysis)",
          "outputs": "Promise<FunctionAnalysis | null> - detailed function analysis or null if failed"
        },
        {
          "name": "resolveFilePath",
          "desc": "Resolves and validates the full path to a source file",
          "inputs": "filePath (string), codeAnalysis (CodeAnalysis)",
          "outputs": "string or null - full resolved file path"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer",
        "../domain/prompts/refactoringPromptBuilder"
      ],
      "intent": "This file exists to provide deep function-level analysis for refactoring recommendations. When developers work with large files, they need to understand which functions can be safely extracted or refactored. This analyzer inspects each function's signature, what it calls, what calls it, and what it does, enabling intelligent refactoring suggestions that maintain code correctness while improving maintainability.",
      "rawContent": "```json\n{\n  \"purpose\": \"Analyzes functions in large code files to extract detailed information about signatures, dependencies, and responsibilities for refactoring recommendations.\",\n  \"userVisibleActions\": [\n    \"Receives refactoring reports that identify which functions in large files should be split or refactored\",\n    \"Gets function-level insights showing what each function does and what it depends on\",\n    \"Views function responsibilities and their relationships to other code\"\n  ],\n  \"developerVisibleActions\": [\n    \"Analyzes functions in files exceeding a size threshold (default 500 lines)\",\n    \"Extracts function signatures, parameters, and return types from TypeScript code\",\n    \"Identifies function dependencies (what other code the function calls)\",\n    \"Identifies function dependents (what other code calls this function)\",\n    \"Determines function responsibilities and purpose\",\n    \"Generates structured FunctionAnalysis objects for each function in large files\",\n    \"Handles analysis failures gracefully with warnings when individual functions cannot be analyzed\",\n    \"Resolves file paths and verifies file existence before analysis\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Analyzes all functions in files larger than the threshold size\",\n      \"inputs\": \"codeAnalysis (CodeAnalysis object), largeFileThreshold (optional, default 500 lines)\",\n      \"outputs\": \"Promise<FunctionAnalysis[]> - array of detailed function analyses\"\n    },\n    {\n      \"name\": \"analyzeFunction\",\n      \"desc\": \"Performs detailed analysis on a single function\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), codeAnalysis (CodeAnalysis)\",\n      \"outputs\": \"Promise<FunctionAnalysis | null> - detailed function analysis or null if failed\"\n    },\n    {\n      \"name\": \"resolveFilePath\",\n      \"desc\": \"Resolves and validates the full path to a source file\",\n      \"inputs\": \"filePath (string), codeAnalysis (CodeAnalysis)\",\n      \"outputs\": \"string or null - full resolved file path\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\",\n    \"../domain/prompts/refactoringPromptBuilder\"\n  ],\n  \"intent\": \"This file exists to provide deep function-level analysis for refactoring recommendations. When developers work with large files, they need to understand which functions can be safely extracted or refactored. This analyzer inspects each function's signature, what it calls, what calls it, and what it does, enabling intelligent refactoring suggestions that maintain code correctness while improving maintainability.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T06:38:11.132Z"
  }
}