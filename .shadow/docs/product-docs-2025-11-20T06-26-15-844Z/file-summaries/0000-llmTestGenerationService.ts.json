{
  "file": "src/domain/services/testing/llmTestGenerationService.ts",
  "role": "Core Logic",
  "purpose": "Generates automated tests for code functions using AI/LLM in small batches, executing and validating them incrementally.",
  "userVisibleActions": [
    "Tests are generated automatically for selected functions in the codebase",
    "Progress updates show which function is currently being tested (e.g., '3 of 10: validateUser')",
    "Test results display pass/fail status for each generated test",
    "Coverage reports show which functions have tests and which need them",
    "Failed tests show error messages and execution details"
  ],
  "developerVisibleActions": [
    "Developer triggers test generation for a batch of functions",
    "System reads function source code and existing mocks automatically",
    "LLM generates test code based on function signatures and implementation",
    "Generated tests are written to the test directory structure",
    "Tests are executed immediately to verify they work",
    "Progress callback provides real-time updates during generation",
    "Results include test code, execution status, and any errors encountered"
  ],
  "keyFunctions": [
    {
      "name": "generateTestBatch",
      "desc": "Generates tests for multiple functions in sequence with progress tracking",
      "inputs": "functions array, workspace root path, LLM service, optional progress callback",
      "outputs": "Map of function names to test generation results (code, execution status, errors)"
    },
    {
      "name": "extractFunctionSource",
      "desc": "Retrieves the source code for a specific function from the file system",
      "inputs": "function metadata, workspace root",
      "outputs": "Source code string"
    },
    {
      "name": "buildGenerationPrompt",
      "desc": "Constructs the AI prompt with function details, source code, and existing mocks",
      "inputs": "function metadata, source code, test framework type, existing mock code",
      "outputs": "Formatted prompt string for LLM"
    },
    {
      "name": "generateTestForFunction",
      "desc": "Calls LLM service to generate test code for a single function",
      "inputs": "Prompt string",
      "outputs": "Test generation result with code and metadata"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "TestableFunction",
    "TestGenerationState",
    "TestGenerationResult",
    "buildGenerationPrompt",
    "TestExecutionService",
    "SWLogger"
  ],
  "intent": "This service solves the problem of manually writing tests by automating test generation using AI. It processes functions in manageable batches to avoid overwhelming the system, provides real-time progress feedback, and validates generated tests by executing them immediately. This enables developers to quickly achieve test coverage across their codebase.",
  "rawContent": "```json\n{\n  \"purpose\": \"Generates automated tests for code functions using AI/LLM in small batches, executing and validating them incrementally.\",\n  \"userVisibleActions\": [\n    \"Tests are generated automatically for selected functions in the codebase\",\n    \"Progress updates show which function is currently being tested (e.g., '3 of 10: validateUser')\",\n    \"Test results display pass/fail status for each generated test\",\n    \"Coverage reports show which functions have tests and which need them\",\n    \"Failed tests show error messages and execution details\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer triggers test generation for a batch of functions\",\n    \"System reads function source code and existing mocks automatically\",\n    \"LLM generates test code based on function signatures and implementation\",\n    \"Generated tests are written to the test directory structure\",\n    \"Tests are executed immediately to verify they work\",\n    \"Progress callback provides real-time updates during generation\",\n    \"Results include test code, execution status, and any errors encountered\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"generateTestBatch\",\n      \"desc\": \"Generates tests for multiple functions in sequence with progress tracking\",\n      \"inputs\": \"functions array, workspace root path, LLM service, optional progress callback\",\n      \"outputs\": \"Map of function names to test generation results (code, execution status, errors)\"\n    },\n    {\n      \"name\": \"extractFunctionSource\",\n      \"desc\": \"Retrieves the source code for a specific function from the file system\",\n      \"inputs\": \"function metadata, workspace root\",\n      \"outputs\": \"Source code string\"\n    },\n    {\n      \"name\": \"buildGenerationPrompt\",\n      \"desc\": \"Constructs the AI prompt with function details, source code, and existing mocks\",\n      \"inputs\": \"function metadata, source code, test framework type, existing mock code\",\n      \"outputs\": \"Formatted prompt string for LLM\"\n    },\n    {\n      \"name\": \"generateTestForFunction\",\n      \"desc\": \"Calls LLM service to generate test code for a single function\",\n      \"inputs\": \"Prompt string\",\n      \"outputs\": \"Test generation result with code and metadata\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"TestableFunction\",\n    \"TestGenerationState\",\n    \"TestGenerationResult\",\n    \"buildGenerationPrompt\",\n    \"TestExecutionService\",\n    \"SWLogger\"\n  ],\n  \"intent\": \"This service solves the problem of manually writing tests by automating test generation using AI. It processes functions in manageable batches to avoid overwhelming the system, provides real-time progress feedback, and validates generated tests by executing them immediately. This enables developers to quickly achieve test coverage across their codebase.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T06:32:24.126Z"
  }
}