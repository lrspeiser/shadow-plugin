{
  "file": "src/domain/prompts/refactoringPromptBuilder.ts",
  "role": "Core Logic",
  "purpose": "Builds detailed, prescriptive prompts for generating AI-driven code refactoring reports with extraction plans and migration guidance.",
  "userVisibleActions": [
    "Receives detailed refactoring recommendations showing which code should be extracted and where",
    "Gets step-by-step migration instructions for moving code between files",
    "Sees before-and-after code examples demonstrating proposed refactorings",
    "Views function dependency relationships to understand refactoring impacts",
    "Receives prescriptive guidance on how to organize code into better structures"
  ],
  "developerVisibleActions": [
    "Calls buildDetailedRefactoringPrompt() with code analysis context to generate refactoring instructions",
    "Provides function analyses, product documentation, and architecture insights to enrich refactoring guidance",
    "Receives structured extraction plans showing which functions to move from source to target files",
    "Gets migration steps and code examples to execute the refactoring safely",
    "Uses function metadata (dependencies, dependents, responsibilities) to inform extraction decisions"
  ],
  "keyFunctions": [
    {
      "name": "buildDetailedRefactoringPrompt",
      "desc": "Generates a comprehensive prompt for AI to create detailed refactoring reports with extraction plans",
      "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis[]",
      "outputs": "Formatted string prompt containing refactoring instructions and requirements"
    },
    {
      "name": "buildBasePrompt",
      "desc": "Creates the foundation prompt with context, code analysis, and architectural insights",
      "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights",
      "outputs": "Base prompt string"
    },
    {
      "name": "buildFunctionAnalysisSection",
      "desc": "Adds detailed function-level analysis including dependencies and responsibilities to the prompt",
      "inputs": "FunctionAnalysis[]",
      "outputs": "Formatted section describing function characteristics"
    },
    {
      "name": "buildExtractionRequirementsSection",
      "desc": "Specifies requirements for code extraction plans including target files and migration steps",
      "inputs": "None",
      "outputs": "Section detailing extraction plan requirements"
    }
  ],
  "dependencies": [
    "../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)",
    "../../llmService (AnalysisContext, LLMInsights)",
    "../../fileDocumentation (EnhancedProductDocumentation)"
  ],
  "intent": "This file exists to construct sophisticated AI prompts that guide language models in generating actionable, detailed refactoring recommendations. It solves the problem of getting generic or vague refactoring advice by providing structured context about code dependencies, function responsibilities, and architectural patterns, ensuring the AI produces specific extraction plans with concrete migration steps and code examples.",
  "rawContent": "```json\n{\n  \"purpose\": \"Builds detailed, prescriptive prompts for generating AI-driven code refactoring reports with extraction plans and migration guidance.\",\n  \"userVisibleActions\": [\n    \"Receives detailed refactoring recommendations showing which code should be extracted and where\",\n    \"Gets step-by-step migration instructions for moving code between files\",\n    \"Sees before-and-after code examples demonstrating proposed refactorings\",\n    \"Views function dependency relationships to understand refactoring impacts\",\n    \"Receives prescriptive guidance on how to organize code into better structures\"\n  ],\n  \"developerVisibleActions\": [\n    \"Calls buildDetailedRefactoringPrompt() with code analysis context to generate refactoring instructions\",\n    \"Provides function analyses, product documentation, and architecture insights to enrich refactoring guidance\",\n    \"Receives structured extraction plans showing which functions to move from source to target files\",\n    \"Gets migration steps and code examples to execute the refactoring safely\",\n    \"Uses function metadata (dependencies, dependents, responsibilities) to inform extraction decisions\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildDetailedRefactoringPrompt\",\n      \"desc\": \"Generates a comprehensive prompt for AI to create detailed refactoring reports with extraction plans\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis[]\",\n      \"outputs\": \"Formatted string prompt containing refactoring instructions and requirements\"\n    },\n    {\n      \"name\": \"buildBasePrompt\",\n      \"desc\": \"Creates the foundation prompt with context, code analysis, and architectural insights\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights\",\n      \"outputs\": \"Base prompt string\"\n    },\n    {\n      \"name\": \"buildFunctionAnalysisSection\",\n      \"desc\": \"Adds detailed function-level analysis including dependencies and responsibilities to the prompt\",\n      \"inputs\": \"FunctionAnalysis[]\",\n      \"outputs\": \"Formatted section describing function characteristics\"\n    },\n    {\n      \"name\": \"buildExtractionRequirementsSection\",\n      \"desc\": \"Specifies requirements for code extraction plans including target files and migration steps\",\n      \"inputs\": \"None\",\n      \"outputs\": \"Section detailing extraction plan requirements\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)\",\n    \"../../llmService (AnalysisContext, LLMInsights)\",\n    \"../../fileDocumentation (EnhancedProductDocumentation)\"\n  ],\n  \"intent\": \"This file exists to construct sophisticated AI prompts that guide language models in generating actionable, detailed refactoring recommendations. It solves the problem of getting generic or vague refactoring advice by providing structured context about code dependencies, function responsibilities, and architectural patterns, ensuring the AI produces specific extraction plans with concrete migration steps and code examples.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T06:31:19.876Z"
  }
}