{
  "file": "src/llmService.ts",
  "role": "Core Logic",
  "purpose": "Provides AI-powered code analysis services by coordinating with OpenAI/Claude to generate intelligent insights about code purpose, architecture, refactoring suggestions, and test plans.",
  "userVisibleActions": [
    "Generates explanations of what the codebase does and why it was built",
    "Provides intelligent refactoring suggestions for improving code quality",
    "Creates test plans showing what should be tested and why",
    "Explains the purpose and architecture of the entire product",
    "Generates comprehensive product documentation from code analysis",
    "Analyzes code complexity and suggests improvements",
    "Explains relationships between files and modules"
  ],
  "developerVisibleActions": [
    "Call AI service to analyze codebase and get product purpose analysis",
    "Request refactoring suggestions for specific functions or files",
    "Generate unit test plans based on code analysis",
    "Get insights about code quality, architecture patterns, and improvements",
    "Analyze file summaries to understand module structure",
    "Retrieve enhanced product documentation with AI-generated insights",
    "Process incremental analysis updates as code changes",
    "Configure which AI provider to use (OpenAI, Claude, or Gemini)",
    "Set custom API endpoints and model preferences",
    "Handle rate limiting and retry logic for AI requests automatically"
  ],
  "keyFunctions": [
    {
      "name": "analyzeProductPurpose",
      "desc": "Analyzes the entire codebase to determine what the product does and why it exists",
      "inputs": "context (file structure, imports, entry points), codeAnalysis (detailed code metrics)",
      "outputs": "ProductPurposeAnalysis with product purpose, architecture rationale, key features, and design decisions"
    },
    {
      "name": "generateProductDocumentation",
      "desc": "Creates comprehensive product documentation using AI analysis of code structure and patterns",
      "inputs": "fileSummaries (per-file analysis), moduleSummaries (module-level groupings), productPurpose (high-level purpose)",
      "outputs": "EnhancedProductDocumentation with overview, architecture, modules, features, and technical details"
    },
    {
      "name": "generateRefactoringSuggestion",
      "desc": "Provides AI-generated suggestions for improving code quality and structure",
      "inputs": "fileInfo (file metadata), functionMetadata (function details), codeContent (actual code)",
      "outputs": "Refactoring suggestions with severity, description, benefits, and implementation steps"
    },
    {
      "name": "generateUnitTestPlan",
      "desc": "Creates a test plan showing what should be tested and why based on code analysis",
      "inputs": "fileInfo, functionMetadata, codeContent, and existing test files",
      "outputs": "UnitTestPlan with test strategies, scenarios, coverage recommendations, and priority areas"
    },
    {
      "name": "getInsights",
      "desc": "Generates intelligent insights about code quality, patterns, and improvements",
      "inputs": "context (codebase structure), codeAnalysis (metrics), configuration (settings)",
      "outputs": "Array of insights categorized by type with descriptions and actionable recommendations"
    },
    {
      "name": "analyzeIncrementally",
      "desc": "Performs incremental analysis on changed files to provide fast, targeted insights",
      "inputs": "changedFiles (list of modified files), existingAnalysis (previous results)",
      "outputs": "Updated analysis results focusing only on changes"
    },
    {
      "name": "callLLM",
      "desc": "Internal method that handles communication with AI providers (OpenAI, Claude, Gemini)",
      "inputs": "prompt (question/task), schema (expected response format), options (provider settings)",
      "outputs": "AI-generated response parsed according to schema"
    }
  ],
  "dependencies": [
    "vscode",
    "./fileDocumentation",
    "./analyzer",
    "./analysis/enhancedAnalyzer",
    "./llmSchemas",
    "./fileAccessHelper",
    "./logger",
    "./config/configurationManager",
    "./ai/providers/providerFactory",
    "./ai/llmResponseParser",
    "./ai/llmRateLimiter",
    "./ai/llmRetryHandler",
    "./domain/prompts/promptBuilder",
    "./domain/services/incrementalAnalysisService",
    "./domain/prompts/refactoringPromptBuilder",
    "./analysis/functionAnalyzer"
  ],
  "intent": "This file exists to bridge the gap between static code analysis and intelligent insights by leveraging AI language models. It solves the problem of understanding large codebases by providing human-readable explanations of code purpose, architecture decisions, quality issues, and improvement opportunities. It abstracts away the complexity of working with multiple AI providers and handles concerns like rate limiting, retries, and response parsing, allowing the extension to provide consistent AI-powered features regardless of which provider the user chooses.",
  "rawContent": "```json\n{\n  \"purpose\": \"Provides AI-powered code analysis services by coordinating with OpenAI/Claude to generate intelligent insights about code purpose, architecture, refactoring suggestions, and test plans.\",\n  \"userVisibleActions\": [\n    \"Generates explanations of what the codebase does and why it was built\",\n    \"Provides intelligent refactoring suggestions for improving code quality\",\n    \"Creates test plans showing what should be tested and why\",\n    \"Explains the purpose and architecture of the entire product\",\n    \"Generates comprehensive product documentation from code analysis\",\n    \"Analyzes code complexity and suggests improvements\",\n    \"Explains relationships between files and modules\"\n  ],\n  \"developerVisibleActions\": [\n    \"Call AI service to analyze codebase and get product purpose analysis\",\n    \"Request refactoring suggestions for specific functions or files\",\n    \"Generate unit test plans based on code analysis\",\n    \"Get insights about code quality, architecture patterns, and improvements\",\n    \"Analyze file summaries to understand module structure\",\n    \"Retrieve enhanced product documentation with AI-generated insights\",\n    \"Process incremental analysis updates as code changes\",\n    \"Configure which AI provider to use (OpenAI, Claude, or Gemini)\",\n    \"Set custom API endpoints and model preferences\",\n    \"Handle rate limiting and retry logic for AI requests automatically\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeProductPurpose\",\n      \"desc\": \"Analyzes the entire codebase to determine what the product does and why it exists\",\n      \"inputs\": \"context (file structure, imports, entry points), codeAnalysis (detailed code metrics)\",\n      \"outputs\": \"ProductPurposeAnalysis with product purpose, architecture rationale, key features, and design decisions\"\n    },\n    {\n      \"name\": \"generateProductDocumentation\",\n      \"desc\": \"Creates comprehensive product documentation using AI analysis of code structure and patterns\",\n      \"inputs\": \"fileSummaries (per-file analysis), moduleSummaries (module-level groupings), productPurpose (high-level purpose)\",\n      \"outputs\": \"EnhancedProductDocumentation with overview, architecture, modules, features, and technical details\"\n    },\n    {\n      \"name\": \"generateRefactoringSuggestion\",\n      \"desc\": \"Provides AI-generated suggestions for improving code quality and structure\",\n      \"inputs\": \"fileInfo (file metadata), functionMetadata (function details), codeContent (actual code)\",\n      \"outputs\": \"Refactoring suggestions with severity, description, benefits, and implementation steps\"\n    },\n    {\n      \"name\": \"generateUnitTestPlan\",\n      \"desc\": \"Creates a test plan showing what should be tested and why based on code analysis\",\n      \"inputs\": \"fileInfo, functionMetadata, codeContent, and existing test files\",\n      \"outputs\": \"UnitTestPlan with test strategies, scenarios, coverage recommendations, and priority areas\"\n    },\n    {\n      \"name\": \"getInsights\",\n      \"desc\": \"Generates intelligent insights about code quality, patterns, and improvements\",\n      \"inputs\": \"context (codebase structure), codeAnalysis (metrics), configuration (settings)\",\n      \"outputs\": \"Array of insights categorized by type with descriptions and actionable recommendations\"\n    },\n    {\n      \"name\": \"analyzeIncrementally\",\n      \"desc\": \"Performs incremental analysis on changed files to provide fast, targeted insights\",\n      \"inputs\": \"changedFiles (list of modified files), existingAnalysis (previous results)\",\n      \"outputs\": \"Updated analysis results focusing only on changes\"\n    },\n    {\n      \"name\": \"callLLM\",\n      \"desc\": \"Internal method that handles communication with AI providers (OpenAI, Claude, Gemini)\",\n      \"inputs\": \"prompt (question/task), schema (expected response format), options (provider settings)\",\n      \"outputs\": \"AI-generated response parsed according to schema\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"./fileDocumentation\",\n    \"./analyzer\",\n    \"./analysis/enhancedAnalyzer\",\n    \"./llmSchemas\",\n    \"./fileAccessHelper\",\n    \"./logger\",\n    \"./config/configurationManager\",\n    \"./ai/providers/providerFactory\",\n    \"./ai/llmResponseParser\",\n    \"./ai/llmRateLimiter\",\n    \"./ai/llmRetryHandler\",\n    \"./domain/prompts/promptBuilder\",\n    \"./domain/services/incrementalAnalysisService\",\n    \"./domain/prompts/refactoringPromptBuilder\",\n    \"./analysis/functionAnalyzer\"\n  ],\n  \"intent\": \"This file exists to bridge the gap between static code analysis and intelligent insights by leveraging AI language models. It solves the problem of understanding large codebases by providing human-readable explanations of code purpose, architecture decisions, quality issues, and improvement opportunities. It abstracts away the complexity of working with multiple AI providers and handles concerns like rate limiting, retries, and response parsing, allowing the extension to provide consistent AI-powered features regardless of which provider the user chooses.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T06:37:25.471Z"
  }
}