{
  "file": "src/domain/services/fileWatcherService.ts",
  "role": "Core Logic",
  "purpose": "Provides a unified service for watching file system changes and document saves across the extension to eliminate code duplication.",
  "userVisibleActions": [
    "File changes are automatically detected when files matching watched patterns are created, modified, or deleted",
    "Document saves trigger automatic updates and refreshes in related UI components",
    "Changes to specific file types (like documentation files) are monitored and processed",
    "File system events are consolidated to prevent duplicate processing of the same changes"
  ],
  "developerVisibleActions": [
    "Register file watchers with custom patterns and handlers to respond to file system changes",
    "Subscribe to document save events with custom callback functions",
    "Configure ignore patterns to exclude specific files or directories from being watched",
    "Control which types of events to watch (create, change, delete) per pattern",
    "Manage multiple handlers for the same file pattern with unique identifiers",
    "Dispose of specific watchers or all watchers to clean up resources",
    "Receive standardized FileChangeEvent objects with URI and event type information"
  ],
  "keyFunctions": [
    {
      "name": "watch",
      "desc": "Registers a file system watcher for a specific pattern with options to filter event types and ignore patterns",
      "inputs": "id (string), pattern (string or RelativePattern), handler (FileChangeHandler), options (watchCreate, watchChange, watchDelete, ignorePatterns)",
      "outputs": "Disposable object to unregister the watcher"
    },
    {
      "name": "onDocumentSave",
      "desc": "Registers a handler to be called whenever any document is saved in the workspace",
      "inputs": "handler function that receives a TextDocument",
      "outputs": "Disposable object to unregister the handler"
    },
    {
      "name": "unwatch",
      "desc": "Removes a specific file watcher by its unique identifier",
      "inputs": "id (string)",
      "outputs": "void"
    },
    {
      "name": "dispose",
      "desc": "Cleans up all watchers and handlers, releasing system resources",
      "inputs": "none",
      "outputs": "void"
    },
    {
      "name": "getPatternKey",
      "desc": "Generates a unique key for a file pattern to identify and deduplicate watchers",
      "inputs": "pattern (string or RelativePattern)",
      "outputs": "string key"
    },
    {
      "name": "shouldIgnore",
      "desc": "Determines if a file URI should be ignored based on configured ignore patterns",
      "inputs": "uri (vscode.Uri), ignorePatterns (array of strings)",
      "outputs": "boolean"
    }
  ],
  "dependencies": [
    "vscode",
    "path",
    "fs"
  ],
  "intent": "This file exists to consolidate duplicate file watching logic that was previously scattered across multiple files (fileWatcher.ts, productNavigator.ts, insightsViewer.ts). It solves the problem of maintaining consistent file watching behavior and prevents resource leaks by providing a single, well-managed service that can handle multiple watchers with different patterns, ignore rules, and event handlers while ensuring proper cleanup and disposal.",
  "rawContent": "```json\n{\n  \"purpose\": \"Provides a unified service for watching file system changes and document saves across the extension to eliminate code duplication.\",\n  \"userVisibleActions\": [\n    \"File changes are automatically detected when files matching watched patterns are created, modified, or deleted\",\n    \"Document saves trigger automatic updates and refreshes in related UI components\",\n    \"Changes to specific file types (like documentation files) are monitored and processed\",\n    \"File system events are consolidated to prevent duplicate processing of the same changes\"\n  ],\n  \"developerVisibleActions\": [\n    \"Register file watchers with custom patterns and handlers to respond to file system changes\",\n    \"Subscribe to document save events with custom callback functions\",\n    \"Configure ignore patterns to exclude specific files or directories from being watched\",\n    \"Control which types of events to watch (create, change, delete) per pattern\",\n    \"Manage multiple handlers for the same file pattern with unique identifiers\",\n    \"Dispose of specific watchers or all watchers to clean up resources\",\n    \"Receive standardized FileChangeEvent objects with URI and event type information\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"watch\",\n      \"desc\": \"Registers a file system watcher for a specific pattern with options to filter event types and ignore patterns\",\n      \"inputs\": \"id (string), pattern (string or RelativePattern), handler (FileChangeHandler), options (watchCreate, watchChange, watchDelete, ignorePatterns)\",\n      \"outputs\": \"Disposable object to unregister the watcher\"\n    },\n    {\n      \"name\": \"onDocumentSave\",\n      \"desc\": \"Registers a handler to be called whenever any document is saved in the workspace\",\n      \"inputs\": \"handler function that receives a TextDocument\",\n      \"outputs\": \"Disposable object to unregister the handler\"\n    },\n    {\n      \"name\": \"unwatch\",\n      \"desc\": \"Removes a specific file watcher by its unique identifier\",\n      \"inputs\": \"id (string)\",\n      \"outputs\": \"void\"\n    },\n    {\n      \"name\": \"dispose\",\n      \"desc\": \"Cleans up all watchers and handlers, releasing system resources\",\n      \"inputs\": \"none\",\n      \"outputs\": \"void\"\n    },\n    {\n      \"name\": \"getPatternKey\",\n      \"desc\": \"Generates a unique key for a file pattern to identify and deduplicate watchers\",\n      \"inputs\": \"pattern (string or RelativePattern)\",\n      \"outputs\": \"string key\"\n    },\n    {\n      \"name\": \"shouldIgnore\",\n      \"desc\": \"Determines if a file URI should be ignored based on configured ignore patterns\",\n      \"inputs\": \"uri (vscode.Uri), ignorePatterns (array of strings)\",\n      \"outputs\": \"boolean\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"path\",\n    \"fs\"\n  ],\n  \"intent\": \"This file exists to consolidate duplicate file watching logic that was previously scattered across multiple files (fileWatcher.ts, productNavigator.ts, insightsViewer.ts). It solves the problem of maintaining consistent file watching behavior and prevents resource leaks by providing a single, well-managed service that can handle multiple watchers with different patterns, ignore rules, and event handlers while ensuring proper cleanup and disposal.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T06:31:47.832Z"
  }
}