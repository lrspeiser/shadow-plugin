{
  "module": "src/analysis",
  "moduleType": "other",
  "capabilities": [
    "Deep code analysis through abstract syntax tree (AST) parsing to understand code structure and behavior",
    "Extraction of comprehensive function metadata including signatures, parameters, return types, and responsibilities",
    "Detection and analysis of conditional branches and code paths within functions",
    "Identification of function dependencies, both internal and external to the codebase",
    "Tracking of state mutations and variable modifications throughout function execution",
    "Recognition of behavioral patterns such as pure functions, async operations, and recursive calls",
    "Analysis of function complexity and side effects for refactoring decisions",
    "Generation of detailed function analysis reports for large files requiring refactoring"
  ],
  "summary": "The analysis module provides sophisticated code intelligence capabilities that help developers understand and improve their codebase. It performs deep structural analysis by parsing code into abstract syntax trees, extracting rich metadata about functions, their behaviors, dependencies, and complexity characteristics. Users receive comprehensive insights about how their functions operate, including what branches exist, what state changes occur, and what other parts of the codebase are involved.\n\nThis module is particularly valuable when working with large files that need refactoring. It automatically identifies functions that may benefit from being split or reorganized, providing detailed reports about each function's purpose, dependencies, and relationships within the codebase. The analysis includes behavioral hints that help developers quickly understand whether functions are pure, asynchronous, recursive, or have side effects.\n\nThe insights generated by this module enable data-driven refactoring decisions by highlighting code complexity, identifying tightly coupled components, and revealing functions that modify state or depend on external resources. Developers can use this information to improve code maintainability, reduce complexity, and make informed architectural decisions about their codebase structure.",
  "files": [
    {
      "file": "src/analysis/enhancedAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Performs deep code analysis by parsing abstract syntax trees (AST) to extract detailed function metadata including branches, dependencies, state mutations, and behavioral patterns.",
      "userVisibleActions": [
        "Receives enhanced code intelligence about function behavior and complexity",
        "Gets insights about function dependencies and side effects",
        "Sees analysis of conditional branches and code paths within functions",
        "Receives information about state mutations and variable modifications",
        "Gets behavioral hints about function characteristics (pure, async, recursive, etc.)"
      ],
      "developerVisibleActions": [
        "Analyzes code files to extract detailed function metadata beyond basic information",
        "Parses TypeScript/JavaScript files using AST to understand code structure",
        "Extracts branch analysis showing conditional logic and code paths",
        "Profiles function dependencies and external module usage",
        "Detects state mutations and side effects in functions",
        "Generates behavioral hints indicating function patterns (pure functions, async operations, recursion)",
        "Falls back to regex-based analysis for non-TypeScript/JavaScript languages",
        "Provides test mapping suggestions based on function characteristics",
        "Returns comprehensive metadata including complexity metrics and dependency graphs"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFileMetadata",
          "desc": "Analyzes a code file and extracts enhanced metadata for all functions within it",
          "inputs": "filePath (string), content (string), language (string), functions (FunctionInfo[])",
          "outputs": "Map<string, FunctionMetadata> containing detailed metadata for each function"
        },
        {
          "name": "analyzeTypeScriptFunction",
          "desc": "Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed metadata",
          "inputs": "filePath (string), content (string), func (FunctionInfo), functionContent (string)",
          "outputs": "FunctionMetadata object with branch info, dependencies, mutations, and behavioral hints"
        },
        {
          "name": "analyzeFunctionWithRegex",
          "desc": "Provides fallback regex-based analysis for languages other than TypeScript/JavaScript",
          "inputs": "filePath (string), func (FunctionInfo), functionContent (string), language (string)",
          "outputs": "FunctionMetadata object with basic analysis data"
        },
        {
          "name": "extractFunctionContent",
          "desc": "Extracts the source code content of a function based on line numbers",
          "inputs": "content (string), startLine (number), endLine (number)",
          "outputs": "String containing the function's source code"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer"
      ],
      "intent": "This file exists to provide deep, AST-level code analysis that goes beyond surface-level parsing. It solves the problem of understanding complex code behavior, dependencies, and patterns by analyzing the actual structure of code rather than just reading it as text. This enables intelligent features like dependency tracking, branch analysis, mutation detection, and behavioral pattern recognition for better code understanding and test generation.",
      "rawContent": "```json\n{\n  \"purpose\": \"Performs deep code analysis by parsing abstract syntax trees (AST) to extract detailed function metadata including branches, dependencies, state mutations, and behavioral patterns.\",\n  \"userVisibleActions\": [\n    \"Receives enhanced code intelligence about function behavior and complexity\",\n    \"Gets insights about function dependencies and side effects\",\n    \"Sees analysis of conditional branches and code paths within functions\",\n    \"Receives information about state mutations and variable modifications\",\n    \"Gets behavioral hints about function characteristics (pure, async, recursive, etc.)\"\n  ],\n  \"developerVisibleActions\": [\n    \"Analyzes code files to extract detailed function metadata beyond basic information\",\n    \"Parses TypeScript/JavaScript files using AST to understand code structure\",\n    \"Extracts branch analysis showing conditional logic and code paths\",\n    \"Profiles function dependencies and external module usage\",\n    \"Detects state mutations and side effects in functions\",\n    \"Generates behavioral hints indicating function patterns (pure functions, async operations, recursion)\",\n    \"Falls back to regex-based analysis for non-TypeScript/JavaScript languages\",\n    \"Provides test mapping suggestions based on function characteristics\",\n    \"Returns comprehensive metadata including complexity metrics and dependency graphs\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a code file and extracts enhanced metadata for all functions within it\",\n      \"inputs\": \"filePath (string), content (string), language (string), functions (FunctionInfo[])\",\n      \"outputs\": \"Map<string, FunctionMetadata> containing detailed metadata for each function\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Performs AST-based analysis on TypeScript/JavaScript functions to extract detailed metadata\",\n      \"inputs\": \"filePath (string), content (string), func (FunctionInfo), functionContent (string)\",\n      \"outputs\": \"FunctionMetadata object with branch info, dependencies, mutations, and behavioral hints\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides fallback regex-based analysis for languages other than TypeScript/JavaScript\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), functionContent (string), language (string)\",\n      \"outputs\": \"FunctionMetadata object with basic analysis data\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function based on line numbers\",\n      \"inputs\": \"content (string), startLine (number), endLine (number)\",\n      \"outputs\": \"String containing the function's source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\"\n  ],\n  \"intent\": \"This file exists to provide deep, AST-level code analysis that goes beyond surface-level parsing. It solves the problem of understanding complex code behavior, dependencies, and patterns by analyzing the actual structure of code rather than just reading it as text. This enables intelligent features like dependency tracking, branch analysis, mutation detection, and behavioral pattern recognition for better code understanding and test generation.\"\n}\n```"
    },
    {
      "file": "src/analysis/functionAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, and responsibilities for generating refactoring reports.",
      "userVisibleActions": [
        "Identifies functions in large files that may need refactoring",
        "Generates detailed function analysis reports showing what each function does",
        "Highlights function dependencies and relationships within the codebase",
        "Provides function signature information for understanding code structure"
      ],
      "developerVisibleActions": [
        "Developer triggers function analysis on large files exceeding a threshold (default 500 lines)",
        "Receives structured FunctionAnalysis objects containing function metadata",
        "Gets function signatures, dependencies, dependents, and responsibilities extracted from TypeScript code",
        "Can access analyzed function data to build refactoring prompts and reports",
        "Sees warnings when function analysis fails for specific functions"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFunctions",
          "desc": "Analyzes all functions in files exceeding a size threshold and extracts detailed information",
          "inputs": "codeAnalysis (CodeAnalysis object), largeFileThreshold (optional number, default 500 lines)",
          "outputs": "Promise<FunctionAnalysis[]> - array of detailed function analyses"
        },
        {
          "name": "analyzeFunction",
          "desc": "Performs detailed analysis on a single function to extract its metadata and relationships",
          "inputs": "filePath (string), func (FunctionInfo), codeAnalysis (CodeAnalysis)",
          "outputs": "Promise<FunctionAnalysis | null> - detailed function analysis or null if analysis fails"
        },
        {
          "name": "resolveFilePath",
          "desc": "Resolves the full file path for a given file in the code analysis",
          "inputs": "filePath (string), codeAnalysis (CodeAnalysis)",
          "outputs": "string - resolved full file path"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer",
        "../domain/prompts/refactoringPromptBuilder"
      ],
      "intent": "This file exists to provide deep analysis of functions within large code files to support refactoring efforts. It solves the problem of understanding complex function relationships, dependencies, and responsibilities when developers need to break down or refactor large files. It bridges the gap between basic code analysis and actionable refactoring insights by extracting function-level metadata that can be used to generate intelligent refactoring suggestions.",
      "rawContent": "```json\n{\n  \"purpose\": \"Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, and responsibilities for generating refactoring reports.\",\n  \"userVisibleActions\": [\n    \"Identifies functions in large files that may need refactoring\",\n    \"Generates detailed function analysis reports showing what each function does\",\n    \"Highlights function dependencies and relationships within the codebase\",\n    \"Provides function signature information for understanding code structure\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer triggers function analysis on large files exceeding a threshold (default 500 lines)\",\n    \"Receives structured FunctionAnalysis objects containing function metadata\",\n    \"Gets function signatures, dependencies, dependents, and responsibilities extracted from TypeScript code\",\n    \"Can access analyzed function data to build refactoring prompts and reports\",\n    \"Sees warnings when function analysis fails for specific functions\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Analyzes all functions in files exceeding a size threshold and extracts detailed information\",\n      \"inputs\": \"codeAnalysis (CodeAnalysis object), largeFileThreshold (optional number, default 500 lines)\",\n      \"outputs\": \"Promise<FunctionAnalysis[]> - array of detailed function analyses\"\n    },\n    {\n      \"name\": \"analyzeFunction\",\n      \"desc\": \"Performs detailed analysis on a single function to extract its metadata and relationships\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), codeAnalysis (CodeAnalysis)\",\n      \"outputs\": \"Promise<FunctionAnalysis | null> - detailed function analysis or null if analysis fails\"\n    },\n    {\n      \"name\": \"resolveFilePath\",\n      \"desc\": \"Resolves the full file path for a given file in the code analysis\",\n      \"inputs\": \"filePath (string), codeAnalysis (CodeAnalysis)\",\n      \"outputs\": \"string - resolved full file path\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\",\n    \"../domain/prompts/refactoringPromptBuilder\"\n  ],\n  \"intent\": \"This file exists to provide deep analysis of functions within large code files to support refactoring efforts. It solves the problem of understanding complex function relationships, dependencies, and responsibilities when developers need to break down or refactor large files. It bridges the gap between basic code analysis and actionable refactoring insights by extracting function-level metadata that can be used to generate intelligent refactoring suggestions.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T01:44:35.741Z"
  }
}