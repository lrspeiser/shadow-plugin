{
  "file": "src/llmService.ts",
  "role": "Core Logic",
  "purpose": "Orchestrates AI-powered code analysis by calling OpenAI/Claude APIs to generate intelligent insights about codebases, including product purpose, architecture analysis, and refactoring suggestions.",
  "userVisibleActions": [
    "Generates comprehensive product documentation explaining what the codebase does and why",
    "Provides intelligent insights about code architecture and design patterns",
    "Analyzes product purpose and core value propositions from code structure",
    "Generates refactoring suggestions for improving code quality",
    "Creates unit test plans for functions and modules",
    "Detects entry points and orphaned files in the codebase",
    "Groups files by modules and analyzes module relationships"
  ],
  "developerVisibleActions": [
    "Calls LLM APIs (OpenAI/Claude) with structured prompts to analyze code",
    "Processes file summaries and module information into AI prompts",
    "Handles rate limiting and retries for API calls automatically",
    "Parses and validates LLM responses against defined schemas",
    "Provides incremental analysis for large codebases to avoid token limits",
    "Manages different LLM providers based on configuration settings",
    "Tracks analysis progress and budget constraints during execution",
    "Exposes methods for product purpose analysis, refactoring analysis, and documentation generation"
  ],
  "keyFunctions": [
    {
      "name": "analyzeProductPurpose",
      "desc": "Analyzes the entire codebase to determine what the product does and its architecture rationale",
      "inputs": "CodeAnalysis object containing file and function metadata",
      "outputs": "ProductPurposeAnalysis with product purpose, architecture rationale, and key insights"
    },
    {
      "name": "generateEnhancedProductDocumentation",
      "desc": "Creates comprehensive product documentation by analyzing file roles, modules, and relationships",
      "inputs": "Array of file paths and workspace root",
      "outputs": "EnhancedProductDocumentation with purpose, architecture, modules, and design patterns"
    },
    {
      "name": "generateLLMInsights",
      "desc": "Generates intelligent insights about code quality, patterns, and potential improvements",
      "inputs": "CodeAnalysis object and analysis context",
      "outputs": "Structured insights including quality metrics, patterns, and recommendations"
    },
    {
      "name": "generateRefactoringSuggestions",
      "desc": "Analyzes a function and provides AI-powered refactoring suggestions",
      "inputs": "Function metadata, file content, and surrounding context",
      "outputs": "Refactoring suggestions with rationale and proposed improvements"
    },
    {
      "name": "generateUnitTestPlan",
      "desc": "Creates a comprehensive unit test plan for a given function",
      "inputs": "Function analysis including code, dependencies, and context",
      "outputs": "Test plan with test cases, edge cases, and mocking strategies"
    },
    {
      "name": "callLLMWithRetry",
      "desc": "Makes API calls to LLM providers with automatic retry logic and rate limiting",
      "inputs": "Prompt text, schema for validation, and optional model preferences",
      "outputs": "Parsed and validated LLM response conforming to the specified schema"
    }
  ],
  "dependencies": [
    "vscode",
    "./fileDocumentation",
    "./analyzer",
    "./analysis/enhancedAnalyzer",
    "./llmSchemas",
    "./fileAccessHelper",
    "./logger",
    "./config/configurationManager",
    "./ai/providers/providerFactory",
    "./ai/llmResponseParser",
    "./ai/llmRateLimiter",
    "./ai/llmRetryHandler",
    "./domain/prompts/promptBuilder",
    "./domain/services/incrementalAnalysisService",
    "./domain/prompts/refactoringPromptBuilder",
    "./analysis/functionAnalyzer"
  ],
  "intent": "This file exists to bridge the gap between raw code analysis and human-understandable insights by leveraging LLM capabilities. It solves the problem of understanding large codebases by automatically generating documentation, detecting architectural patterns, and providing intelligent suggestions for improvements. It abstracts away the complexity of working with different AI providers and handles the challenges of token limits, rate limiting, and response parsing.",
  "rawContent": "```json\n{\n  \"purpose\": \"Orchestrates AI-powered code analysis by calling OpenAI/Claude APIs to generate intelligent insights about codebases, including product purpose, architecture analysis, and refactoring suggestions.\",\n  \"userVisibleActions\": [\n    \"Generates comprehensive product documentation explaining what the codebase does and why\",\n    \"Provides intelligent insights about code architecture and design patterns\",\n    \"Analyzes product purpose and core value propositions from code structure\",\n    \"Generates refactoring suggestions for improving code quality\",\n    \"Creates unit test plans for functions and modules\",\n    \"Detects entry points and orphaned files in the codebase\",\n    \"Groups files by modules and analyzes module relationships\"\n  ],\n  \"developerVisibleActions\": [\n    \"Calls LLM APIs (OpenAI/Claude) with structured prompts to analyze code\",\n    \"Processes file summaries and module information into AI prompts\",\n    \"Handles rate limiting and retries for API calls automatically\",\n    \"Parses and validates LLM responses against defined schemas\",\n    \"Provides incremental analysis for large codebases to avoid token limits\",\n    \"Manages different LLM providers based on configuration settings\",\n    \"Tracks analysis progress and budget constraints during execution\",\n    \"Exposes methods for product purpose analysis, refactoring analysis, and documentation generation\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeProductPurpose\",\n      \"desc\": \"Analyzes the entire codebase to determine what the product does and its architecture rationale\",\n      \"inputs\": \"CodeAnalysis object containing file and function metadata\",\n      \"outputs\": \"ProductPurposeAnalysis with product purpose, architecture rationale, and key insights\"\n    },\n    {\n      \"name\": \"generateEnhancedProductDocumentation\",\n      \"desc\": \"Creates comprehensive product documentation by analyzing file roles, modules, and relationships\",\n      \"inputs\": \"Array of file paths and workspace root\",\n      \"outputs\": \"EnhancedProductDocumentation with purpose, architecture, modules, and design patterns\"\n    },\n    {\n      \"name\": \"generateLLMInsights\",\n      \"desc\": \"Generates intelligent insights about code quality, patterns, and potential improvements\",\n      \"inputs\": \"CodeAnalysis object and analysis context\",\n      \"outputs\": \"Structured insights including quality metrics, patterns, and recommendations\"\n    },\n    {\n      \"name\": \"generateRefactoringSuggestions\",\n      \"desc\": \"Analyzes a function and provides AI-powered refactoring suggestions\",\n      \"inputs\": \"Function metadata, file content, and surrounding context\",\n      \"outputs\": \"Refactoring suggestions with rationale and proposed improvements\"\n    },\n    {\n      \"name\": \"generateUnitTestPlan\",\n      \"desc\": \"Creates a comprehensive unit test plan for a given function\",\n      \"inputs\": \"Function analysis including code, dependencies, and context\",\n      \"outputs\": \"Test plan with test cases, edge cases, and mocking strategies\"\n    },\n    {\n      \"name\": \"callLLMWithRetry\",\n      \"desc\": \"Makes API calls to LLM providers with automatic retry logic and rate limiting\",\n      \"inputs\": \"Prompt text, schema for validation, and optional model preferences\",\n      \"outputs\": \"Parsed and validated LLM response conforming to the specified schema\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"./fileDocumentation\",\n    \"./analyzer\",\n    \"./analysis/enhancedAnalyzer\",\n    \"./llmSchemas\",\n    \"./fileAccessHelper\",\n    \"./logger\",\n    \"./config/configurationManager\",\n    \"./ai/providers/providerFactory\",\n    \"./ai/llmResponseParser\",\n    \"./ai/llmRateLimiter\",\n    \"./ai/llmRetryHandler\",\n    \"./domain/prompts/promptBuilder\",\n    \"./domain/services/incrementalAnalysisService\",\n    \"./domain/prompts/refactoringPromptBuilder\",\n    \"./analysis/functionAnalyzer\"\n  ],\n  \"intent\": \"This file exists to bridge the gap between raw code analysis and human-understandable insights by leveraging LLM capabilities. It solves the problem of understanding large codebases by automatically generating documentation, detecting architectural patterns, and providing intelligent suggestions for improvements. It abstracts away the complexity of working with different AI providers and handles the challenges of token limits, rate limiting, and response parsing.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T01:43:45.216Z"
  }
}