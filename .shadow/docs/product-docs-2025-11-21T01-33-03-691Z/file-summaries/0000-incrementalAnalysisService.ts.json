{
  "file": "src/domain/services/incrementalAnalysisService.ts",
  "role": "Core Logic",
  "purpose": "Manages iterative analysis sessions where an LLM can request additional files or search results across multiple rounds of conversation.",
  "userVisibleActions": [
    "LLM analysis continues across multiple iterations when it needs more information",
    "Analysis automatically fetches requested files and grep search results",
    "Analysis stops after reaching maximum iterations or when LLM signals completion",
    "Up to 5 file/grep requests are processed per iteration to prevent overload"
  ],
  "developerVisibleActions": [
    "Developer initiates iterative analysis with custom callbacks for iteration start and completion",
    "Service processes LLM requests for file reads and grep searches automatically",
    "Developer receives structured iteration results including the final result, iteration count, and all requests made",
    "Service maintains conversation history by appending assistant and user messages",
    "Developer can configure maximum iterations to control analysis depth"
  ],
  "keyFunctions": [
    {
      "name": "processRequests",
      "desc": "Processes up to 5 file read and grep search requests from the LLM, returning formatted results",
      "inputs": "requests (array of LLMRequest), currentResult (any analysis result), messages (conversation history)",
      "outputs": "ProcessRequestsResult with additionalInfo string and updated messages array"
    },
    {
      "name": "async *iterateAnalysis",
      "desc": "Iterates through analysis rounds, yielding results after each iteration until completion or max iterations reached",
      "inputs": "currentResult (initial analysis), iteration (starting iteration number), maxIterations (limit), callbacks (optional iteration hooks)",
      "outputs": "AsyncGenerator yielding IterationResult objects with result, iteration count, requests, and continuation flag"
    }
  ],
  "dependencies": [
    "FileAccessHelper",
    "LLMRequest types from fileAccessHelper module"
  ],
  "intent": "Eliminates code duplication and improves testability by extracting iterative LLM analysis logic into a dedicated service that handles multi-round conversations where the LLM can request additional context through file reads and grep searches.",
  "rawContent": "```json\n{\n  \"purpose\": \"Manages iterative analysis sessions where an LLM can request additional files or search results across multiple rounds of conversation.\",\n  \"userVisibleActions\": [\n    \"LLM analysis continues across multiple iterations when it needs more information\",\n    \"Analysis automatically fetches requested files and grep search results\",\n    \"Analysis stops after reaching maximum iterations or when LLM signals completion\",\n    \"Up to 5 file/grep requests are processed per iteration to prevent overload\"\n  ],\n  \"developerVisibleActions\": [\n    \"Developer initiates iterative analysis with custom callbacks for iteration start and completion\",\n    \"Service processes LLM requests for file reads and grep searches automatically\",\n    \"Developer receives structured iteration results including the final result, iteration count, and all requests made\",\n    \"Service maintains conversation history by appending assistant and user messages\",\n    \"Developer can configure maximum iterations to control analysis depth\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"processRequests\",\n      \"desc\": \"Processes up to 5 file read and grep search requests from the LLM, returning formatted results\",\n      \"inputs\": \"requests (array of LLMRequest), currentResult (any analysis result), messages (conversation history)\",\n      \"outputs\": \"ProcessRequestsResult with additionalInfo string and updated messages array\"\n    },\n    {\n      \"name\": \"async *iterateAnalysis\",\n      \"desc\": \"Iterates through analysis rounds, yielding results after each iteration until completion or max iterations reached\",\n      \"inputs\": \"currentResult (initial analysis), iteration (starting iteration number), maxIterations (limit), callbacks (optional iteration hooks)\",\n      \"outputs\": \"AsyncGenerator yielding IterationResult objects with result, iteration count, requests, and continuation flag\"\n    }\n  ],\n  \"dependencies\": [\n    \"FileAccessHelper\",\n    \"LLMRequest types from fileAccessHelper module\"\n  ],\n  \"intent\": \"Eliminates code duplication and improves testability by extracting iterative LLM analysis logic into a dedicated service that handles multi-round conversations where the LLM can request additional context through file reads and grep searches.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T01:38:28.405Z"
  }
}