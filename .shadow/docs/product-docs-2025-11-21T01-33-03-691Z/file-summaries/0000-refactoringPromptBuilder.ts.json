{
  "file": "src/domain/prompts/refactoringPromptBuilder.ts",
  "role": "Core Logic",
  "purpose": "Builds detailed refactoring prompts with extraction plans and migration steps for LLM-based code refactoring analysis",
  "userVisibleActions": [
    "Receives detailed refactoring recommendations with specific code extraction suggestions",
    "Gets step-by-step migration instructions for moving code between files",
    "Views before/after code examples showing proposed refactoring changes",
    "Sees function-level analysis explaining what each function does and its dependencies"
  ],
  "developerVisibleActions": [
    "Generates comprehensive refactoring prompts that include code analysis context and product documentation",
    "Creates extraction plans showing which functions should be moved from source to target files",
    "Produces function analysis reports detailing responsibilities, dependencies, and call relationships",
    "Builds structured prompts with specific requirements for code extraction and migration",
    "Combines architecture insights with code analysis to guide refactoring decisions",
    "Generates migration steps and code examples to illustrate refactoring approach"
  ],
  "keyFunctions": [
    {
      "name": "buildDetailedRefactoringPrompt",
      "desc": "Creates a comprehensive refactoring prompt combining code analysis, product docs, architecture insights, and function analysis",
      "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array",
      "outputs": "Formatted string prompt for LLM refactoring analysis"
    },
    {
      "name": "buildBasePrompt",
      "desc": "Constructs the foundational prompt text with context and code analysis information",
      "inputs": "AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights",
      "outputs": "Base prompt string"
    },
    {
      "name": "buildFunctionAnalysisSection",
      "desc": "Generates a detailed section analyzing functions including their dependencies and responsibilities",
      "inputs": "Array of FunctionAnalysis objects",
      "outputs": "Formatted function analysis text"
    },
    {
      "name": "buildExtractionRequirementsSection",
      "desc": "Creates detailed requirements for code extraction including migration steps and examples",
      "inputs": "None",
      "outputs": "Extraction requirements text"
    }
  ],
  "dependencies": [
    "../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)",
    "../../llmService (AnalysisContext, LLMInsights)",
    "../../fileDocumentation (EnhancedProductDocumentation)"
  ],
  "intent": "This file exists to generate structured, prescriptive refactoring instructions for LLMs by combining code analysis data, function relationships, and documentation context into comprehensive prompts that guide the AI to produce actionable refactoring recommendations with specific extraction plans and migration steps",
  "rawContent": "```json\n{\n  \"purpose\": \"Builds detailed refactoring prompts with extraction plans and migration steps for LLM-based code refactoring analysis\",\n  \"userVisibleActions\": [\n    \"Receives detailed refactoring recommendations with specific code extraction suggestions\",\n    \"Gets step-by-step migration instructions for moving code between files\",\n    \"Views before/after code examples showing proposed refactoring changes\",\n    \"Sees function-level analysis explaining what each function does and its dependencies\"\n  ],\n  \"developerVisibleActions\": [\n    \"Generates comprehensive refactoring prompts that include code analysis context and product documentation\",\n    \"Creates extraction plans showing which functions should be moved from source to target files\",\n    \"Produces function analysis reports detailing responsibilities, dependencies, and call relationships\",\n    \"Builds structured prompts with specific requirements for code extraction and migration\",\n    \"Combines architecture insights with code analysis to guide refactoring decisions\",\n    \"Generates migration steps and code examples to illustrate refactoring approach\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildDetailedRefactoringPrompt\",\n      \"desc\": \"Creates a comprehensive refactoring prompt combining code analysis, product docs, architecture insights, and function analysis\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights, optional FunctionAnalysis array\",\n      \"outputs\": \"Formatted string prompt for LLM refactoring analysis\"\n    },\n    {\n      \"name\": \"buildBasePrompt\",\n      \"desc\": \"Constructs the foundational prompt text with context and code analysis information\",\n      \"inputs\": \"AnalysisContext, CodeAnalysis, optional EnhancedProductDocumentation, optional LLMInsights\",\n      \"outputs\": \"Base prompt string\"\n    },\n    {\n      \"name\": \"buildFunctionAnalysisSection\",\n      \"desc\": \"Generates a detailed section analyzing functions including their dependencies and responsibilities\",\n      \"inputs\": \"Array of FunctionAnalysis objects\",\n      \"outputs\": \"Formatted function analysis text\"\n    },\n    {\n      \"name\": \"buildExtractionRequirementsSection\",\n      \"desc\": \"Creates detailed requirements for code extraction including migration steps and examples\",\n      \"inputs\": \"None\",\n      \"outputs\": \"Extraction requirements text\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../analyzer (CodeAnalysis, FileInfo, FunctionMetadata)\",\n    \"../../llmService (AnalysisContext, LLMInsights)\",\n    \"../../fileDocumentation (EnhancedProductDocumentation)\"\n  ],\n  \"intent\": \"This file exists to generate structured, prescriptive refactoring instructions for LLMs by combining code analysis data, function relationships, and documentation context into comprehensive prompts that guide the AI to produce actionable refactoring recommendations with specific extraction plans and migration steps\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T01:37:49.127Z"
  }
}