{
  "file": "src/domain/services/fileWatcherService.ts",
  "role": "Core Logic",
  "purpose": "Provides a centralized service for monitoring file system changes and document saves across the extension, eliminating duplication of file watching logic.",
  "userVisibleActions": [
    "Files are automatically monitored for changes when opened or created",
    "Updates occur automatically when files are saved, modified, or deleted",
    "File system changes trigger automatic refreshes of views and data",
    "Changes to specific file patterns (like product files or insights) are detected in real-time"
  ],
  "developerVisibleActions": [
    "Register file watchers for specific patterns (e.g., '**/*.md', '**/*.json')",
    "Subscribe to file creation, modification, and deletion events",
    "Register handlers for document save events",
    "Ignore specific file patterns when watching (e.g., '.git/**', 'node_modules/**')",
    "Clean up watchers automatically when handlers are disposed",
    "Receive structured FileChangeEvent objects with URI and event type",
    "Watch multiple patterns with separate handlers for each",
    "Debounce file change events to prevent excessive handler calls"
  ],
  "keyFunctions": [
    {
      "name": "watch",
      "desc": "Registers a handler to be called when files matching a pattern are created, changed, or deleted",
      "inputs": "id (string), pattern (glob or RelativePattern), handler (callback function), options (ignore patterns, event types to watch)",
      "outputs": "Disposable object to stop watching"
    },
    {
      "name": "onDidSaveTextDocument",
      "desc": "Registers a handler to be called when any text document is saved",
      "inputs": "handler (callback function receiving TextDocument)",
      "outputs": "Disposable object to unregister the handler"
    },
    {
      "name": "unwatch",
      "desc": "Removes a specific handler from watching file changes",
      "inputs": "id (string), pattern (glob or RelativePattern)",
      "outputs": "void"
    },
    {
      "name": "dispose",
      "desc": "Cleans up all watchers and handlers when the service is no longer needed",
      "inputs": "none",
      "outputs": "void"
    },
    {
      "name": "getPatternKey",
      "desc": "Generates a unique key for a file pattern to avoid duplicate watchers",
      "inputs": "pattern (string or RelativePattern)",
      "outputs": "string key"
    }
  ],
  "dependencies": [
    "vscode",
    "path",
    "fs"
  ],
  "intent": "This file exists to consolidate file watching functionality that was previously duplicated across multiple components (fileWatcher.ts, productNavigator.ts, insightsViewer.ts). It solves the problem of maintaining consistent file monitoring behavior and prevents resource waste from multiple watchers monitoring the same files. It provides a single, reliable service that other components can use to react to file system changes without implementing their own watching logic.",
  "rawContent": "```json\n{\n  \"purpose\": \"Provides a centralized service for monitoring file system changes and document saves across the extension, eliminating duplication of file watching logic.\",\n  \"userVisibleActions\": [\n    \"Files are automatically monitored for changes when opened or created\",\n    \"Updates occur automatically when files are saved, modified, or deleted\",\n    \"File system changes trigger automatic refreshes of views and data\",\n    \"Changes to specific file patterns (like product files or insights) are detected in real-time\"\n  ],\n  \"developerVisibleActions\": [\n    \"Register file watchers for specific patterns (e.g., '**/*.md', '**/*.json')\",\n    \"Subscribe to file creation, modification, and deletion events\",\n    \"Register handlers for document save events\",\n    \"Ignore specific file patterns when watching (e.g., '.git/**', 'node_modules/**')\",\n    \"Clean up watchers automatically when handlers are disposed\",\n    \"Receive structured FileChangeEvent objects with URI and event type\",\n    \"Watch multiple patterns with separate handlers for each\",\n    \"Debounce file change events to prevent excessive handler calls\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"watch\",\n      \"desc\": \"Registers a handler to be called when files matching a pattern are created, changed, or deleted\",\n      \"inputs\": \"id (string), pattern (glob or RelativePattern), handler (callback function), options (ignore patterns, event types to watch)\",\n      \"outputs\": \"Disposable object to stop watching\"\n    },\n    {\n      \"name\": \"onDidSaveTextDocument\",\n      \"desc\": \"Registers a handler to be called when any text document is saved\",\n      \"inputs\": \"handler (callback function receiving TextDocument)\",\n      \"outputs\": \"Disposable object to unregister the handler\"\n    },\n    {\n      \"name\": \"unwatch\",\n      \"desc\": \"Removes a specific handler from watching file changes\",\n      \"inputs\": \"id (string), pattern (glob or RelativePattern)\",\n      \"outputs\": \"void\"\n    },\n    {\n      \"name\": \"dispose\",\n      \"desc\": \"Cleans up all watchers and handlers when the service is no longer needed\",\n      \"inputs\": \"none\",\n      \"outputs\": \"void\"\n    },\n    {\n      \"name\": \"getPatternKey\",\n      \"desc\": \"Generates a unique key for a file pattern to avoid duplicate watchers\",\n      \"inputs\": \"pattern (string or RelativePattern)\",\n      \"outputs\": \"string key\"\n    }\n  ],\n  \"dependencies\": [\n    \"vscode\",\n    \"path\",\n    \"fs\"\n  ],\n  \"intent\": \"This file exists to consolidate file watching functionality that was previously duplicated across multiple components (fileWatcher.ts, productNavigator.ts, insightsViewer.ts). It solves the problem of maintaining consistent file monitoring behavior and prevents resource waste from multiple watchers monitoring the same files. It provides a single, reliable service that other components can use to react to file system changes without implementing their own watching logic.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T17:40:48.672Z"
  }
}