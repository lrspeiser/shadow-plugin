{
  "file": "src/domain/services/testing/llmFunctionExtractionService.ts",
  "role": "Core Logic",
  "purpose": "Extracts testable functions from workspace code files using an LLM to identify function metadata, complexity, and testability characteristics.",
  "userVisibleActions": [
    "Automated analysis of code files to identify functions that can be tested",
    "Assessment of function testability (low/medium/high) with explanations",
    "Detection of functions that require mocking due to external dependencies",
    "Complexity rating (low/medium/high) assigned to each discovered function",
    "Progress feedback showing batch processing status during analysis"
  ],
  "developerVisibleActions": [
    "Call extractFunctionsFromWorkspace() to analyze multiple code files in batches",
    "Call extractFunctionsFromSingleFile() to analyze a single file in isolation",
    "Receive structured function metadata including name, location, parameters, return types, and dependencies",
    "Configure batch size (maxFilesPerBatch) to control token usage and API limits",
    "Get detailed extraction results with total function count and files analyzed",
    "Access logging output showing processing progress and any extraction errors"
  ],
  "keyFunctions": [
    {
      "name": "extractFunctionsFromWorkspace",
      "desc": "Analyzes all code files in workspace to extract function metadata using LLM in configurable batches",
      "inputs": "workspaceRoot path, array of code file paths, llmService instance, optional maxFilesPerBatch",
      "outputs": "Array of ExtractedFunction objects with metadata about each discovered function"
    },
    {
      "name": "extractFunctionsFromSingleFile",
      "desc": "Analyzes a single code file to extract all functions and their metadata using LLM",
      "inputs": "File path, file content, llmService instance",
      "outputs": "Array of ExtractedFunction objects from the analyzed file"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "CodeAnalysis",
    "buildFunctionExtractionPrompt",
    "buildSingleFileExtractionPrompt",
    "SWLogger"
  ],
  "intent": "Replaces regex-based function extraction with LLM-powered analysis to accurately identify testable functions while avoiding false positives from control flow keywords (if, while, for, etc.). Enables intelligent test generation by providing rich metadata about each function including complexity, dependencies, API calls, and testability assessment.",
  "rawContent": "```json\n{\n  \"purpose\": \"Extracts testable functions from workspace code files using an LLM to identify function metadata, complexity, and testability characteristics.\",\n  \"userVisibleActions\": [\n    \"Automated analysis of code files to identify functions that can be tested\",\n    \"Assessment of function testability (low/medium/high) with explanations\",\n    \"Detection of functions that require mocking due to external dependencies\",\n    \"Complexity rating (low/medium/high) assigned to each discovered function\",\n    \"Progress feedback showing batch processing status during analysis\"\n  ],\n  \"developerVisibleActions\": [\n    \"Call extractFunctionsFromWorkspace() to analyze multiple code files in batches\",\n    \"Call extractFunctionsFromSingleFile() to analyze a single file in isolation\",\n    \"Receive structured function metadata including name, location, parameters, return types, and dependencies\",\n    \"Configure batch size (maxFilesPerBatch) to control token usage and API limits\",\n    \"Get detailed extraction results with total function count and files analyzed\",\n    \"Access logging output showing processing progress and any extraction errors\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"extractFunctionsFromWorkspace\",\n      \"desc\": \"Analyzes all code files in workspace to extract function metadata using LLM in configurable batches\",\n      \"inputs\": \"workspaceRoot path, array of code file paths, llmService instance, optional maxFilesPerBatch\",\n      \"outputs\": \"Array of ExtractedFunction objects with metadata about each discovered function\"\n    },\n    {\n      \"name\": \"extractFunctionsFromSingleFile\",\n      \"desc\": \"Analyzes a single code file to extract all functions and their metadata using LLM\",\n      \"inputs\": \"File path, file content, llmService instance\",\n      \"outputs\": \"Array of ExtractedFunction objects from the analyzed file\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"CodeAnalysis\",\n    \"buildFunctionExtractionPrompt\",\n    \"buildSingleFileExtractionPrompt\",\n    \"SWLogger\"\n  ],\n  \"intent\": \"Replaces regex-based function extraction with LLM-powered analysis to accurately identify testable functions while avoiding false positives from control flow keywords (if, while, for, etc.). Enables intelligent test generation by providing rich metadata about each function including complexity, dependencies, API calls, and testability assessment.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T17:41:37.361Z"
  }
}