{
  "file": "src/domain/services/testing/llmTestPlanningService.ts",
  "role": "Core Logic",
  "purpose": "Creates prioritized test plans by analyzing code functions and determining which ones need testing using LLM-based analysis.",
  "userVisibleActions": [
    "Receives an AI-generated test plan that prioritizes which functions in the codebase need testing",
    "Gets test plans based on intelligent analysis of function complexity and importance",
    "Benefits from improved test coverage recommendations that avoid false positives from control flow keywords"
  ],
  "developerVisibleActions": [
    "Calls analyzeFunctions to extract testable functions from workspace code files using LLM analysis",
    "Receives structured test plan data with function metadata (name, file, lines, complexity, parameters, return type)",
    "Uses LLM service to intelligently identify actual functions versus control flow statements",
    "Accesses legacy regex-based function extraction as fallback (deprecated)",
    "Gets functions converted to test plan format ready for prioritization"
  ],
  "keyFunctions": [
    {
      "name": "analyzeFunctions",
      "desc": "Extracts and analyzes testable functions from workspace code files using LLM instead of regex to avoid capturing control flow keywords",
      "inputs": "workspaceRoot (string), codeFiles (string array), llmService (LLM service instance)",
      "outputs": "Array of function metadata objects in test plan format"
    },
    {
      "name": "analyzeFunctionsLegacy",
      "desc": "Deprecated regex-based function extraction that incorrectly captured control flow keywords like for, if, switch",
      "inputs": "codeAnalysis (code analysis object)",
      "outputs": "Array of function metadata objects"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "testPlanTypes",
    "testPrompts",
    "CodeAnalysis",
    "SWLogger",
    "LLMFunctionExtractionService"
  ],
  "intent": "This file solves the problem of accurately identifying which functions in a codebase should be tested by using LLM analysis to distinguish real functions from control flow statements (for, if, switch), replacing unreliable regex-based extraction that created false positives. It enables intelligent test planning by providing structured function metadata that can be prioritized for test generation.",
  "rawContent": "```json\n{\n  \"purpose\": \"Creates prioritized test plans by analyzing code functions and determining which ones need testing using LLM-based analysis.\",\n  \"userVisibleActions\": [\n    \"Receives an AI-generated test plan that prioritizes which functions in the codebase need testing\",\n    \"Gets test plans based on intelligent analysis of function complexity and importance\",\n    \"Benefits from improved test coverage recommendations that avoid false positives from control flow keywords\"\n  ],\n  \"developerVisibleActions\": [\n    \"Calls analyzeFunctions to extract testable functions from workspace code files using LLM analysis\",\n    \"Receives structured test plan data with function metadata (name, file, lines, complexity, parameters, return type)\",\n    \"Uses LLM service to intelligently identify actual functions versus control flow statements\",\n    \"Accesses legacy regex-based function extraction as fallback (deprecated)\",\n    \"Gets functions converted to test plan format ready for prioritization\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Extracts and analyzes testable functions from workspace code files using LLM instead of regex to avoid capturing control flow keywords\",\n      \"inputs\": \"workspaceRoot (string), codeFiles (string array), llmService (LLM service instance)\",\n      \"outputs\": \"Array of function metadata objects in test plan format\"\n    },\n    {\n      \"name\": \"analyzeFunctionsLegacy\",\n      \"desc\": \"Deprecated regex-based function extraction that incorrectly captured control flow keywords like for, if, switch\",\n      \"inputs\": \"codeAnalysis (code analysis object)\",\n      \"outputs\": \"Array of function metadata objects\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"testPlanTypes\",\n    \"testPrompts\",\n    \"CodeAnalysis\",\n    \"SWLogger\",\n    \"LLMFunctionExtractionService\"\n  ],\n  \"intent\": \"This file solves the problem of accurately identifying which functions in a codebase should be tested by using LLM analysis to distinguish real functions from control flow statements (for, if, switch), replacing unreliable regex-based extraction that created false positives. It enables intelligent test planning by providing structured function metadata that can be prioritized for test generation.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T17:42:13.184Z"
  }
}