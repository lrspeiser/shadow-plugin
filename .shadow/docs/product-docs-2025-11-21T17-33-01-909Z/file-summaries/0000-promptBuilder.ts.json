{
  "file": "src/domain/prompts/promptBuilder.ts",
  "role": "Core Logic",
  "purpose": "Constructs structured prompts for AI/LLM analysis tasks across the entire codebase, ensuring consistent and effective communication with language models.",
  "userVisibleActions": [
    "Analyzes project architecture and generates comprehensive documentation",
    "Creates product-level documentation from codebase analysis",
    "Generates test plans for code files with coverage recommendations",
    "Produces test code based on defined test scenarios",
    "Documents individual files with user-facing behavior descriptions",
    "Summarizes code modules and their relationships"
  ],
  "developerVisibleActions": [
    "Provides centralized prompt generation for all LLM analysis operations",
    "Builds architecture analysis prompts with codebase context and product documentation",
    "Constructs product documentation prompts from analysis context",
    "Creates file-specific analysis prompts with role-based categorization",
    "Generates module rollup prompts for aggregating file summaries",
    "Builds test planning prompts with existing test awareness and function metadata",
    "Produces test code generation prompts with source code and test framework details",
    "Eliminates prompt duplication across different analysis services",
    "Supports multiple programming languages and test frameworks"
  ],
  "keyFunctions": [
    {
      "name": "buildArchitecturePrompt",
      "desc": "Constructs a prompt for analyzing overall system architecture",
      "inputs": "context (AnalysisContext), optional codeAnalysis, productDocs, productPurposeAnalysis, fileAccessHelper",
      "outputs": "string prompt for LLM consumption"
    },
    {
      "name": "buildProductDocsPrompt",
      "desc": "Creates a prompt for generating product-level documentation",
      "inputs": "context (AnalysisContext)",
      "outputs": "string prompt for documentation generation"
    },
    {
      "name": "buildProductPurposePrompt",
      "desc": "Generates a prompt for understanding the product's core purpose",
      "inputs": "productDocs (EnhancedProductDocumentation), context (AnalysisContext)",
      "outputs": "string prompt for purpose analysis"
    },
    {
      "name": "buildFileAnalysisPrompt",
      "desc": "Creates a prompt for analyzing individual code files",
      "inputs": "file (FileInfo), content (string), role (string)",
      "outputs": "string prompt for file analysis"
    },
    {
      "name": "buildModuleRollupPrompt",
      "desc": "Constructs a prompt for aggregating multiple file summaries into module documentation",
      "inputs": "modulePath (string), moduleType (string), files (FileSummary[])",
      "outputs": "string prompt for module summary"
    },
    {
      "name": "buildProductLevelPrompt",
      "desc": "Builds a comprehensive prompt for product-wide documentation",
      "inputs": "fileSummaries, moduleSummaries, analysis (CodeAnalysis), fileAccessHelper",
      "outputs": "string prompt for product documentation"
    },
    {
      "name": "buildPerFileTestPlanPrompt",
      "desc": "Creates a prompt for generating test plans for specific files",
      "inputs": "filePath, fileContent, functionMetadata, existingTests, language, testFramework, optional projectSummary",
      "outputs": "string prompt for test planning"
    },
    {
      "name": "buildTestCodeGenerationPrompt",
      "desc": "Generates a prompt for creating actual test code from test plans",
      "inputs": "testPlanItem, sourceCode, functionCode, language, testFramework",
      "outputs": "string prompt for test code generation"
    }
  ],
  "dependencies": [
    "../../llmService",
    "../../analyzer",
    "../../fileDocumentation",
    "../../fileAccessHelper"
  ],
  "intent": "This file exists to eliminate duplication and ensure consistency across all AI/LLM interactions by centralizing prompt construction logic. It solves the problem of scattered, inconsistent prompt generation throughout the codebase, making it easier to maintain and improve how the system communicates with language models for analysis, documentation, and test generation tasks.",
  "rawContent": "```json\n{\n  \"purpose\": \"Constructs structured prompts for AI/LLM analysis tasks across the entire codebase, ensuring consistent and effective communication with language models.\",\n  \"userVisibleActions\": [\n    \"Analyzes project architecture and generates comprehensive documentation\",\n    \"Creates product-level documentation from codebase analysis\",\n    \"Generates test plans for code files with coverage recommendations\",\n    \"Produces test code based on defined test scenarios\",\n    \"Documents individual files with user-facing behavior descriptions\",\n    \"Summarizes code modules and their relationships\"\n  ],\n  \"developerVisibleActions\": [\n    \"Provides centralized prompt generation for all LLM analysis operations\",\n    \"Builds architecture analysis prompts with codebase context and product documentation\",\n    \"Constructs product documentation prompts from analysis context\",\n    \"Creates file-specific analysis prompts with role-based categorization\",\n    \"Generates module rollup prompts for aggregating file summaries\",\n    \"Builds test planning prompts with existing test awareness and function metadata\",\n    \"Produces test code generation prompts with source code and test framework details\",\n    \"Eliminates prompt duplication across different analysis services\",\n    \"Supports multiple programming languages and test frameworks\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"buildArchitecturePrompt\",\n      \"desc\": \"Constructs a prompt for analyzing overall system architecture\",\n      \"inputs\": \"context (AnalysisContext), optional codeAnalysis, productDocs, productPurposeAnalysis, fileAccessHelper\",\n      \"outputs\": \"string prompt for LLM consumption\"\n    },\n    {\n      \"name\": \"buildProductDocsPrompt\",\n      \"desc\": \"Creates a prompt for generating product-level documentation\",\n      \"inputs\": \"context (AnalysisContext)\",\n      \"outputs\": \"string prompt for documentation generation\"\n    },\n    {\n      \"name\": \"buildProductPurposePrompt\",\n      \"desc\": \"Generates a prompt for understanding the product's core purpose\",\n      \"inputs\": \"productDocs (EnhancedProductDocumentation), context (AnalysisContext)\",\n      \"outputs\": \"string prompt for purpose analysis\"\n    },\n    {\n      \"name\": \"buildFileAnalysisPrompt\",\n      \"desc\": \"Creates a prompt for analyzing individual code files\",\n      \"inputs\": \"file (FileInfo), content (string), role (string)\",\n      \"outputs\": \"string prompt for file analysis\"\n    },\n    {\n      \"name\": \"buildModuleRollupPrompt\",\n      \"desc\": \"Constructs a prompt for aggregating multiple file summaries into module documentation\",\n      \"inputs\": \"modulePath (string), moduleType (string), files (FileSummary[])\",\n      \"outputs\": \"string prompt for module summary\"\n    },\n    {\n      \"name\": \"buildProductLevelPrompt\",\n      \"desc\": \"Builds a comprehensive prompt for product-wide documentation\",\n      \"inputs\": \"fileSummaries, moduleSummaries, analysis (CodeAnalysis), fileAccessHelper\",\n      \"outputs\": \"string prompt for product documentation\"\n    },\n    {\n      \"name\": \"buildPerFileTestPlanPrompt\",\n      \"desc\": \"Creates a prompt for generating test plans for specific files\",\n      \"inputs\": \"filePath, fileContent, functionMetadata, existingTests, language, testFramework, optional projectSummary\",\n      \"outputs\": \"string prompt for test planning\"\n    },\n    {\n      \"name\": \"buildTestCodeGenerationPrompt\",\n      \"desc\": \"Generates a prompt for creating actual test code from test plans\",\n      \"inputs\": \"testPlanItem, sourceCode, functionCode, language, testFramework\",\n      \"outputs\": \"string prompt for test code generation\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../llmService\",\n    \"../../analyzer\",\n    \"../../fileDocumentation\",\n    \"../../fileAccessHelper\"\n  ],\n  \"intent\": \"This file exists to eliminate duplication and ensure consistency across all AI/LLM interactions by centralizing prompt construction logic. It solves the problem of scattered, inconsistent prompt generation throughout the codebase, making it easier to maintain and improve how the system communicates with language models for analysis, documentation, and test generation tasks.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T17:39:45.045Z"
  }
}