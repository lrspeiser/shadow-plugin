{
  "file": "src/domain/services/incrementalAnalysisService.ts",
  "role": "Core Logic",
  "purpose": "Manages iterative LLM analysis by processing file read and grep search requests across multiple analysis iterations until completion or max iterations reached",
  "userVisibleActions": [
    "System performs multiple analysis passes to gather required information",
    "Additional files are read automatically when analysis needs more context",
    "Grep searches execute to find code patterns requested during analysis",
    "Analysis stops after maximum iterations or when no more information needed",
    "Progress shown as iteration count advances through analysis process"
  ],
  "developerVisibleActions": [
    "Configure maximum number of analysis iterations allowed",
    "Provide callbacks to track iteration start and completion events",
    "Receive structured results containing analysis outcome, iteration count, and all file/grep requests made",
    "Access conversation history with assistant and user messages accumulated across iterations",
    "Handle file read and grep search requests automatically limited to 5 per iteration",
    "Use async iterator pattern for incremental analysis instead of while loops"
  ],
  "keyFunctions": [
    {
      "name": "processRequests",
      "desc": "Processes LLM-requested file reads and grep searches, formatting results for next iteration",
      "inputs": "requests: LLMRequest[], currentResult: any, messages: conversation history array",
      "outputs": "ProcessRequestsResult with additionalInfo string and updated messages array"
    },
    {
      "name": "Constructor",
      "desc": "Initializes service with file access helper for reading files and running searches",
      "inputs": "fileAccessHelper: FileAccessHelper",
      "outputs": "IncrementalAnalysisService instance"
    }
  ],
  "dependencies": [
    "../../fileAccessHelper (FileAccessHelper, LLMRequest types)"
  ],
  "intent": "Eliminates code duplication from llmService.ts by extracting iterative analysis logic into a reusable, testable service that handles the common pattern of: analyze → request files/searches → gather info → re-analyze → repeat until done",
  "rawContent": "```json\n{\n  \"purpose\": \"Manages iterative LLM analysis by processing file read and grep search requests across multiple analysis iterations until completion or max iterations reached\",\n  \"userVisibleActions\": [\n    \"System performs multiple analysis passes to gather required information\",\n    \"Additional files are read automatically when analysis needs more context\",\n    \"Grep searches execute to find code patterns requested during analysis\",\n    \"Analysis stops after maximum iterations or when no more information needed\",\n    \"Progress shown as iteration count advances through analysis process\"\n  ],\n  \"developerVisibleActions\": [\n    \"Configure maximum number of analysis iterations allowed\",\n    \"Provide callbacks to track iteration start and completion events\",\n    \"Receive structured results containing analysis outcome, iteration count, and all file/grep requests made\",\n    \"Access conversation history with assistant and user messages accumulated across iterations\",\n    \"Handle file read and grep search requests automatically limited to 5 per iteration\",\n    \"Use async iterator pattern for incremental analysis instead of while loops\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"processRequests\",\n      \"desc\": \"Processes LLM-requested file reads and grep searches, formatting results for next iteration\",\n      \"inputs\": \"requests: LLMRequest[], currentResult: any, messages: conversation history array\",\n      \"outputs\": \"ProcessRequestsResult with additionalInfo string and updated messages array\"\n    },\n    {\n      \"name\": \"Constructor\",\n      \"desc\": \"Initializes service with file access helper for reading files and running searches\",\n      \"inputs\": \"fileAccessHelper: FileAccessHelper\",\n      \"outputs\": \"IncrementalAnalysisService instance\"\n    }\n  ],\n  \"dependencies\": [\n    \"../../fileAccessHelper (FileAccessHelper, LLMRequest types)\"\n  ],\n  \"intent\": \"Eliminates code duplication from llmService.ts by extracting iterative analysis logic into a reusable, testable service that handles the common pattern of: analyze → request files/searches → gather info → re-analyze → repeat until done\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-21T17:41:04.686Z"
  }
}