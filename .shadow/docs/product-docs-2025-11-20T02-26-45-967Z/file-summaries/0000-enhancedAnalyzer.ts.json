{
  "file": "src/analysis/enhancedAnalyzer.ts",
  "role": "Core Logic",
  "purpose": "Provides deep code analysis capabilities by parsing TypeScript/JavaScript files using AST to extract function metadata, dependencies, branches, and behavioral patterns.",
  "userVisibleActions": [
    "Receives detailed analysis of code functions including complexity metrics",
    "Gets insights about code dependencies and how functions relate to each other",
    "Views behavioral hints about what functions do (queries, mutations, validations)",
    "Sees branch coverage information showing different code paths",
    "Understands state mutations and side effects in functions"
  ],
  "developerVisibleActions": [
    "Calls analyzeFileMetadata() to extract comprehensive metadata from a code file",
    "Receives FunctionMetadata objects containing branches, dependencies, and behavioral hints",
    "Gets AST-based analysis for TypeScript/JavaScript files with deep introspection",
    "Falls back to regex-based analysis for non-TypeScript languages",
    "Obtains branch information showing conditional paths and complexity",
    "Retrieves dependency information showing function calls and imports",
    "Accesses state mutation tracking for variables and properties",
    "Uses test mapping to understand test coverage relationships"
  ],
  "keyFunctions": [
    {
      "name": "analyzeFileMetadata",
      "desc": "Analyzes a code file and extracts enhanced metadata for all functions in it",
      "inputs": "filePath (string), content (string), language (string), functions (FunctionInfo[])",
      "outputs": "Map<string, FunctionMetadata> containing detailed analysis for each function"
    },
    {
      "name": "analyzeTypeScriptFunction",
      "desc": "Performs AST-based analysis of TypeScript/JavaScript functions to extract detailed metadata",
      "inputs": "filePath (string), content (string), func (FunctionInfo), functionContent (string)",
      "outputs": "FunctionMetadata with branches, dependencies, mutations, and behavioral hints"
    },
    {
      "name": "analyzeFunctionWithRegex",
      "desc": "Provides fallback regex-based analysis for non-TypeScript languages",
      "inputs": "filePath (string), func (FunctionInfo), functionContent (string), language (string)",
      "outputs": "FunctionMetadata with basic pattern-matched analysis"
    },
    {
      "name": "extractFunctionContent",
      "desc": "Extracts the source code content of a function between specified line numbers",
      "inputs": "content (string), startLine (number), endLine (number)",
      "outputs": "String containing the function's source code"
    }
  ],
  "dependencies": [
    "fs",
    "path",
    "typescript",
    "../analyzer"
  ],
  "intent": "This file exists to provide advanced code analysis beyond basic pattern matching by leveraging TypeScript's compiler API to deeply understand code structure, identify branches, track dependencies, detect behavioral patterns, and extract comprehensive metadata that enables intelligent code understanding and test generation.",
  "rawContent": "```json\n{\n  \"purpose\": \"Provides deep code analysis capabilities by parsing TypeScript/JavaScript files using AST to extract function metadata, dependencies, branches, and behavioral patterns.\",\n  \"userVisibleActions\": [\n    \"Receives detailed analysis of code functions including complexity metrics\",\n    \"Gets insights about code dependencies and how functions relate to each other\",\n    \"Views behavioral hints about what functions do (queries, mutations, validations)\",\n    \"Sees branch coverage information showing different code paths\",\n    \"Understands state mutations and side effects in functions\"\n  ],\n  \"developerVisibleActions\": [\n    \"Calls analyzeFileMetadata() to extract comprehensive metadata from a code file\",\n    \"Receives FunctionMetadata objects containing branches, dependencies, and behavioral hints\",\n    \"Gets AST-based analysis for TypeScript/JavaScript files with deep introspection\",\n    \"Falls back to regex-based analysis for non-TypeScript languages\",\n    \"Obtains branch information showing conditional paths and complexity\",\n    \"Retrieves dependency information showing function calls and imports\",\n    \"Accesses state mutation tracking for variables and properties\",\n    \"Uses test mapping to understand test coverage relationships\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a code file and extracts enhanced metadata for all functions in it\",\n      \"inputs\": \"filePath (string), content (string), language (string), functions (FunctionInfo[])\",\n      \"outputs\": \"Map<string, FunctionMetadata> containing detailed analysis for each function\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Performs AST-based analysis of TypeScript/JavaScript functions to extract detailed metadata\",\n      \"inputs\": \"filePath (string), content (string), func (FunctionInfo), functionContent (string)\",\n      \"outputs\": \"FunctionMetadata with branches, dependencies, mutations, and behavioral hints\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides fallback regex-based analysis for non-TypeScript languages\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), functionContent (string), language (string)\",\n      \"outputs\": \"FunctionMetadata with basic pattern-matched analysis\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function between specified line numbers\",\n      \"inputs\": \"content (string), startLine (number), endLine (number)\",\n      \"outputs\": \"String containing the function's source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\"\n  ],\n  \"intent\": \"This file exists to provide advanced code analysis beyond basic pattern matching by leveraging TypeScript's compiler API to deeply understand code structure, identify branches, track dependencies, detect behavioral patterns, and extract comprehensive metadata that enables intelligent code understanding and test generation.\"\n}\n```",
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T02:36:55.393Z"
  }
}