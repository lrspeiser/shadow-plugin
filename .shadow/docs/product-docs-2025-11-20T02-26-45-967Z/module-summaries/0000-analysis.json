{
  "module": "src/analysis",
  "moduleType": "other",
  "capabilities": [
    "Deep code analysis through Abstract Syntax Tree (AST) parsing of TypeScript and JavaScript files",
    "Function-level metadata extraction including signatures, parameters, return types, and complexity metrics",
    "Automatic dependency and relationship mapping between functions",
    "Behavioral pattern detection (queries, mutations, validations, side effects)",
    "Branch coverage analysis showing different execution paths",
    "State mutation and side effect identification",
    "Large file refactoring recommendations based on complexity and size thresholds",
    "Function interdependency visualization"
  ],
  "summary": "The analysis module provides comprehensive code intelligence for TypeScript and JavaScript codebases. It performs deep static analysis by parsing source files into Abstract Syntax Trees (ASTs) and extracting detailed metadata about functions, their relationships, and behavioral patterns. Users gain insights into code complexity, dependencies, and structure to make informed refactoring decisions.\n\nThe module enables developers to understand their codebase at both the macro and micro levels. At the file level, it identifies large or complex files that may benefit from refactoring. At the function level, it provides granular details including complexity metrics, dependency chains, branch coverage, and behavioral hints such as whether a function performs queries, mutations, or validations. This helps teams maintain code quality and identify technical debt.\n\nTypical workflows include analyzing existing codebases to find refactoring opportunities, understanding function relationships before making changes, identifying potential side effects, and tracking code complexity metrics. The module serves as the foundation for automated refactoring suggestions by providing the structured data needed to understand how code components interact and where improvements can be made.",
  "files": [
    {
      "file": "src/analysis/enhancedAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Provides deep code analysis capabilities by parsing TypeScript/JavaScript files using AST to extract function metadata, dependencies, branches, and behavioral patterns.",
      "userVisibleActions": [
        "Receives detailed analysis of code functions including complexity metrics",
        "Gets insights about code dependencies and how functions relate to each other",
        "Views behavioral hints about what functions do (queries, mutations, validations)",
        "Sees branch coverage information showing different code paths",
        "Understands state mutations and side effects in functions"
      ],
      "developerVisibleActions": [
        "Calls analyzeFileMetadata() to extract comprehensive metadata from a code file",
        "Receives FunctionMetadata objects containing branches, dependencies, and behavioral hints",
        "Gets AST-based analysis for TypeScript/JavaScript files with deep introspection",
        "Falls back to regex-based analysis for non-TypeScript languages",
        "Obtains branch information showing conditional paths and complexity",
        "Retrieves dependency information showing function calls and imports",
        "Accesses state mutation tracking for variables and properties",
        "Uses test mapping to understand test coverage relationships"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFileMetadata",
          "desc": "Analyzes a code file and extracts enhanced metadata for all functions in it",
          "inputs": "filePath (string), content (string), language (string), functions (FunctionInfo[])",
          "outputs": "Map<string, FunctionMetadata> containing detailed analysis for each function"
        },
        {
          "name": "analyzeTypeScriptFunction",
          "desc": "Performs AST-based analysis of TypeScript/JavaScript functions to extract detailed metadata",
          "inputs": "filePath (string), content (string), func (FunctionInfo), functionContent (string)",
          "outputs": "FunctionMetadata with branches, dependencies, mutations, and behavioral hints"
        },
        {
          "name": "analyzeFunctionWithRegex",
          "desc": "Provides fallback regex-based analysis for non-TypeScript languages",
          "inputs": "filePath (string), func (FunctionInfo), functionContent (string), language (string)",
          "outputs": "FunctionMetadata with basic pattern-matched analysis"
        },
        {
          "name": "extractFunctionContent",
          "desc": "Extracts the source code content of a function between specified line numbers",
          "inputs": "content (string), startLine (number), endLine (number)",
          "outputs": "String containing the function's source code"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer"
      ],
      "intent": "This file exists to provide advanced code analysis beyond basic pattern matching by leveraging TypeScript's compiler API to deeply understand code structure, identify branches, track dependencies, detect behavioral patterns, and extract comprehensive metadata that enables intelligent code understanding and test generation.",
      "rawContent": "```json\n{\n  \"purpose\": \"Provides deep code analysis capabilities by parsing TypeScript/JavaScript files using AST to extract function metadata, dependencies, branches, and behavioral patterns.\",\n  \"userVisibleActions\": [\n    \"Receives detailed analysis of code functions including complexity metrics\",\n    \"Gets insights about code dependencies and how functions relate to each other\",\n    \"Views behavioral hints about what functions do (queries, mutations, validations)\",\n    \"Sees branch coverage information showing different code paths\",\n    \"Understands state mutations and side effects in functions\"\n  ],\n  \"developerVisibleActions\": [\n    \"Calls analyzeFileMetadata() to extract comprehensive metadata from a code file\",\n    \"Receives FunctionMetadata objects containing branches, dependencies, and behavioral hints\",\n    \"Gets AST-based analysis for TypeScript/JavaScript files with deep introspection\",\n    \"Falls back to regex-based analysis for non-TypeScript languages\",\n    \"Obtains branch information showing conditional paths and complexity\",\n    \"Retrieves dependency information showing function calls and imports\",\n    \"Accesses state mutation tracking for variables and properties\",\n    \"Uses test mapping to understand test coverage relationships\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFileMetadata\",\n      \"desc\": \"Analyzes a code file and extracts enhanced metadata for all functions in it\",\n      \"inputs\": \"filePath (string), content (string), language (string), functions (FunctionInfo[])\",\n      \"outputs\": \"Map<string, FunctionMetadata> containing detailed analysis for each function\"\n    },\n    {\n      \"name\": \"analyzeTypeScriptFunction\",\n      \"desc\": \"Performs AST-based analysis of TypeScript/JavaScript functions to extract detailed metadata\",\n      \"inputs\": \"filePath (string), content (string), func (FunctionInfo), functionContent (string)\",\n      \"outputs\": \"FunctionMetadata with branches, dependencies, mutations, and behavioral hints\"\n    },\n    {\n      \"name\": \"analyzeFunctionWithRegex\",\n      \"desc\": \"Provides fallback regex-based analysis for non-TypeScript languages\",\n      \"inputs\": \"filePath (string), func (FunctionInfo), functionContent (string), language (string)\",\n      \"outputs\": \"FunctionMetadata with basic pattern-matched analysis\"\n    },\n    {\n      \"name\": \"extractFunctionContent\",\n      \"desc\": \"Extracts the source code content of a function between specified line numbers\",\n      \"inputs\": \"content (string), startLine (number), endLine (number)\",\n      \"outputs\": \"String containing the function's source code\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\"\n  ],\n  \"intent\": \"This file exists to provide advanced code analysis beyond basic pattern matching by leveraging TypeScript's compiler API to deeply understand code structure, identify branches, track dependencies, detect behavioral patterns, and extract comprehensive metadata that enables intelligent code understanding and test generation.\"\n}\n```"
    },
    {
      "file": "src/analysis/functionAnalyzer.ts",
      "role": "Core Logic",
      "purpose": "Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, and relationships for refactoring recommendations",
      "userVisibleActions": [
        "Identifies functions in large files that may need refactoring",
        "Provides detailed function analysis reports showing what each function does",
        "Shows which functions depend on each other",
        "Highlights functions that exceed complexity or size thresholds"
      ],
      "developerVisibleActions": [
        "Analyzes all functions in files exceeding a configurable line threshold (default 500 lines)",
        "Extracts function signatures including parameters and return types",
        "Maps function dependencies showing which functions call which",
        "Maps function dependents showing where each function is used",
        "Identifies function responsibilities and behavior patterns",
        "Returns structured FunctionAnalysis objects containing all extracted metadata",
        "Handles analysis failures gracefully with warnings",
        "Resolves file paths across different project structures"
      ],
      "keyFunctions": [
        {
          "name": "analyzeFunctions",
          "desc": "Analyzes all functions in files that exceed the size threshold and returns detailed analysis for each",
          "inputs": "CodeAnalysis object, optional largeFileThreshold (default 500)",
          "outputs": "Array of FunctionAnalysis objects containing function metadata"
        },
        {
          "name": "analyzeFunction",
          "desc": "Performs detailed analysis of a single function extracting its signature, dependencies, and relationships",
          "inputs": "File path, FunctionInfo object, CodeAnalysis context",
          "outputs": "FunctionAnalysis object or null if analysis fails"
        },
        {
          "name": "resolveFilePath",
          "desc": "Resolves relative file paths to absolute paths in the project structure",
          "inputs": "Relative file path, CodeAnalysis context",
          "outputs": "Absolute file path string"
        }
      ],
      "dependencies": [
        "fs",
        "path",
        "typescript",
        "../analyzer",
        "../domain/prompts/refactoringPromptBuilder"
      ],
      "intent": "This file exists to provide deep analysis of functions in large code files, extracting comprehensive metadata needed to generate intelligent refactoring recommendations. It solves the problem of understanding complex function relationships and dependencies when suggesting how to break down large files into smaller, more maintainable modules.",
      "rawContent": "```json\n{\n  \"purpose\": \"Analyzes functions in large code files to extract detailed metadata including signatures, dependencies, and relationships for refactoring recommendations\",\n  \"userVisibleActions\": [\n    \"Identifies functions in large files that may need refactoring\",\n    \"Provides detailed function analysis reports showing what each function does\",\n    \"Shows which functions depend on each other\",\n    \"Highlights functions that exceed complexity or size thresholds\"\n  ],\n  \"developerVisibleActions\": [\n    \"Analyzes all functions in files exceeding a configurable line threshold (default 500 lines)\",\n    \"Extracts function signatures including parameters and return types\",\n    \"Maps function dependencies showing which functions call which\",\n    \"Maps function dependents showing where each function is used\",\n    \"Identifies function responsibilities and behavior patterns\",\n    \"Returns structured FunctionAnalysis objects containing all extracted metadata\",\n    \"Handles analysis failures gracefully with warnings\",\n    \"Resolves file paths across different project structures\"\n  ],\n  \"keyFunctions\": [\n    {\n      \"name\": \"analyzeFunctions\",\n      \"desc\": \"Analyzes all functions in files that exceed the size threshold and returns detailed analysis for each\",\n      \"inputs\": \"CodeAnalysis object, optional largeFileThreshold (default 500)\",\n      \"outputs\": \"Array of FunctionAnalysis objects containing function metadata\"\n    },\n    {\n      \"name\": \"analyzeFunction\",\n      \"desc\": \"Performs detailed analysis of a single function extracting its signature, dependencies, and relationships\",\n      \"inputs\": \"File path, FunctionInfo object, CodeAnalysis context\",\n      \"outputs\": \"FunctionAnalysis object or null if analysis fails\"\n    },\n    {\n      \"name\": \"resolveFilePath\",\n      \"desc\": \"Resolves relative file paths to absolute paths in the project structure\",\n      \"inputs\": \"Relative file path, CodeAnalysis context\",\n      \"outputs\": \"Absolute file path string\"\n    }\n  ],\n  \"dependencies\": [\n    \"fs\",\n    \"path\",\n    \"typescript\",\n    \"../analyzer\",\n    \"../domain/prompts/refactoringPromptBuilder\"\n  ],\n  \"intent\": \"This file exists to provide deep analysis of functions in large code files, extracting comprehensive metadata needed to generate intelligent refactoring recommendations. It solves the problem of understanding complex function relationships and dependencies when suggesting how to break down large files into smaller, more maintainable modules.\"\n}\n```"
    }
  ],
  "endpoints": [],
  "commands": [],
  "workers": [],
  "_metadata": {
    "index": 0,
    "total": 0,
    "savedAt": "2025-11-20T02:46:34.196Z"
  }
}