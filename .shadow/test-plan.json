{
  "strategy": "Focus testing on the critical data flow from entry point through analysis engine, AI integration layer, and user-facing outputs. Prioritize the core analysis algorithms that detect code issues, the AI provider abstraction that handles external API calls with retry/rate limiting, the test generation and validation pipeline that executes code, and the state management that coordinates concurrent operations. This approach ensures the main value proposition (code analysis + AI insights) works reliably while protecting against external failures and data corruption.",
  "total_functions": 1217,
  "testable_functions": 45,
  "function_groups": [
    {
      "group_id": "core-analysis-engine",
      "name": "Core Analysis Engine",
      "priority": 1,
      "functions": [
        {
          "name": "for",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 488,
          "endLine": 617,
          "complexity": "high",
          "dependencies": [
            "AST parser",
            "file system"
          ],
          "mocking_needed": true,
          "reason": "Largest and most complex function (130 lines) in the analyzer - likely contains core analysis logic that processes multiple files or AST nodes. Critical entry point for analysis workflow."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 161,
          "endLine": 200,
          "complexity": "high",
          "dependencies": [
            "file system",
            "AST parser"
          ],
          "mocking_needed": true,
          "reason": "Major loop processing function (40 lines) in main analyzer - likely iterates through workspace files or AST nodes. Core to the analysis pipeline."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 372,
          "endLine": 404,
          "complexity": "high",
          "dependencies": [
            "dependency graph"
          ],
          "mocking_needed": true,
          "reason": "Complex 33-line function with nested logic (28-line if block) - likely builds dependency relationships or detects circular dependencies, a key feature."
        },
        {
          "name": "traverse",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 744,
          "endLine": 771,
          "complexity": "high",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "AST traversal function (28 lines) - fundamental to parsing code structure for complexity and quality analysis. Named function suggests public/exported interface."
        },
        {
          "name": "visit",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 104,
          "endLine": 122,
          "complexity": "medium",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "Visitor pattern implementation (19 lines) - likely processes AST nodes to detect issues and calculate metrics. Key pattern for code analysis."
        },
        {
          "name": "traverse",
          "file": "src/analyzer.ts",
          "startLine": 314,
          "endLine": 337,
          "complexity": "high",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "Second traversal function (24 lines) in main analyzer - critical for walking code structure to identify patterns and issues."
        },
        {
          "name": "for",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 693,
          "endLine": 719,
          "complexity": "medium",
          "dependencies": [
            "dependency graph"
          ],
          "mocking_needed": true,
          "reason": "27-line loop with nested logic - likely detects orphaned code or analyzes dependency relationships, core feature requirement."
        },
        {
          "name": "visit",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 198,
          "endLine": 220,
          "complexity": "medium",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "Function-specific visitor (23 lines) - analyzes individual functions for complexity metrics and quality issues, critical for granular analysis."
        },
        {
          "name": "for",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 23,
          "endLine": 40,
          "complexity": "medium",
          "dependencies": [
            "AST",
            "complexity calculator"
          ],
          "mocking_needed": true,
          "reason": "18-line loop in function analyzer - likely calculates cyclomatic complexity or other function-level metrics, key requirement."
        },
        {
          "name": "switch",
          "file": "src/analyzer.ts",
          "startLine": 527,
          "endLine": 551,
          "complexity": "medium",
          "dependencies": [
            "issue detector"
          ],
          "mocking_needed": false,
          "reason": "Large switch statement (25 lines) - likely categorizes or processes different issue types, central to issue detection logic."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 420,
          "endLine": 441,
          "complexity": "medium",
          "dependencies": [
            "dependency graph"
          ],
          "mocking_needed": true,
          "reason": "22-line loop with nested if (16 lines) - likely detects circular dependencies or builds dependency chains, critical feature."
        },
        {
          "name": "traverse",
          "file": "src/analyzer.ts",
          "startLine": 283,
          "endLine": 300,
          "complexity": "medium",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "Third traversal function (18 lines) - multiple traversal points suggest different analysis phases, important for comprehensive coverage."
        },
        {
          "name": "for",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 396,
          "endLine": 415,
          "complexity": "medium",
          "dependencies": [
            "complexity calculator"
          ],
          "mocking_needed": true,
          "reason": "20-line loop with nested conditions - likely aggregates or validates complexity metrics across function scope."
        },
        {
          "name": "visit",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 339,
          "endLine": 357,
          "complexity": "medium",
          "dependencies": [
            "AST"
          ],
          "mocking_needed": true,
          "reason": "Second visitor in function analyzer (19 lines) - multiple visitors suggest different analysis passes for completeness."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 505,
          "endLine": 518,
          "complexity": "medium",
          "dependencies": [
            "issue detector"
          ],
          "mocking_needed": true,
          "reason": "Nested loop structure (14 lines total, 11-line inner loop) - likely aggregates issues or validates detection results across scope."
        }
      ]
    },
    {
      "group_id": "ai-provider-integration",
      "name": "AI Provider Integration & Resilience",
      "priority": 2,
      "functions": [
        {
          "name": "for",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 60,
          "endLine": 90,
          "complexity": "high",
          "dependencies": [
            "external AI APIs",
            "llmRateLimiter"
          ],
          "mocking_needed": true,
          "reason": "Core retry logic with exponential backoff - critical for handling API failures and rate limiting. This is the main entry point for resilience handling."
        },
        {
          "name": "for",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 155,
          "endLine": 186,
          "complexity": "high",
          "dependencies": [
            "external AI APIs",
            "llmRateLimiter"
          ],
          "mocking_needed": true,
          "reason": "Secondary retry handler - likely for streaming or alternative retry patterns. Essential for complete retry coverage."
        },
        {
          "name": "for",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 390,
          "endLine": 439,
          "complexity": "high",
          "dependencies": [
            "AI response data"
          ],
          "mocking_needed": true,
          "reason": "Largest parsing function (50 lines) with multiple conditionals - handles complex response parsing with malformed input scenarios."
        },
        {
          "name": "for",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 313,
          "endLine": 348,
          "complexity": "high",
          "dependencies": [
            "AI response data"
          ],
          "mocking_needed": true,
          "reason": "Complex parsing loop (36 lines) with nested conditionals - critical for handling various response formats and malformed data."
        },
        {
          "name": "switch",
          "file": "src/ai/providers/providerFactory.ts",
          "startLine": 23,
          "endLine": 38,
          "complexity": "medium",
          "dependencies": [
            "OpenAIProvider",
            "AnthropicProvider"
          ],
          "mocking_needed": true,
          "reason": "Provider switching logic - entry point for selecting between OpenAI/Claude, critical for failover functionality."
        },
        {
          "name": "if",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 17,
          "endLine": 30,
          "complexity": "medium",
          "dependencies": [
            "AI response data"
          ],
          "mocking_needed": true,
          "reason": "Primary response validation logic - first line of defense against malformed AI outputs."
        },
        {
          "name": "if",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 60,
          "endLine": 72,
          "complexity": "medium",
          "dependencies": [
            "AI response data"
          ],
          "mocking_needed": true,
          "reason": "Secondary response validation - handles alternative response formats and error cases."
        },
        {
          "name": "constructor",
          "file": "src/ai/llmRateLimiter.ts",
          "startLine": 20,
          "endLine": 33,
          "complexity": "medium",
          "dependencies": [
            "rate limit configuration"
          ],
          "mocking_needed": false,
          "reason": "Rate limiter initialization - sets up critical rate limiting parameters that prevent API quota exhaustion."
        },
        {
          "name": "waitTime",
          "file": "src/ai/llmRateLimiter.ts",
          "startLine": 100,
          "endLine": 105,
          "complexity": "medium",
          "dependencies": [
            "timing logic"
          ],
          "mocking_needed": true,
          "reason": "Calculates rate limit wait times - essential for proper throttling and preventing API quota violations."
        },
        {
          "name": "errorMessage",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 104,
          "endLine": 115,
          "complexity": "medium",
          "dependencies": [
            "error objects"
          ],
          "mocking_needed": true,
          "reason": "Error message extraction and classification - crucial for determining retry strategy based on error types."
        },
        {
          "name": "for",
          "file": "src/ai/providers/openAIProvider.ts",
          "startLine": 120,
          "endLine": 133,
          "complexity": "medium",
          "dependencies": [
            "OpenAI API"
          ],
          "mocking_needed": true,
          "reason": "OpenAI-specific request handling loop - tests integration with primary AI provider including response streaming."
        },
        {
          "name": "if",
          "file": "src/ai/providers/openAIProvider.ts",
          "startLine": 20,
          "endLine": 26,
          "complexity": "low",
          "dependencies": [
            "OpenAI configuration"
          ],
          "mocking_needed": true,
          "reason": "OpenAI provider initialization validation - ensures proper API configuration before making requests."
        },
        {
          "name": "if",
          "file": "src/ai/providers/anthropicProvider.ts",
          "startLine": 20,
          "endLine": 26,
          "complexity": "low",
          "dependencies": [
            "Anthropic configuration"
          ],
          "mocking_needed": true,
          "reason": "Anthropic provider initialization validation - ensures proper failover provider configuration."
        },
        {
          "name": "requests",
          "file": "src/ai/providers/anthropicProvider.ts",
          "startLine": 121,
          "endLine": 126,
          "complexity": "low",
          "dependencies": [
            "Anthropic API"
          ],
          "mocking_needed": true,
          "reason": "Anthropic request builder - critical for proper API request formatting when failing over from OpenAI."
        },
        {
          "name": "if",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 351,
          "endLine": 365,
          "complexity": "medium",
          "dependencies": [
            "parsed data validation"
          ],
          "mocking_needed": true,
          "reason": "Post-parsing validation logic - ensures parsed data meets expected format before returning to caller."
        }
      ]
    },
    {
      "group_id": "workspace-monitoring",
      "name": "Workspace Monitoring & State Management",
      "priority": 4,
      "functions": [
        {
          "name": "activate",
          "file": "src/extension.ts",
          "startLine": 31,
          "endLine": 91,
          "complexity": "high",
          "dependencies": [
            "vscode",
            "fileWatcher",
            "stateManager",
            "providers"
          ],
          "mocking_needed": true,
          "reason": "Extension entry point that initializes all workspace monitoring components, file watchers, and state managers. Critical for proper extension lifecycle and coordination setup."
        },
        {
          "name": "analyzeWorkspace",
          "file": "src/extension.ts",
          "startLine": 123,
          "endLine": 191,
          "complexity": "high",
          "dependencies": [
            "vscode",
            "analyzer",
            "stateManager",
            "diagnostics"
          ],
          "mocking_needed": true,
          "reason": "Core function orchestrating concurrent analysis across workspace files. Critical for testing race conditions, state updates, and view synchronization during bulk operations."
        },
        {
          "name": "analyzeCurrentFile",
          "file": "src/extension.ts",
          "startLine": 193,
          "endLine": 224,
          "complexity": "medium",
          "dependencies": [
            "vscode",
            "analyzer",
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "Handles single file analysis triggered by file changes or user action. Key for testing file watcher integration and incremental state updates."
        },
        {
          "name": "clearCache",
          "file": "src/extension.ts",
          "startLine": 280,
          "endLine": 286,
          "complexity": "low",
          "dependencies": [
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "Critical cleanup function that must properly reset state and trigger view refreshes. Essential for testing state consistency after cache invalidation."
        },
        {
          "name": "clearAllData",
          "file": "src/extension.ts",
          "startLine": 396,
          "endLine": 419,
          "complexity": "medium",
          "dependencies": [
            "vscode",
            "stateManager",
            "diagnostics"
          ],
          "mocking_needed": true,
          "reason": "Comprehensive cleanup that clears all state and views. Must test proper cleanup sequence and prevention of memory leaks."
        },
        {
          "name": "deactivate",
          "file": "src/extension.ts",
          "startLine": 676,
          "endLine": 683,
          "complexity": "low",
          "dependencies": [
            "fileWatcher",
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "Extension cleanup entry point. Critical for testing proper disposal of file watchers and state managers to prevent resource leaks."
        },
        {
          "name": "if (src/fileWatcher.ts:78-82)",
          "file": "src/fileWatcher.ts",
          "startLine": 78,
          "endLine": 82,
          "complexity": "medium",
          "dependencies": [
            "fs",
            "debouncer"
          ],
          "mocking_needed": true,
          "reason": "Likely file watcher event handler with debouncing logic. Critical for testing race conditions and duplicate analysis prevention."
        },
        {
          "name": "if (src/fileWatcher.ts:50-52)",
          "file": "src/fileWatcher.ts",
          "startLine": 50,
          "endLine": 52,
          "complexity": "low",
          "dependencies": [
            "vscode"
          ],
          "mocking_needed": true,
          "reason": "File watcher conditional logic, likely filtering or validation. Important for correct event processing."
        },
        {
          "name": "if (src/fileWatcher.ts:59-62)",
          "file": "src/fileWatcher.ts",
          "startLine": 59,
          "endLine": 62,
          "complexity": "low",
          "dependencies": [
            "vscode"
          ],
          "mocking_needed": true,
          "reason": "File watcher event handling logic. Essential for testing file change detection accuracy."
        },
        {
          "name": "for (src/state/baseStateManager.ts:141-145)",
          "file": "src/state/baseStateManager.ts",
          "startLine": 141,
          "endLine": 145,
          "complexity": "medium",
          "dependencies": [
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "State iteration logic likely updating multiple views. Critical for testing state propagation and view synchronization."
        },
        {
          "name": "if (src/state/llmStateManager.ts:103-105)",
          "file": "src/state/llmStateManager.ts",
          "startLine": 103,
          "endLine": 105,
          "complexity": "low",
          "dependencies": [
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "State validation or update logic. Important for preventing state corruption."
        },
        {
          "name": "if (src/state/llmStateManager.ts:110-112)",
          "file": "src/state/llmStateManager.ts",
          "startLine": 110,
          "endLine": 112,
          "complexity": "low",
          "dependencies": [
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "State management conditional. Key for testing state consistency during concurrent operations."
        },
        {
          "name": "getStateManager",
          "file": "src/state/llmStateManager.ts",
          "startLine": 201,
          "endLine": 206,
          "complexity": "low",
          "dependencies": [
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "Singleton accessor for state manager. Critical for ensuring consistent state access across all components."
        },
        {
          "name": "showSettings",
          "file": "src/extension.ts",
          "startLine": 424,
          "endLine": 463,
          "complexity": "high",
          "dependencies": [
            "vscode",
            "webview"
          ],
          "mocking_needed": true,
          "reason": "Settings view management with message handling. Important for testing view state synchronization and user interactions."
        },
        {
          "name": "getSettingsHtml",
          "file": "src/extension.ts",
          "startLine": 465,
          "endLine": 612,
          "complexity": "high",
          "dependencies": [
            "vscode",
            "stateManager"
          ],
          "mocking_needed": true,
          "reason": "Large view rendering function with embedded handlers. Tests proper state reflection in UI and command routing."
        }
      ]
    }
  ]
}