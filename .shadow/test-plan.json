{
  "strategy": "Focus on the critical path from user interaction through AI-powered analysis to result presentation. Prioritize testing the core analysis engine, AI integration layer, and result persistence/navigation, as these represent the highest-risk areas where failures would break primary user workflows. Emphasize error handling and rate limiting since external API dependencies introduce failure modes. Use integration tests for end-to-end workflows and unit tests for complex business logic like parsing, formatting, and incremental processing.",
  "total_functions": 1217,
  "testable_functions": 37,
  "function_groups": [
    {
      "group_id": "core-analysis-engine",
      "name": "Core Analysis Engine",
      "priority": 1,
      "functions": [
        {
          "name": "for",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 488,
          "endLine": 617,
          "complexity": "high",
          "dependencies": [
            "typescript",
            "parser"
          ],
          "mocking_needed": true,
          "reason": "Largest and most complex function (130 lines) in the analyzer. Likely contains core analysis logic that processes multiple code patterns and extracts metadata. Critical entry point for code analysis."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 161,
          "endLine": 200,
          "complexity": "high",
          "dependencies": [
            "typescript",
            "fs",
            "vscode"
          ],
          "mocking_needed": true,
          "reason": "Main entry point loop (40 lines) in the base analyzer. Likely orchestrates file processing and delegates to other analysis functions. Critical for workspace analysis flow."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 372,
          "endLine": 404,
          "complexity": "high",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Complex nested loop (33 lines) with significant conditional logic. Appears to handle complex code traversal or pattern matching scenarios."
        },
        {
          "name": "traverse",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 744,
          "endLine": 771,
          "complexity": "high",
          "dependencies": [
            "typescript",
            "ast"
          ],
          "mocking_needed": true,
          "reason": "AST traversal function (28 lines) that walks code structure. Core to analyzing code patterns, extracting functions, and detecting issues. Essential for metadata extraction."
        },
        {
          "name": "for",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 31,
          "endLine": 58,
          "complexity": "medium",
          "dependencies": [
            "typescript",
            "fs"
          ],
          "mocking_needed": true,
          "reason": "Entry point loop (28 lines) in enhanced analyzer. Likely initializes or coordinates enhanced analysis features. Important for understanding analysis workflow."
        },
        {
          "name": "for",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 693,
          "endLine": 719,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Complex nested loop (27 lines) with multiple conditionals. Likely handles specific analysis patterns or issue detection logic."
        },
        {
          "name": "traverse",
          "file": "src/analyzer.ts",
          "startLine": 314,
          "endLine": 337,
          "complexity": "medium",
          "dependencies": [
            "typescript",
            "ast"
          ],
          "mocking_needed": true,
          "reason": "Another AST traversal function (24 lines). Multiple traversal strategies suggest different analysis modes. Critical for comprehensive code analysis."
        },
        {
          "name": "visit",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 198,
          "endLine": 220,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Visitor pattern implementation (23 lines) for function analysis. Core to extracting function metadata, parameters, and complexity metrics."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 203,
          "endLine": 229,
          "complexity": "medium",
          "dependencies": [
            "typescript",
            "fs"
          ],
          "mocking_needed": true,
          "reason": "File processing loop (27 lines). Likely handles batch analysis of multiple files. Critical for workspace-level analysis."
        },
        {
          "name": "for",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 396,
          "endLine": 415,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Complex loop (20 lines) with nested conditionals in function analyzer. Likely extracts function-specific metrics or detects function-level issues."
        },
        {
          "name": "switch",
          "file": "src/analyzer.ts",
          "startLine": 527,
          "endLine": 551,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": false,
          "reason": "Large switch statement (25 lines) likely handling different node types or analysis modes. Important for routing analysis logic correctly."
        },
        {
          "name": "visit",
          "file": "src/analysis/enhancedAnalyzer.ts",
          "startLine": 104,
          "endLine": 122,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Enhanced visitor pattern (19 lines). Implements advanced analysis features beyond basic function extraction. Important for comprehensive insights."
        },
        {
          "name": "for",
          "file": "src/analyzer.ts",
          "startLine": 420,
          "endLine": 441,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Complex loop (22 lines) with significant conditional logic. Likely handles specific complexity calculation or issue detection patterns."
        },
        {
          "name": "traverse",
          "file": "src/analyzer.ts",
          "startLine": 283,
          "endLine": 300,
          "complexity": "medium",
          "dependencies": [
            "typescript",
            "ast"
          ],
          "mocking_needed": true,
          "reason": "Core traversal function (18 lines). Multiple traverse implementations suggest layered analysis. Essential for walking code structure systematically."
        },
        {
          "name": "for",
          "file": "src/analysis/functionAnalyzer.ts",
          "startLine": 23,
          "endLine": 40,
          "complexity": "medium",
          "dependencies": [
            "typescript"
          ],
          "mocking_needed": true,
          "reason": "Entry point loop (18 lines) in function analyzer. Coordinates function-level analysis including complexity, parameters, and return types. Critical for function metadata extraction."
        }
      ]
    },
    {
      "group_id": "ai-integration-layer",
      "name": "AI Provider Integration & Error Handling",
      "priority": 2,
      "functions": [
        {
          "name": "for",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 155,
          "endLine": 186,
          "complexity": "high",
          "dependencies": [
            "retry",
            "exponential-backoff"
          ],
          "mocking_needed": true,
          "reason": "Core retry logic with exponential backoff for handling API failures. This is critical error handling infrastructure that manages network failures and rate limits - one of the highest-risk areas identified."
        },
        {
          "name": "for",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 60,
          "endLine": 90,
          "complexity": "high",
          "dependencies": [
            "retry",
            "exponential-backoff"
          ],
          "mocking_needed": true,
          "reason": "Primary retry handler loop implementing the retry strategy. Essential for testing retry attempts, backoff timing, and failure scenarios across all AI provider calls."
        },
        {
          "name": "for",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 390,
          "endLine": 439,
          "complexity": "high",
          "dependencies": [
            "parsing"
          ],
          "mocking_needed": false,
          "reason": "Largest and most complex parsing logic (50 lines) for extracting structured data from AI text responses. This is error-prone due to unpredictable AI outputs and requires comprehensive edge case testing."
        },
        {
          "name": "for",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 313,
          "endLine": 348,
          "complexity": "high",
          "dependencies": [
            "parsing"
          ],
          "mocking_needed": false,
          "reason": "Complex nested parsing logic (36 lines) with multiple conditional branches. Critical for handling varied AI response formats and extracting data reliably."
        },
        {
          "name": "switch",
          "file": "src/ai/providers/providerFactory.ts",
          "startLine": 23,
          "endLine": 38,
          "complexity": "medium",
          "dependencies": [
            "anthropic",
            "openai"
          ],
          "mocking_needed": true,
          "reason": "Provider factory entry point that determines which AI provider to instantiate. Critical routing logic that must handle provider selection correctly to avoid runtime failures."
        },
        {
          "name": "for",
          "file": "src/ai/providers/openAIProvider.ts",
          "startLine": 120,
          "endLine": 133,
          "complexity": "medium",
          "dependencies": [
            "openai-api"
          ],
          "mocking_needed": true,
          "reason": "OpenAI-specific response processing loop. Must test message format handling and API response structure parsing specific to OpenAI."
        },
        {
          "name": "errorMessage",
          "file": "src/ai/llmRetryHandler.ts",
          "startLine": 104,
          "endLine": 115,
          "complexity": "medium",
          "dependencies": [
            "error-handling"
          ],
          "mocking_needed": false,
          "reason": "Error message extraction logic (12 lines) that determines error types for retry decisions. Critical for proper error classification and retry strategy."
        },
        {
          "name": "constructor",
          "file": "src/ai/llmRateLimiter.ts",
          "startLine": 20,
          "endLine": 33,
          "complexity": "medium",
          "dependencies": [
            "rate-limiting"
          ],
          "mocking_needed": false,
          "reason": "Rate limiter initialization that sets up quota limits and tracking. Essential infrastructure for preventing API quota exhaustion and managing concurrent requests."
        },
        {
          "name": "if",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 17,
          "endLine": 30,
          "complexity": "medium",
          "dependencies": [
            "parsing"
          ],
          "mocking_needed": false,
          "reason": "Primary response validation and parsing entry point (14 lines). First line of defense against malformed AI responses and must handle various response formats."
        },
        {
          "name": "if",
          "file": "src/ai/llmResponseParser.ts",
          "startLine": 60,
          "endLine": 72,
          "complexity": "medium",
          "dependencies": [
            "parsing"
          ],
          "mocking_needed": false,
          "reason": "Secondary parsing validation (13 lines) that handles alternative response structures. Important for robust parsing across different AI output formats."
        },
        {
          "name": "if",
          "file": "src/ai/providers/anthropicProvider.ts",
          "startLine": 20,
          "endLine": 26,
          "complexity": "medium",
          "dependencies": [
            "anthropic-api"
          ],
          "mocking_needed": true,
          "reason": "Anthropic provider initialization and API key validation. Critical entry point that must fail gracefully with proper error messages when misconfigured."
        },
        {
          "name": "if",
          "file": "src/ai/providers/openAIProvider.ts",
          "startLine": 20,
          "endLine": 26,
          "complexity": "medium",
          "dependencies": [
            "openai-api"
          ],
          "mocking_needed": true,
          "reason": "OpenAI provider initialization and API key validation. Must test configuration errors and API client setup for the most common AI provider."
        },
        {
          "name": "waitTime",
          "file": "src/ai/llmRateLimiter.ts",
          "startLine": 100,
          "endLine": 105,
          "complexity": "low",
          "dependencies": [
            "rate-limiting"
          ],
          "mocking_needed": false,
          "reason": "Calculates rate limit wait times. Critical for testing that requests respect API rate limits and don't cause quota violations."
        },
        {
          "name": "requests",
          "file": "src/ai/providers/anthropicProvider.ts",
          "startLine": 121,
          "endLine": 126,
          "complexity": "low",
          "dependencies": [
            "anthropic-api"
          ],
          "mocking_needed": true,
          "reason": "Anthropic API request construction. Must validate proper request format, headers, and payload structure for successful API calls."
        },
        {
          "name": "if",
          "file": "src/ai/providers/openAIProvider.ts",
          "startLine": 89,
          "endLine": 94,
          "complexity": "medium",
          "dependencies": [
            "openai-api"
          ],
          "mocking_needed": true,
          "reason": "OpenAI response validation and error handling. Critical for catching API errors and handling unexpected response formats from OpenAI."
        }
      ]
    },
    {
      "group_id": "result-persistence-navigation",
      "name": "Result Storage, Navigation & View Synchronization",
      "priority": 4,
      "functions": [
        {
          "name": "constructor",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 50,
          "endLine": 58,
          "complexity": "medium",
          "dependencies": [
            "vscode",
            "fs"
          ],
          "mocking_needed": true,
          "reason": "Constructor is critical as it initializes the storage system and sets up file watching mechanisms. This is the entry point for the entire incremental storage functionality, and proper initialization is essential for result storage and synchronization."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 89,
          "endLine": 93,
          "complexity": "medium",
          "dependencies": [
            "fs"
          ],
          "mocking_needed": true,
          "reason": "This conditional block (5 lines) likely handles an important branching logic in storage operations. Given its size and position early in the file, it may handle critical validation or state checks for result storage."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 134,
          "endLine": 138,
          "complexity": "medium",
          "dependencies": [
            "fs"
          ],
          "mocking_needed": true,
          "reason": "Another significant conditional block (5 lines) that likely handles edge cases or validation logic. This could be related to file existence checks or navigation edge cases mentioned in the test area description."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 249,
          "endLine": 252,
          "complexity": "low",
          "dependencies": [
            "vscode"
          ],
          "mocking_needed": true,
          "reason": "This 4-line conditional appears near the end of the file and may handle export functionality or final synchronization checks, which are explicitly mentioned as error-prone in the test area description."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 169,
          "endLine": 171,
          "complexity": "low",
          "dependencies": [],
          "mocking_needed": false,
          "reason": "While smaller (3 lines), this conditional may handle critical validation for timestamp storage or workspace state synchronization mentioned in the test requirements."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 233,
          "endLine": 235,
          "complexity": "low",
          "dependencies": [],
          "mocking_needed": false,
          "reason": "This conditional likely handles edge cases in incremental updates or view synchronization, which are specifically called out as error-prone in the test area description."
        },
        {
          "name": "if",
          "file": "src/storage/incrementalStorage.ts",
          "startLine": 245,
          "endLine": 247,
          "complexity": "low",
          "dependencies": [],
          "mocking_needed": false,
          "reason": "This conditional may handle navigation edge cases or missing file scenarios, which are explicitly mentioned as important test cases in the area description."
        }
      ]
    }
  ]
}